var Yt=Object.defineProperty;var _t=Object.getOwnPropertySymbols;var zt=Object.prototype.hasOwnProperty,Xt=Object.prototype.propertyIsEnumerable;var mt=(l,e,t)=>e in l?Yt(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t,Ce=(l,e)=>{for(var t in e||(e={}))zt.call(e,t)&&mt(l,t,e[t]);if(_t)for(var t of _t(e))Xt.call(e,t)&&mt(l,t,e[t]);return l};import{S as Fe,h as Ze,s as $e,Q as T,R as x,T as P,p as b,U as g,k as Q,ao as vt,K as we,z as bt,A as pt,B as gt,o as le,a3 as et,a4 as wt,t as ne,ad as yt,j as Ue,l as lt,m as st,a5 as Gt,y as Et,af as Be,a6 as W,I as G,a7 as F,J as q,a9 as ce,a2 as _,ae as ye,q as qt,C as Ye,D as ze,E as Xe,ac as ae,H as Ge,ar as He,aa as Tt,aQ as xt,ak as ot,aM as be,r as Jt,u as Kt,w as Qt,g as Wt,P as kt,as as it,at as Pt,au as At,av as It,f as tt}from"./vendor.3ae73048.js";import{I as rt}from"./Icon.61279884.js";import{a as Ft,b as Zt}from"./ChevronUp.0ab7bee0.js";import{P as qe}from"./plotly.2255cf4f.js";import{I as Je,B as H}from"./interactive.28807de7.js";import{p as $t,c as er,o as tr,f as rr,s as lr,b as sr}from"./types.8cb6216c.js";import{D as or}from"./DocumentDownload.7e4b12e9.js";import{S as ir}from"./SwitchHorizontal.0e438e3b.js";import{t as nr}from"./Spinner.012207c4.js";import{f as Nt}from"./index.2e3bb17a.js";function Dt(l){let e,t,r,s,o,a,n;const i=l[10].default,u=Et(i,l,l[9],null);return{c(){e=T("div"),u&&u.c(),this.h()},l(f){e=x(f,"DIV",{class:!0});var m=P(e);u&&u.l(m),m.forEach(b),this.h()},h(){g(e,"class",t=""+(l[3]+" hover-preview absolute p-1.5 rounded-md bg-gray-900 shadow-lg z-100 overflow-y-auto svelte-1rba2ms"))},m(f,m){Q(f,e,m),u&&u.m(e,null),l[11](e),o=!0,a||(n=[vt(r=$t.call(null,e,document.body)),we(e,"mouseenter",l[12]),we(e,"mouseleave",l[13])],a=!0)},p(f,m){u&&u.p&&(!o||m&512)&&bt(u,i,f,f[9],o?gt(i,f[9],m,null):pt(f[9]),null),(!o||m&8&&t!==(t=""+(f[3]+" hover-preview absolute p-1.5 rounded-md bg-gray-900 shadow-lg z-100 overflow-y-auto svelte-1rba2ms")))&&g(e,"class",t)},i(f){o||(le(u,f),et(()=>{s||(s=wt(e,Nt,{duration:200},!0)),s.run(1)}),o=!0)},o(f){ne(u,f),s||(s=wt(e,Nt,{duration:200},!1)),s.run(0),o=!1},d(f){f&&b(e),u&&u.d(f),l[11](null),f&&s&&s.end(),a=!1,yt(n)}}}function ar(l){let e,t,r=(l[2]||l[1])&&Dt(l);return{c(){r&&r.c(),e=Ue()},l(s){r&&r.l(s),e=Ue()},m(s,o){r&&r.m(s,o),Q(s,e,o),t=!0},p(s,[o]){s[2]||s[1]?r?(r.p(s,o),o&6&&le(r,1)):(r=Dt(s),r.c(),le(r,1),r.m(e.parentNode,e)):r&&(lt(),ne(r,1,1,()=>{r=null}),st())},i(s){t||(le(r),t=!0)},o(s){ne(r),t=!1},d(s){r&&r.d(s),s&&b(e)}}}function ur(l,e,t){let{$$slots:r={},$$scope:s}=e;var o=this&&this.__awaiter||function(y,O,C,M){function U(te){return te instanceof C?te:new C(function(B){B(te)})}return new(C||(C=Promise))(function(te,B){function z(j){try{Y(M.next(j))}catch(R){B(R)}}function se(j){try{Y(M.throw(j))}catch(R){B(R)}}function Y(j){j.done?te(j.value):U(j.value).then(z,se)}Y((M=M.apply(y,O||[])).next())})};let{showPreview:a=!1}=e,{modifier:n=""}=e,{previewNode:i=null}=e,{referenceNode:u=null}=e,{position:f="bottom-start"}=e,{floatingUIMiddleware:m=[]}=e,{shiftPadding:k=0}=e,{offset:p=0}=e,{showPreviewOverride:c=!1}=e;const D=()=>o(void 0,void 0,void 0,function*(){if(yield Gt(),!i||!u)return;const{x:y,y:O}=yield er(u,i,{placement:f,middleware:[tr(p),rr(),lr({padding:k}),sr({apply({availableHeight:C}){t(0,i.style.maxHeight=`${C}px`,i)}}),...m]});t(0,i.style.left=`${y}px`,i),t(0,i.style.top=`${O}px`,i)});function E(y){Be[y?"unshift":"push"](()=>{i=y,t(0,i)})}const d=()=>{t(1,c=!0)},w=()=>{t(1,c=!1)};return l.$$set=y=>{"showPreview"in y&&t(2,a=y.showPreview),"modifier"in y&&t(3,n=y.modifier),"previewNode"in y&&t(0,i=y.previewNode),"referenceNode"in y&&t(4,u=y.referenceNode),"position"in y&&t(5,f=y.position),"floatingUIMiddleware"in y&&t(6,m=y.floatingUIMiddleware),"shiftPadding"in y&&t(7,k=y.shiftPadding),"offset"in y&&t(8,p=y.offset),"showPreviewOverride"in y&&t(1,c=y.showPreviewOverride),"$$scope"in y&&t(9,s=y.$$scope)},l.$$.update=()=>{l.$$.dirty&4&&a&&D()},[i,c,a,n,u,f,m,k,p,s,r,E,d,w]}class fr extends Fe{constructor(e){super();Ze(this,e,ur,ar,$e,{showPreview:2,modifier:3,previewNode:0,referenceNode:4,position:5,floatingUIMiddleware:6,shiftPadding:7,offset:8,showPreviewOverride:1})}}function cr(l){let e,t;return e=new rt({props:{src:Ft,modifier:"text-gray-500"}}),{c(){Ye(e.$$.fragment)},l(r){ze(e.$$.fragment,r)},m(r,s){Xe(e,r,s),t=!0},p:ae,i(r){t||(le(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){Ge(e,r)}}}function dr(l){let e,t;return e=new rt({props:{src:Zt,modifier:"text-gray-500"}}),{c(){Ye(e.$$.fragment)},l(r){ze(e.$$.fragment,r)},m(r,s){Xe(e,r,s),t=!0},p:ae,i(r){t||(le(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){Ge(e,r)}}}function jt(l){let e;const t=l[4].default,r=Et(t,l,l[3],null);return{c(){r&&r.c()},l(s){r&&r.l(s)},m(s,o){r&&r.m(s,o),e=!0},p(s,o){r&&r.p&&(!e||o&8)&&bt(r,t,s,s[3],e?gt(t,s[3],o,null):pt(s[3]),null)},i(s){e||(le(r,s),e=!0)},o(s){ne(r,s),e=!1},d(s){r&&r.d(s)}}}function hr(l){let e,t,r,s,o,a,n,i,u,f,m,k;const p=[dr,cr],c=[];function D(d,w){return d[0]?0:1}a=D(l),n=c[a]=p[a](l);let E=l[0]&&jt(l);return{c(){e=T("div"),t=T("div"),r=T("button"),s=W(l[1]),o=G(),n.c(),i=G(),E&&E.c(),this.h()},l(d){e=x(d,"DIV",{class:!0});var w=P(e);t=x(w,"DIV",{class:!0});var y=P(t);r=x(y,"BUTTON",{type:!0,class:!0});var O=P(r);s=F(O,l[1]),o=q(O),n.l(O),O.forEach(b),y.forEach(b),i=q(w),E&&E.l(w),w.forEach(b),this.h()},h(){g(r,"type","button"),g(r,"class","header border-gray-200 flex w-full items-center justify-between px-2 py-1.5 text-sm leading-4 font-medium bg-gray-100 text-gray-700 hover:text-gray-900 hover:bg-gray-200 focus:outline-none transition ease-in-out duration-150"),ce(r,"border-b",l[0]),g(t,"class","flex w-full sticky section-header cursor-pointer svelte-8pe196"),g(e,"class",u="section "+l[2]+" svelte-8pe196"),ce(e,"expanded",l[0])},m(d,w){Q(d,e,w),_(e,t),_(t,r),_(r,s),_(r,o),c[a].m(r,null),_(e,i),E&&E.m(e,null),f=!0,m||(k=we(t,"click",l[5]),m=!0)},p(d,[w]){(!f||w&2)&&ye(s,d[1]);let y=a;a=D(d),a===y?c[a].p(d,w):(lt(),ne(c[y],1,1,()=>{c[y]=null}),st(),n=c[a],n?n.p(d,w):(n=c[a]=p[a](d),n.c()),le(n,1),n.m(r,null)),w&1&&ce(r,"border-b",d[0]),d[0]?E?(E.p(d,w),w&1&&le(E,1)):(E=jt(d),E.c(),le(E,1),E.m(e,null)):E&&(lt(),ne(E,1,1,()=>{E=null}),st()),(!f||w&4&&u!==(u="section "+d[2]+" svelte-8pe196"))&&g(e,"class",u),w&5&&ce(e,"expanded",d[0])},i(d){f||(le(n),le(E),f=!0)},o(d){ne(n),ne(E),f=!1},d(d){d&&b(e),c[a].d(),E&&E.d(),m=!1,k()}}}function _r(l,e,t){let{$$slots:r={},$$scope:s}=e,{heading:o=""}=e,{modifier:a=""}=e,{expanded:n=!0}=e;const i=qt(),u=()=>{t(0,n=!n)};return l.$$set=f=>{"heading"in f&&t(1,o=f.heading),"modifier"in f&&t(2,a=f.modifier),"expanded"in f&&t(0,n=f.expanded),"$$scope"in f&&t(3,s=f.$$scope)},l.$$.update=()=>{l.$$.dirty&1&&i("toggle")},[n,o,a,s,r,u]}class Sr extends Fe{constructor(e){super();Ze(this,e,_r,hr,$e,{heading:1,modifier:2,expanded:0})}}function St(l,e,t){const r=l.slice();return r[37]=e[t],r}function Ot(l,e,t){const r=l.slice();return r[37]=e[t],r}function mr(l){let e,t,r;return{c(){e=T("option"),t=W("Histogram (Split)"),this.h()},l(s){e=x(s,"OPTION",{});var o=P(e);t=F(o,"Histogram (Split)"),o.forEach(b),this.h()},h(){e.__value=r=H.histogramSplit,e.value=e.__value},m(s,o){Q(s,e,o),_(e,t)},p:ae,d(s){s&&b(e)}}}function Ut(l){let e,t=l[37].title+"",r,s,o;return{c(){e=T("option"),r=W(t),s=G(),this.h()},l(a){e=x(a,"OPTION",{});var n=P(e);r=F(n,t),s=q(n),n.forEach(b),this.h()},h(){e.__value=o=l[37].name,e.value=e.__value},m(a,n){Q(a,e,n),_(e,r),_(e,s)},p(a,n){n[0]&512&&t!==(t=a[37].title+"")&&ye(r,t),n[0]&512&&o!==(o=a[37].name)&&(e.__value=o,e.value=e.__value)},d(a){a&&b(e)}}}function Ht(l){let e,t=l[37].title+"",r,s,o;return{c(){e=T("option"),r=W(t),s=G(),this.h()},l(a){e=x(a,"OPTION",{});var n=P(e);r=F(n,t),s=q(n),n.forEach(b),this.h()},h(){e.__value=o=l[37].name,e.value=e.__value},m(a,n){Q(a,e,n),_(e,r),_(e,s)},p(a,n){n[0]&512&&t!==(t=a[37].title+"")&&ye(r,t),n[0]&512&&o!==(o=a[37].name)&&(e.__value=o,e.value=e.__value)},d(a){a&&b(e)}}}function vr(l){var he,_e;let e,t,r,s,o,a,n,i,u,f,m,k,p,c,D,E,d,w,y,O,C,M,U,te,B,z,se,Y,j,R,A,pe,Ae,oe,je,Ee,X,J,L,Ie,Te,ue,ge,Ve,Le,Z,Se,ve,Me,Ke,de=l[14]===Je.curate_exposures&&mr();U=new rt({props:{src:or}});let xe=(he=l[9])!=null?he:[],K=[];for(let v=0;v<xe.length;v+=1)K[v]=Ut(Ot(l,xe,v));L=new rt({props:{src:ir,size:4}});let h=(_e=l[9])!=null?_e:[],I=[];for(let v=0;v<h.length;v+=1)I[v]=Ht(St(l,h,v));return{c(){e=T("div"),t=T("div"),r=T("div"),s=T("div"),o=T("label"),a=W("Type"),n=G(),i=T("select"),u=T("option"),f=W(`Scatter
          `),m=T("option"),k=W(`Histogram
          `),de&&de.c(),p=G(),c=T("div"),D=T("label"),E=W("# of bins"),d=G(),w=T("input"),O=G(),C=T("div"),M=T("button"),Ye(U.$$.fragment),te=G(),B=T("div"),z=T("div"),se=G(),Y=T("div"),j=T("div"),R=T("div"),A=T("label"),pe=W("X-axis"),Ae=G(),oe=T("select");for(let v=0;v<K.length;v+=1)K[v].c();Ee=G(),X=T("span"),J=T("button"),Ye(L.$$.fragment),Te=G(),ue=T("div"),ge=T("label"),Ve=W("Y-axis"),Le=G(),Z=T("select");for(let v=0;v<I.length;v+=1)I[v].c();this.h()},l(v){e=x(v,"DIV",{class:!0});var S=P(e);t=x(S,"DIV",{class:!0});var ee=P(t);r=x(ee,"DIV",{class:!0});var fe=P(r);s=x(fe,"DIV",{class:!0});var N=P(s);o=x(N,"LABEL",{for:!0,class:!0});var me=P(o);a=F(me,"Type"),me.forEach(b),n=q(N),i=x(N,"SELECT",{id:!0,class:!0});var Ne=P(i);u=x(Ne,"OPTION",{});var Re=P(u);f=F(Re,`Scatter
          `),Re.forEach(b),m=x(Ne,"OPTION",{});var ke=P(m);k=F(ke,`Histogram
          `),ke.forEach(b),de&&de.l(Ne),Ne.forEach(b),N.forEach(b),p=q(fe),c=x(fe,"DIV",{class:!0});var re=P(c);D=x(re,"LABEL",{for:!0,class:!0});var V=P(D);E=F(V,"# of bins"),V.forEach(b),d=q(re),w=x(re,"INPUT",{type:!0,id:!0,class:!0}),re.forEach(b),O=q(fe),C=x(fe,"DIV",{class:!0});var $=P(C);M=x($,"BUTTON",{type:!0,class:!0});var Pe=P(M);ze(U.$$.fragment,Pe),Pe.forEach(b),$.forEach(b),fe.forEach(b),ee.forEach(b),te=q(S),B=x(S,"DIV",{class:!0});var ie=P(B);z=x(ie,"DIV",{id:!0,class:!0}),P(z).forEach(b),ie.forEach(b),se=q(S),Y=x(S,"DIV",{class:!0});var nt=P(Y);j=x(nt,"DIV",{class:!0});var Oe=P(j);R=x(Oe,"DIV",{class:!0});var Qe=P(R);A=x(Qe,"LABEL",{for:!0,class:!0});var at=P(A);pe=F(at,"X-axis"),at.forEach(b),Ae=q(Qe),oe=x(Qe,"SELECT",{id:!0,class:!0});var ut=P(oe);for(let De=0;De<K.length;De+=1)K[De].l(ut);ut.forEach(b),Qe.forEach(b),Ee=q(Oe),X=x(Oe,"SPAN",{class:!0});var ft=P(X);J=x(ft,"BUTTON",{type:!0,class:!0});var ct=P(J);ze(L.$$.fragment,ct),ct.forEach(b),ft.forEach(b),Te=q(Oe),ue=x(Oe,"DIV",{class:!0});var We=P(ue);ge=x(We,"LABEL",{for:!0,class:!0});var dt=P(ge);Ve=F(dt,"Y-axis"),dt.forEach(b),Le=q(We),Z=x(We,"SELECT",{id:!0,class:!0});var ht=P(Z);for(let De=0;De<I.length;De+=1)I[De].l(ht);ht.forEach(b),We.forEach(b),Oe.forEach(b),nt.forEach(b),S.forEach(b),this.h()},h(){g(o,"for","type"),g(o,"class","inline-flex items-center px-2 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500"),u.__value=H.scatter,u.value=u.__value,m.__value=H.histogram,m.value=m.__value,g(i,"id","type"),g(i,"class","w-40 rounded-none rounded-r-md pl-3 pr-8 py-0.5 leading-5 border-gray-300 focus:outline-none focus:shadow-outline-blue focus:border-blue-300"),l[10]===void 0&&et(()=>l[21].call(i)),g(s,"class","flex mr-2 rounded-md shadow-sm"),g(D,"for","number-of-bins"),g(D,"class","inline-flex items-center px-2 rounded-l-md border border-r-0 whitespace-nowrap border-gray-300 bg-gray-50 text-gray-500"),g(w,"type","number"),g(w,"id","number-of-bins"),g(w,"class","w-16 rounded-none rounded-r-md px-2 py-0.5 border text-xs leading-5 border-gray-300 focus:outline-none focus:shadow-outline-blue focus:border-blue-300"),w.disabled=y=l[10]===H.scatter,g(c,"class","flex rounded-md shadow-sm"),ce(c,"hidden",l[10]===H.scatter),g(M,"type","button"),g(M,"class","inline-flex items-center px-1 py-0.5 border border-gray-300 leading-4 font-medium rounded-md text-gray-500 bg-white hover:text-gray-700 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:text-gray-800 active:bg-gray-50 transition ease-in-out duration-150"),g(C,"class","absolute top-0 right-0 flex rounded-md shadow-sm"),g(r,"class","relative flex items-center flex-wrap gap-2 pr-7"),g(t,"class","p-2 border-b border-gray-200 whitespace-nowrap"),g(z,"id","exposure-plot"),g(z,"class","svelte-huaxf5"),g(B,"class","p-2"),g(A,"for","x-axis"),g(A,"class","inline-flex items-center px-2 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500"),g(oe,"id","x-axis"),g(oe,"class","flex-1 block rounded-none rounded-r-md w-full pl-3 pr-10 py-0.5 leading-5 border-gray-300 focus:outline-none focus:shadow-outline-blue focus:border-blue-300"),l[11]===void 0&&et(()=>l[25].call(oe)),g(R,"class",je="flex "+(l[10]!==H.scatter?"w-1/2":"w-full")+" rounded-md shadow-sm"),g(J,"type","button"),g(J,"class","inline-flex items-center px-1 py-0.5 border border-gray-300 leading-4 font-medium rounded-md text-gray-500 bg-white hover:text-gray-700 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:text-gray-800 active:bg-gray-50 transition ease-in-out duration-150"),J.disabled=Ie=l[10]!==H.scatter,ce(J,"hidden",l[10]!==H.scatter),g(X,"class","inline-flex rounded-md shadow-sm"),g(ge,"for","y-axis"),g(ge,"class","inline-flex items-center px-2 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500"),g(Z,"id","y-axis"),g(Z,"class","flex-1 block rounded-none rounded-r-md w-full pl-3 pr-10 py-0.5 leading-5 border-gray-300 focus:outline-none focus:shadow-outline-blue focus:border-blue-300"),Z.disabled=Se=l[10]!==H.scatter,l[8]===void 0&&et(()=>l[26].call(Z)),g(ue,"class","flex w-full rounded-md shadow-sm"),ce(ue,"hidden",l[10]!==H.scatter),g(j,"class","flex gap-x-2"),ce(j,"justify-center",l[10]===H.scatter),g(Y,"class","p-2 border-t border-gray-200 text-xs whitespace-nowrap"),g(e,"class","relative text-xs")},m(v,S){Q(v,e,S),_(e,t),_(t,r),_(r,s),_(s,o),_(o,a),_(s,n),_(s,i),_(i,u),_(u,f),_(i,m),_(m,k),de&&de.m(i,null),He(i,l[10]),_(r,p),_(r,c),_(c,D),_(D,E),_(c,d),_(c,w),Tt(w,l[12]),_(r,O),_(r,C),_(C,M),Xe(U,M,null),_(e,te),_(e,B),_(B,z),l[23](z),l[24](B),_(e,se),_(e,Y),_(Y,j),_(j,R),_(R,A),_(A,pe),_(R,Ae),_(R,oe);for(let ee=0;ee<K.length;ee+=1)K[ee].m(oe,null);He(oe,l[11]),_(j,Ee),_(j,X),_(X,J),Xe(L,J,null),_(j,Te),_(j,ue),_(ue,ge),_(ge,Ve),_(ue,Le),_(ue,Z);for(let ee=0;ee<I.length;ee+=1)I[ee].m(Z,null);He(Z,l[8]),ve=!0,Me||(Ke=[we(i,"change",l[21]),we(w,"input",l[22]),vt(nr.call(null,M,{content:"Download plot image"})),we(M,"click",l[16]),we(oe,"change",l[25]),we(J,"click",l[15]),we(Z,"change",l[26])],Me=!0)},p(v,S){var ee,fe;if(v[14]===Je.curate_exposures&&de.p(v,S),S[0]&1024&&He(i,v[10]),(!ve||S[0]&1024&&y!==(y=v[10]===H.scatter))&&(w.disabled=y),S[0]&4096&&xt(w.value)!==v[12]&&Tt(w,v[12]),S[0]&1024&&ce(c,"hidden",v[10]===H.scatter),S[0]&512){xe=(ee=v[9])!=null?ee:[];let N;for(N=0;N<xe.length;N+=1){const me=Ot(v,xe,N);K[N]?K[N].p(me,S):(K[N]=Ut(me),K[N].c(),K[N].m(oe,null))}for(;N<K.length;N+=1)K[N].d(1);K.length=xe.length}if(S[0]&2560&&He(oe,v[11]),(!ve||S[0]&1024&&je!==(je="flex "+(v[10]!==H.scatter?"w-1/2":"w-full")+" rounded-md shadow-sm"))&&g(R,"class",je),(!ve||S[0]&1024&&Ie!==(Ie=v[10]!==H.scatter))&&(J.disabled=Ie),S[0]&1024&&ce(J,"hidden",v[10]!==H.scatter),S[0]&512){h=(fe=v[9])!=null?fe:[];let N;for(N=0;N<h.length;N+=1){const me=St(v,h,N);I[N]?I[N].p(me,S):(I[N]=Ht(me),I[N].c(),I[N].m(Z,null))}for(;N<I.length;N+=1)I[N].d(1);I.length=h.length}(!ve||S[0]&1024&&Se!==(Se=v[10]!==H.scatter))&&(Z.disabled=Se),S[0]&768&&He(Z,v[8]),S[0]&1024&&ce(ue,"hidden",v[10]!==H.scatter),S[0]&1024&&ce(j,"justify-center",v[10]===H.scatter)},i(v){ve||(le(U.$$.fragment,v),le(L.$$.fragment,v),ve=!0)},o(v){ne(U.$$.fragment,v),ne(L.$$.fragment,v),ve=!1},d(v){v&&b(e),de&&de.d(),Ge(U),l[23](null),l[24](null),ot(K,v),Ge(L),ot(I,v),Me=!1,yt(Ke)}}}function br(l,e,t){let r,s,o=ae,a=()=>(o(),o=be(j,h=>t(8,s=h)),j),n,i=ae,u=()=>(i(),i=be(z,h=>t(9,n=h)),z),f,m=ae,k=()=>(m(),m=be(R,h=>t(10,f=h)),R),p,c=ae,D=()=>(c(),c=be(Y,h=>t(11,p=h)),Y),E,d=ae,w=()=>(d(),d=be(B,h=>t(20,E=h)),B),y,O=ae,C=()=>(O(),O=be(A,h=>t(12,y=h)),A),M,U=ae,te=()=>(U(),U=be(pe,h=>t(29,M=h)),pe);l.$$.on_destroy.push(()=>o()),l.$$.on_destroy.push(()=>i()),l.$$.on_destroy.push(()=>m()),l.$$.on_destroy.push(()=>c()),l.$$.on_destroy.push(()=>d()),l.$$.on_destroy.push(()=>O()),l.$$.on_destroy.push(()=>U());let{exposures:B}=e;w();let{fields:z}=e;u();let{overviewHoverUid:se}=e,{plotAxisX:Y}=e;D();let{plotAxisY:j}=e;a();let{chartType:R}=e;k();let{nbinsx:A}=e;C();let{hoverAnchorNode:pe=Qt(null)}=e;te();let{setMicrograph:Ae}=e;const{projectUid:oe,jobUid:je,jobTypeKey:Ee}=Jt("jobData"),X={autosize:!0,hovermode:"closest",margin:{l:50,r:10,b:30,t:0,pad:5},xaxis:{title:"",automargin:!0},yaxis:{title:"",automargin:!0},legend:{orientation:"h",xanchor:"right",x:1,y:1,bgcolor:"#f1f5f9"}};let J,L,Ie;const Te=()=>{var h,I;return(I=(h=qe)==null?void 0:h.Plots)==null?void 0:I.resize(L)},ue=h=>{var _e,v;const I=(_e=h.points)==null?void 0:_e[0],he=parseInt((v=I==null?void 0:I.id)!=null?v:"");I&&!isNaN(he)&&Ae(he)},ge=h=>{var he,_e,v;if(clearTimeout(Ie),Wt(R)!==H.scatter)return;M!==J&&pe.set(J);const I=parseInt((v=(_e=(he=h==null?void 0:h.points)==null?void 0:he[0])==null?void 0:_e.id)!=null?v:"");isNaN(I)||se.set(I)},Ve=()=>{Ie=setTimeout(()=>{se.set(null)},400)},Le=()=>{const h=p;kt(Y,p=s,p),kt(j,s=h,s)},Z=h=>h===H.scatter?r.SCATTER:r.HISTOGRAM,Se=async()=>{const h=await qe.toImage("exposure-plot",{format:"png",height:900,width:1700}),I=document.createElement("a");I.download=`${oe}-${je}-overview-plot.png`,I.href=h,I.click()};Kt(()=>{const h=document.getElementById("exposure-plot");return qe.newPlot(h,[],X,{displayModeBar:!1,responsive:!0}),L==null||L.on("plotly_click",ue),L==null||L.on("plotly_hover",ge),L==null||L.on("plotly_unhover",Ve),window.addEventListener("togglesidebar",Te),window.addEventListener("toggleoutputs",Te),()=>{window.removeEventListener("toggleSidebar",Te),window.removeEventListener("toggleoutputs",Te)}});function ve(){f=it(this),R.set(f)}function Me(){y=xt(this.value),A.set(y)}function Ke(h){Be[h?"unshift":"push"](()=>{L=h,t(7,L)})}function de(h){Be[h?"unshift":"push"](()=>{J=h,t(13,J)})}function xe(){p=it(this),Y.set(p)}function K(){s=it(this),j.set(s)}return l.$$set=h=>{"exposures"in h&&w(t(0,B=h.exposures)),"fields"in h&&u(t(1,z=h.fields)),"overviewHoverUid"in h&&t(17,se=h.overviewHoverUid),"plotAxisX"in h&&D(t(2,Y=h.plotAxisX)),"plotAxisY"in h&&a(t(3,j=h.plotAxisY)),"chartType"in h&&k(t(4,R=h.chartType)),"nbinsx"in h&&C(t(5,A=h.nbinsx)),"hoverAnchorNode"in h&&te(t(6,pe=h.hoverAnchorNode)),"setMicrograph"in h&&t(18,Ae=h.setMicrograph)},l.$$.update=()=>{var h,I,he,_e,v,S,ee,fe,N,me,Ne,Re;if(l.$$.dirty[0]&4096&&(r={HISTOGRAM:{type:"histogram",nbinsx:y,mode:"markers"},SCATTER:{type:"scattergl",hoverinfo:"x+y",mode:"markers"}}),l.$$.dirty[0]&1580928&&L&&Array.isArray(E)&&(Ee===Je.manual_picker||Ee===Je.inspect_simple)){const ke=Z(f),re=Ce({name:"Exposures",marker:{opacity:.7,color:"#276fec"},x:[],y:[]},ke);f===H.scatter&&(re.ids=[]);for(let V=0;V<E.length;V++){const $=E[V];re.ids&&re.ids.push($.idx.toString()),re.x.push($[`${p}`]),(h=re.y)==null||h.push($[`${s}`])}t(19,X.xaxis.title=(he=(I=n==null?void 0:n.find(V=>V.name===p))==null?void 0:I.title)!=null?he:"",X),t(19,X.yaxis.title=f===H.scatter&&(v=(_e=n==null?void 0:n.find(V=>V.name===s))==null?void 0:_e.title)!=null?v:"",X),qe.react("exposure-plot",[re],X)}if(l.$$.dirty[0]&1580928&&L&&Array.isArray(E)&&Ee===Je.curate_exposures){const ke=Z(f),re=[];if(f===H.histogram){const V=Ce({x:[],name:"Exposures",marker:{opacity:.7,color:"#334155"}},ke);for(let $=0;$<E.length;$++){const Pe=E[$];V.x.push((S=Pe[`${p}`])!=null?S:0)}re.push(V)}else{const V=Ce({name:"Accepted",marker:{opacity:.7,color:"#276fec"},x:[],y:[]},ke),$=Ce({name:"Rejected",marker:{opacity:.7,color:"#f05252"},x:[],y:[]},ke);f===H.scatter&&(V.ids=[],$.ids=[]);for(let Pe=0;Pe<E.length;Pe++){const ie=E[Pe];ie.threshold_reject===!1&&ie.manual_reject===!1&&(V.ids&&V.ids.push(ie.idx.toString()),V.x.push(ie[`${p}`]),(ee=V.y)==null||ee.push(ie[`${s}`])),(ie.threshold_reject===!0||ie.manual_reject===!0)&&($.ids&&$.ids.push(ie.idx.toString()),$.x.push(ie[`${p}`]),(fe=$.y)==null||fe.push(ie[`${s}`]))}re.push(V,$)}t(19,X.xaxis.title=(me=(N=n==null?void 0:n.find(V=>V.name===p))==null?void 0:N.title)!=null?me:"",X),t(19,X.yaxis.title=f===H.scatter&&(Re=(Ne=n==null?void 0:n.find(V=>V.name===s))==null?void 0:Ne.title)!=null?Re:"",X),qe.react("exposure-plot",re,X)}},[B,z,Y,j,R,A,pe,L,s,n,f,p,y,J,Ee,Le,Se,se,Ae,X,E,ve,Me,Ke,de,xe,K]}class Or extends Fe{constructor(e){super();Ze(this,e,br,vr,$e,{exposures:0,fields:1,overviewHoverUid:17,plotAxisX:2,plotAxisY:3,chartType:4,nbinsx:5,hoverAnchorNode:6,setMicrograph:18},null,[-1,-1])}}function Vt(l,e,t){const r=l.slice();return r[22]=e[t],r}function Lt(l){let e,t=(l[11]?"Rejected (M)":"Rejected")+"",r;return{c(){e=T("p"),r=W(t),this.h()},l(s){e=x(s,"P",{class:!0});var o=P(e);r=F(o,t),o.forEach(b),this.h()},h(){g(e,"class","text-xs leading-4 text-orange-400")},m(s,o){Q(s,e,o),_(e,r)},p(s,o){o&2048&&t!==(t=(s[11]?"Rejected (M)":"Rejected")+"")&&ye(r,t)},d(s){s&&b(e)}}}function Mt(l){let e,t,r,s;return{c(){e=T("div"),t=T("img"),this.h()},l(o){e=x(o,"DIV",{class:!0});var a=P(e);t=x(a,"IMG",{src:!0,alt:!0,class:!0}),a.forEach(b),this.h()},h(){It(t.src,r=l[8])||g(t,"src",r),g(t,"alt",s="Exposure "+l[7]),g(t,"class","exposure-img h-auto w-full max-w-[120px] max-h-[120px] mx-auto object-cover rounded"),g(e,"class","w-full p-2.5")},m(o,a){Q(o,e,a),_(e,t)},p(o,a){a&256&&!It(t.src,r=o[8])&&g(t,"src",r),a&128&&s!==(s="Exposure "+o[7])&&g(t,"alt",s)},d(o){o&&b(e)}}}function Rt(l){var m,k;let e,t,r,s=tt((m=l[13])==null?void 0:m.found_at,"PP")+"",o,a,n,i=tt((k=l[13])==null?void 0:k.found_at,"h:mm:ss.SSS bb")+"",u,f;return{c(){e=T("dt"),t=W("Timestamp"),r=T("dd"),o=W(s),a=G(),n=T("br"),u=W(i),f=G(),this.h()},l(p){e=x(p,"DT",{class:!0});var c=P(e);t=F(c,"Timestamp"),c.forEach(b),r=x(p,"DD",{});var D=P(r);o=F(D,s),a=q(D),n=x(D,"BR",{}),u=F(D,i),f=q(D),D.forEach(b),this.h()},h(){g(e,"class","mt-1 text-gray-400")},m(p,c){Q(p,e,c),_(e,t),Q(p,r,c),_(r,o),_(r,a),_(r,n),_(r,u),_(r,f)},p(p,c){var D,E;c&8192&&s!==(s=tt((D=p[13])==null?void 0:D.found_at,"PP")+"")&&ye(o,s),c&8192&&i!==(i=tt((E=p[13])==null?void 0:E.found_at,"h:mm:ss.SSS bb")+"")&&ye(u,i)},d(p){p&&b(e),p&&b(r)}}}function Ct(l){var s;let e,t=(s=l[14])!=null?s:[],r=[];for(let o=0;o<t.length;o+=1)r[o]=Bt(Vt(l,t,o));return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=Ue()},l(o){for(let a=0;a<r.length;a+=1)r[a].l(o);e=Ue()},m(o,a){for(let n=0;n<r.length;n+=1)r[n].m(o,a);Q(o,e,a)},p(o,a){var n;if(a&24576){t=(n=o[14])!=null?n:[];let i;for(i=0;i<t.length;i+=1){const u=Vt(o,t,i);r[i]?r[i].p(u,a):(r[i]=Bt(u),r[i].c(),r[i].m(e.parentNode,e))}for(;i<r.length;i+=1)r[i].d(1);r.length=t.length}},d(o){ot(r,o),o&&b(e)}}}function Bt(l){var n,i;let e,t=l[22].title+"",r,s,o=((i=(n=l[13])==null?void 0:n[l[22].name])!=null?i:"-")+"",a;return{c(){e=T("dt"),r=W(t),s=T("dd"),a=W(o),this.h()},l(u){e=x(u,"DT",{class:!0});var f=P(e);r=F(f,t),f.forEach(b),s=x(u,"DD",{class:!0});var m=P(s);a=F(m,o),m.forEach(b),this.h()},h(){g(e,"class","mt-1 text-gray-400"),g(s,"class","break-words whitespace-pre-wrap")},m(u,f){Q(u,e,f),_(e,r),Q(u,s,f),_(s,a)},p(u,f){var m,k;f&16384&&t!==(t=u[22].title+"")&&ye(r,t),f&24576&&o!==(o=((k=(m=u[13])==null?void 0:m[u[22].name])!=null?k:"-")+"")&&ye(a,o)},d(u){u&&b(e),u&&b(s)}}}function pr(l){var D,E;let e,t,r,s=((D=l[13])==null?void 0:D.idx)+"",o,a,n,i,u,f,m=l[12]&&Lt(l),k=l[8]&&l[3]&&!l[6]&&Mt(l),p=((E=l[13])==null?void 0:E.found_at)&&Rt(l),c=!l[5]&&Ct(l);return{c(){e=T("div"),t=T("p"),r=W("Exposure "),o=W(s),a=G(),m&&m.c(),n=G(),k&&k.c(),i=G(),u=T("dl"),p&&p.c(),f=Ue(),c&&c.c(),this.h()},l(d){e=x(d,"DIV",{class:!0});var w=P(e);t=x(w,"P",{class:!0});var y=P(t);r=F(y,"Exposure "),o=F(y,s),y.forEach(b),a=q(w),m&&m.l(w),w.forEach(b),n=q(d),k&&k.l(d),i=q(d),u=x(d,"DL",{class:!0});var O=P(u);p&&p.l(O),f=Ue(),c&&c.l(O),O.forEach(b),this.h()},h(){g(t,"class","text-xs leading-4 font-medium text-gray-200"),g(e,"class","flex justify-between flex-wrap gap-y-1 gap-x-2"),g(u,"class","overflow-auto text-xs text-gray-300")},m(d,w){Q(d,e,w),_(e,t),_(t,r),_(t,o),_(e,a),m&&m.m(e,null),Q(d,n,w),k&&k.m(d,w),Q(d,i,w),Q(d,u,w),p&&p.m(u,null),_(u,f),c&&c.m(u,null)},p(d,w){var y,O;w&8192&&s!==(s=((y=d[13])==null?void 0:y.idx)+"")&&ye(o,s),d[12]?m?m.p(d,w):(m=Lt(d),m.c(),m.m(e,null)):m&&(m.d(1),m=null),d[8]&&d[3]&&!d[6]?k?k.p(d,w):(k=Mt(d),k.c(),k.m(i.parentNode,i)):k&&(k.d(1),k=null),((O=d[13])==null?void 0:O.found_at)?p?p.p(d,w):(p=Rt(d),p.c(),p.m(u,f)):p&&(p.d(1),p=null),d[5]?c&&(c.d(1),c=null):c?c.p(d,w):(c=Ct(d),c.c(),c.m(u,null))},d(d){d&&b(e),m&&m.d(),d&&b(n),k&&k.d(d),d&&b(i),d&&b(u),p&&p.d(),c&&c.d()}}}function gr(l){let e,t,r,s;function o(i){l[20](i)}function a(i){l[21](i)}let n={showPreview:l[7]!==null,modifier:"min-w-40 max-w-52",offset:4,position:l[9],$$slots:{default:[pr]},$$scope:{ctx:l}};return l[10]!==void 0&&(n.referenceNode=l[10]),l[4]!==void 0&&(n.showPreviewOverride=l[4]),e=new fr({props:n}),Be.push(()=>Pt(e,"referenceNode",o)),Be.push(()=>Pt(e,"showPreviewOverride",a)),{c(){Ye(e.$$.fragment)},l(i){ze(e.$$.fragment,i)},m(i,u){Xe(e,i,u),s=!0},p(i,[u]){const f={};u&128&&(f.showPreview=i[7]!==null),u&512&&(f.position=i[9]),u&33585640&&(f.$$scope={dirty:u,ctx:i}),!t&&u&1024&&(t=!0,f.referenceNode=i[10],At(()=>t=!1)),!r&&u&16&&(r=!0,f.showPreviewOverride=i[4],At(()=>r=!1)),e.$set(f)},i(i){s||(le(e.$$.fragment,i),s=!0)},o(i){ne(e.$$.fragment,i),s=!1},d(i){Ge(e,i)}}}function wr(l,e,t){let r,s,o,a,n,i,u,f,m,k=ae,p=()=>(k(),k=be(O,A=>t(7,m=A)),O),c,D=ae,E=()=>(D(),D=be(C,A=>t(19,c=A)),C),d,w=ae,y=()=>(w(),w=be(M,A=>t(14,d=A)),M);l.$$.on_destroy.push(()=>k()),l.$$.on_destroy.push(()=>D()),l.$$.on_destroy.push(()=>w());let{overviewHoverUid:O}=e;p();let{overviewHoverData:C}=e;E();let{hoverAttributes:M}=e;y();let{hoverAnchorNode:U}=e,{hasThumbnails:te}=e,{getThumbnailUrl:B}=e,z=!1,se,Y;function j(A){u=A,t(10,u),t(5,o),t(15,U),t(18,r)}function R(A){z=A,t(4,z)}return l.$$set=A=>{"overviewHoverUid"in A&&p(t(0,O=A.overviewHoverUid)),"overviewHoverData"in A&&E(t(1,C=A.overviewHoverData)),"hoverAttributes"in A&&y(t(2,M=A.hoverAttributes)),"hoverAnchorNode"in A&&t(15,U=A.hoverAnchorNode),"hasThumbnails"in A&&t(3,te=A.hasThumbnails),"getThumbnailUrl"in A&&t(16,B=A.getThumbnailUrl)},l.$$.update=()=>{l.$$.dirty&32768&&t(18,r=U==null?void 0:U.closest(".interactive-panel")),l.$$.dirty&32768&&t(6,s=(U==null?void 0:U.id)==="exposure-grid"),l.$$.dirty&32768&&t(5,o=(U==null?void 0:U.id)==="exposure-table"),l.$$.dirty&524288&&c&&t(17,se=c),l.$$.dirty&655376&&t(13,a=z?se:c),l.$$.dirty&524288&&t(12,n=(c==null?void 0:c.threshold_reject)===!0||(c==null?void 0:c.manual_reject)===!0),l.$$.dirty&524288&&t(11,i=(c==null?void 0:c.manual_reject)===!0),l.$$.dirty&294944&&t(10,u=o?U:r),l.$$.dirty&96&&t(9,f=s?"right-end":o?"right-start":"left-start"),l.$$.dirty&65664&&m!==null&&t(8,Y=B(m))},[O,C,M,te,z,o,s,m,Y,f,u,i,n,a,d,U,B,se,r,c,j,R]}class Ur extends Fe{constructor(e){super();Ze(this,e,wr,gr,$e,{overviewHoverUid:0,overviewHoverData:1,hoverAttributes:2,hoverAnchorNode:15,hasThumbnails:3,getThumbnailUrl:16})}}export{Or as E,Ur as O,Sr as S};
