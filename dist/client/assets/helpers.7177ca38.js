var wt=Object.defineProperty,ht=Object.defineProperties;var jt=Object.getOwnPropertyDescriptors;var Qe=Object.getOwnPropertySymbols;var vt=Object.prototype.hasOwnProperty,_t=Object.prototype.propertyIsEnumerable;var ze=(e,t,s)=>t in e?wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,J=(e,t)=>{for(var s in t||(t={}))vt.call(t,s)&&ze(e,s,t[s]);if(Qe)for(var s of Qe(t))_t.call(t,s)&&ze(e,s,t[s]);return e},P=(e,t)=>ht(e,jt(t));import{w as c,e as p,g as i,a1 as Ct,Y as Dt,n as Vt,a5 as xt}from"./vendor.3ae73048.js";import{J as A,s as We,Q as S,z as q,U as qt,l as ae,I as Qt,V as zt,u as f,W as Wt,X as At,N as $t,Y as Gt,Z as Ht,$ as Yt,a0 as Ae,p as N,a1 as $,a2 as $e,a3 as G,a4 as oe,a5 as ne,a6 as Ge,a7 as ie,a8 as Xt,a9 as Zt,aa as Ft,ab as Lt,P as Kt,e as re,n as M}from"./index.146c2037.js";import{f as ce,u as Jt,g as Nt,t as Bt,h as He,q as Ye,j as Pt,k as de,l as Mt,m as Ut,n as le,o as E,r as Xe,w as St,x as Rt,p as ue}from"./router.1b465492.js";const It=["uid","project_uid","workspace_uids","job_type","status","created_at","intermediate_results_size_bytes","intermediate_results_size_last_updated","job_dir_size","job_dir_size_last_updated","is_final_result","is_ancestor_of_final_result"],oa={motion:"motion",ctf:"ctf",extraction:"extraction",downsample:"downsample",restack:"restack"},na={estimate:"estimate",preprocessing:"preprocessing",intermediateResults:"intermediateResults",final:"final",jobStatus:"jobStatus"},ia={estimate:"Estimate",preprocessing:"Preprocessing",intermediateResults:"Intermediate Results",final:"Non-final Jobs",jobStatus:"Killed/Failed Jobs"};var Ze;(function(e){e.projects="projects",e.workspaces="workspaces",e.sessions="sessions",e.jobs="jobs"})(Ze||(Ze={}));var Fe;(function(e){e.valid="valid",e.notFound="notFound",e.permissionDenied="permissionDenied"})(Fe||(Fe={}));var Le;(function(e){e.tags="tags",e.owner_user_id="owner_user_id",e.starred_by="starred_by",e.created_at="created_at",e.notes="notes",e.deleted="deleted",e.archived="archived",e.detached="detached"})(Le||(Le={}));var Q;(function(e){e.uid="uid",e.size="size",e.workspaces="workspaces",e.sessions="sessions",e.jobs="jobs",e.updated_at="updated_at",e.accessed_at="accessed_at",e.created_at="created_at"})(Q||(Q={}));var Ke;(function(e){e.tags="tags",e.created_by_user_id="created_by_user_id",e.status="status",e.created_at="created_at",e.starred_by="starred_by",e.notes="notes"})(Ke||(Ke={}));var Z;(function(e){e.project_uid_workspace_uid="project_uid_workspace_uid",e.uid="uid",e.job_count="job_count",e.updated_at="updated_at",e.accessed_at="accessed_at",e.created_at="created_at"})(Z||(Z={}));var F;(function(e){e.tags="tags",e.created_by_user_id="created_by_user_id",e.status="status",e.created_at="created_at",e.starred_by="starred_by",e.notes="notes"})(F||(F={}));var k;(function(e){e.project_uid_session_uid="project_uid_session_uid",e.session_uid="session_uid",e.status="status",e.updated_at="updated_at",e.accessed_at="accessed_at",e.created_at="created_at"})(k||(k={}));var j;(function(e){e.tags="tags",e.created_by_user_id="created_by_user_id",e.job_type="job_type",e.job_category="job_category",e.status="status",e.lane="lane",e.created_at="created_at",e.queued_at="queued_at",e.completed_at="completed_at",e.killed_at="killed_at",e.failed_at="failed_at",e.started_at="started_at",e.last_exported="last_exported",e.starred_by="starred_by",e.deleted="deleted",e.interactive="interactive",e.dev="dev",e.final="final",e.final_ancestor="final_ancestor",e.final_or_ancestor="final_or_ancestor",e.not_final="not_final",e.not_final_or_ancestor="not_final_or_ancestor"})(j||(j={}));const ra=[j.final,j.final_ancestor,j.final_or_ancestor,j.not_final,j.not_final_or_ancestor],ca={[j.final]:"Final",[j.final_ancestor]:"Ancestor of Final",[j.final_or_ancestor]:"Final or Ancestor of Final",[j.not_final]:"Not Final",[j.not_final_or_ancestor]:"Not Final or Ancestor of Final"};var H;(function(e){e.project_uid="project_uid",e.uid="uid",e.job_type="job_type",e.status_num="status_num",e.lane="lane",e.priority="priority",e.created_at="created_at"})(H||(H={}));var Je;(function(e){e.building="Building",e.queued="Queued",e.launched="Launched",e.started="Started",e.waiting="Waiting",e.running="Running",e.killed="Killed",e.completed="Completed",e.failed="Failed"})(Je||(Je={}));var Ne;(function(e){e.card="card",e.table="table",e.tree="tree"})(Ne||(Ne={}));var x;(function(e){e.asc="asc",e.desc="desc"})(x||(x={}));var Be;(function(e){e.twenty_four_hours="twenty_four_hours",e.seven_days="seven_days",e.thirty_days="thirty_days",e.two_months="two_months",e.six_months="six_months",e.one_year="one_year"})(Be||(Be={}));var Pe;(function(e){e.created_at="created_at",e.completed_at="completed_at",e.started_at="started_at",e.waiting_at="waiting_at",e.last_exported="last_exported",e.queued_at="queued_at"})(Pe||(Pe={}));const da=[A.Building,A.Queued,A.Launched,A.Started,A.Waiting,A.Running,A.Killed,A.Completed,A.Failed],la=[{name:"Date Created",value:Q.created_at},{name:"Project ID",value:Q.uid},{name:"Size",value:Q.size},{name:"Workspaces",value:Q.workspaces},{name:"Sessions",value:Q.sessions},{name:"Jobs",value:Q.jobs},{name:"Stats Updated",value:Q.updated_at},{name:"Last Accessed",value:Q.accessed_at}],ua=[{name:"Date Created",value:Z.created_at},{name:"Project ID",value:Z.project_uid_workspace_uid},{name:"Workspace ID",value:Z.uid},{name:"Jobs",value:Z.job_count},{name:"Stats Updated",value:Z.updated_at},{name:"Last Accessed",value:Z.accessed_at}],pa=[{name:"Date Created",value:k.created_at},{name:"Project ID",value:k.project_uid_session_uid},{name:"Session ID",value:k.session_uid},{name:"Status",value:k.status},{name:"Stats Updated",value:k.updated_at},{name:"Last Accessed",value:k.accessed_at}],fa=[{name:"Date Created",value:H.created_at},{name:"Project ID",value:H.project_uid},{name:"Job ID",value:H.uid},{name:"Job Type",value:H.job_type},{name:"Status",value:H.status_num},{name:"Lane",value:H.lane},{name:"Priority",value:H.priority}];var L;(function(e){e.jobCards="jobCards",e.currentJobs="currentJobs",e.created="created",e.tags="tags",e.description="description",e.size="size"})(L||(L={}));var b;(function(e){e.size="size",e.workspaces="workspaces",e.sessions="sessions",e.jobs="jobs",e.info="info",e.description="description",e.lastAccessed="lastAccessed",e.created="created",e.statsUpdated="statsUpdated"})(b||(b={}));var K;(function(e){e.jobCards="jobCards",e.currentJobs="currentJobs",e.jobCategories="jobCategories",e.created="created",e.tags="tags",e.description="description"})(K||(K={}));var v;(function(e){e.jobs="jobs",e.description="description",e.lastAccessed="lastAccessed",e.created="created",e.statsUpdated="statsUpdated"})(v||(v={}));var _;(function(e){e.preview="preview",e.jobCards="jobCards",e.exposures="exposures",e.particles="particles",e.reconstruction="reconstruction",e.currentJobs="currentJobs",e.jobCategories="jobCategories",e.created="created",e.tags="tags",e.description="description"})(_||(_={}));var C;(function(e){e.status="status",e.notes="notes",e.lastAccessed="lastAccessed",e.created="created",e.statsUpdated="statsUpdated"})(C||(C={}));var z;(function(e){e.title="title",e.info="info",e.description="description",e.elapsed="elapsed",e.lane="lane",e.gpus="gpus",e.specParams="specParams",e.tags="tags"})(z||(z={}));var g;(function(e){e.title="title",e.info="info",e.status="status",e.elapsed="elapsed",e.lane="lane",e.priority="priority",e.created="created",e.description="description"})(g||(g={}));var D;(function(e){e.title="title",e.info="info",e.description="description",e.elapsed="elapsed",e.lane="lane",e.gpus="gpus",e.specParams="specParams",e.tags="tags",e.workflowTags="workflowTags",e.tooltip="tooltip"})(D||(D={}));const ya={[L.jobCards]:!0,[L.currentJobs]:!0,[L.created]:!0,[L.tags]:!0,[L.description]:!0,[L.size]:!1},ba={[b.size]:!0,[b.workspaces]:!0,[b.sessions]:!0,[b.jobs]:!0,[b.info]:!0,[b.description]:!0,[b.lastAccessed]:!0,[b.created]:!0,[b.statsUpdated]:!1},ga={[K.jobCards]:!0,[K.currentJobs]:!0,[K.jobCategories]:!0,[K.created]:!0,[K.tags]:!0,[K.description]:!0},ma={[v.jobs]:!0,[v.description]:!0,[v.lastAccessed]:!0,[v.created]:!0,[v.statsUpdated]:!1},Et={[_.preview]:!0,[_.jobCards]:!0,[_.exposures]:!0,[_.particles]:!0,[_.reconstruction]:!0,[_.currentJobs]:!0,[_.jobCategories]:!0,[_.created]:!0,[_.tags]:!0,[_.description]:!0},Tt={[C.status]:!0,[C.notes]:!0,[C.lastAccessed]:!0,[C.created]:!0,[C.statsUpdated]:!1},ka={[z.title]:!0,[z.info]:!0,[z.description]:!0,[z.elapsed]:!0,[z.lane]:!0,[z.gpus]:!0,[z.specParams]:!0,[z.tags]:!0},wa={[g.title]:!1,[g.info]:!0,[g.status]:!0,[g.elapsed]:!0,[g.lane]:!0,[g.priority]:!0,[g.created]:!0,[g.description]:!1},ha={[D.title]:!0,[D.info]:!0,[D.description]:!0,[D.elapsed]:!0,[D.lane]:!0,[D.gpus]:!0,[D.specParams]:!0,[D.tags]:!0,[D.workflowTags]:!0,[D.tooltip]:!0},ja=[b.size,b.workspaces,b.sessions,b.jobs,b.info,b.description,b.lastAccessed,b.created,b.statsUpdated],va=[v.jobs,v.description,v.lastAccessed,v.created,v.statsUpdated],Ot=[C.status,C.notes,C.lastAccessed,C.created,C.statsUpdated],_a=[g.title,g.info,g.status,g.elapsed,g.lane,g.priority,g.created,g.description];var Me;(function(e){e.selectExisiting="selectExisiting",e.createNew="createNew"})(Me||(Me={}));const Ca=["#e6194b","#3cb44b","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080","#ffffff","#000000"],Da={timestamps:!1,cpuMemoryUsage:!0,cpuMemoryAvailable:!0,tailEventLog:!1},Va=[{title:"Project ID",key:"project",checked:!0},{title:"Title",key:"title",checked:!0},{title:"Size",key:"size",checked:!0},{title:"Workspaces",key:"workspaces",checked:!0},{title:"Sessions",key:"sessions",checked:!0},{title:"Jobs",key:"jobs",checked:!0},{title:"Info",key:"info",checked:!0},{title:"Last Accessed",key:"lastAccessed",checked:!0},{title:"Last Accessed By",key:"lastAccessedBy",checked:!0},{title:"Created",key:"created",checked:!0},{title:"Created By",key:"createdBy",checked:!0},{title:"Stats Updated",key:"statsUpdated",checked:!1},{title:"Description",key:"description",checked:!1}],xa=[{title:"Project ID",key:"project",checked:!0},{title:"Workspace ID",key:"workspace",checked:!0},{title:"Title",key:"title",checked:!0},{title:"Jobs",key:"jobs",checked:!0},{title:"Last Accessed",key:"lastAccessed",checked:!0},{title:"Last Accessed By",key:"lastAccessedBy",checked:!0},{title:"Created",key:"created",checked:!0},{title:"Created By",key:"createdBy",checked:!0},{title:"Stats Updated",key:"statsUpdated",checked:!1},{title:"Description",key:"description",checked:!1}],qa=[{title:"Project ID",key:"project",checked:!0},{title:"Session ID",key:"session",checked:!0},{title:"Title",key:"title",checked:!0},{title:"Status",key:"status",checked:!0},{title:"Status Updated",key:"statusUpdated",checked:!0},{title:"Last Accessed",key:"lastAccessed",checked:!0},{title:"Last Accessed By",key:"lastAccessedBy",checked:!0},{title:"Created",key:"created",checked:!0},{title:"Created By",key:"createdBy",checked:!0},{title:"Stats Updated",key:"statsUpdated",checked:!1},{title:"Description",key:"description",checked:!1}],Qa=[{title:"Project ID",key:"project",checked:!0},{title:"Job ID",key:"job",checked:!0},{title:"Type",key:"type",checked:!0},{title:"Status",key:"status",checked:!0},{title:"Status Updated",key:"statusUpdated",checked:!0},{title:"Elapsed",key:"elapsed",checked:!0},{title:"Lane",key:"lane",checked:!0},{title:"Priority",key:"priority",checked:!0},{title:"Created",key:"created",checked:!0},{title:"Created By",key:"createdBy",checked:!0},{title:"Title",key:"title",checked:!1},{title:"Raw Job Type",key:"rawType",checked:!1},{title:"Elapsed in Seconds",key:"elapsedSeconds",checked:!1},{title:"Description",key:"description",checked:!1}],es=(e,t)=>{const{subscribe:s,set:a}=c(t);return(async()=>{try{const o=await ce("getInstanceStateVal",e);typeof o=="string"&&a(JSON.parse(o))}catch(o){console.error("Error (getInstanceStateVal) on",e,o)}})(),{subscribe:s,set:o=>{ce("setInstanceStateVal",e,JSON.stringify(o)),a(o)}}},ts=es(qt.instanceName,"Structura Bio"),ss=async()=>{const e=await f.core.getLatestVersion();e!==null&&Wt.set(e)},as=async()=>{const e=await f.core.getLiveStatus();At.set(e)},os=async()=>{const e=await f.core.getEclStatus();$t.set(e)},ns=async()=>{const e=await q("/api/utility/click_wrap");Gt.set(e.value===!1)},is=async()=>{const e=await f.core.getGenerateIntermediateResultsJobTypes();Ht.set(e)},rs=async()=>{const e=await f.core.getComputeRegistries();Yt.set(e)},cs=()=>{ae("initData"),Nt(),ss(),as(),os(),ns(),is(),i(Qt)==="develop"&&rs()},w=p([We,Jt],([e,t])=>{var a,o,n,r,d,y,u,l,h,m,V,W,U,_e,Ce,De,Ve;const s=t.find(kt=>{var xe,qe;return((xe=kt.id)==null?void 0:xe.replace("-",""))===((qe=e.user)==null?void 0:qe.id)});return s?{id:(o=(a=s==null?void 0:s._id)!=null?a:s==null?void 0:s.id)==null?void 0:o.replace("-",""),username:s==null?void 0:s.name,email:(d=(r=(n=s==null?void 0:s.emails)==null?void 0:n[0])==null?void 0:r.address)!=null?d:"",firstName:(y=s==null?void 0:s.first_name)!=null?y:s==null?void 0:s.firstName,lastName:(u=s==null?void 0:s.last_name)!=null?u:s==null?void 0:s.lastName,admin:s==null?void 0:s.roles.__global_roles__.includes("admin"),createdAt:s==null?void 0:s.created_at,stateInitialized:typeof(s==null?void 0:s.state)!="undefined",licenseAccepted:((l=s==null?void 0:s.state)==null?void 0:l.licenseAccepted)===!0,recentProjects:(h=s==null?void 0:s.state)==null?void 0:h.recentProjects,recentWorkspaces:(m=s==null?void 0:s.state)==null?void 0:m.recentWorkspaces,recentSessions:(V=s==null?void 0:s.state)==null?void 0:V.recentSessions,recentJobs:(W=s==null?void 0:s.state)==null?void 0:W.recentJobs,userCanModifyLiveDataManagement:((U=s==null?void 0:s.state)==null?void 0:U.userCanModifyLiveDataManagement)===!0,userCanSetJobPriority:((_e=s==null?void 0:s.state)==null?void 0:_e.userCanSetJobPriority)===!0,defaultJobPriority:typeof((Ce=s==null?void 0:s.state)==null?void 0:Ce.defaultJobPriority)=="number"?(De=s==null?void 0:s.state)==null?void 0:De.defaultJobPriority:null,lanes:(Ve=s.lanes)!=null?Ve:null}:e.user}),Ue=p(We,e=>{var t,s;return(s=(t=e.user)==null?void 0:t.id)!=null?s:null}),ds=p(w,e=>(e==null?void 0:e.admin)===!0),ls=p(w,e=>{var t;return(t=e==null?void 0:e.username)!=null?t:""}),us=p(w,e=>{var t;return(t=e==null?void 0:e.firstName)!=null?t:""}),ps=p(w,e=>{var t;return(t=e==null?void 0:e.lastName)!=null?t:""}),fs=p(w,e=>[e==null?void 0:e.firstName,e==null?void 0:e.lastName].filter(Boolean).join(" ")),ys=p(w,e=>{var t,s,a,o,n,r;return`${(a=(s=(t=e==null?void 0:e.firstName)==null?void 0:t.substring(0,1))==null?void 0:s.toUpperCase())!=null?a:"?"}${(r=(n=(o=e==null?void 0:e.lastName)==null?void 0:o.substring(0,1))==null?void 0:n.toUpperCase())!=null?r:"?"}`}),bs=p(w,e=>{var t;return(t=e==null?void 0:e.email)!=null?t:""}),gs=p(w,e=>{var t;return(t=e==null?void 0:e.stateInitialized)!=null?t:!1}),ms=p(w,e=>{var t;return(t=e==null?void 0:e.licenseAccepted)!=null?t:!1}),Se=p(w,e=>{var t;return(t=e==null?void 0:e.recentProjects)!=null?t:[]}),Re=p(w,e=>{var t;return(t=e==null?void 0:e.recentWorkspaces)!=null?t:[]}),Ie=p(w,e=>{var t;return(t=e==null?void 0:e.recentSessions)!=null?t:[]}),Ee=p(w,e=>{var t;return(t=e==null?void 0:e.recentJobs)!=null?t:[]}),Te=c([]),Oe=c([]),et=c([]),tt=c([]),st=c([]),at=c([]),ot=c([]),nt=c([]),ks=async(e="",t={},s=void 0,a=void 0,o=void 0)=>{if(Ae.includes(e)){const n=performance.now(),r=await N(`/api/data/query/${e}`,{single:!0,query:t,projection:s,sort:a,skip:o}),d=performance.now(),y=parseFloat((d-n).toFixed(3));return console.log("res",r,y),P(J({},r),{fetchElapsed:y})}},ws=async(e="",t={},s=void 0,a=void 0,o=void 0,n=void 0)=>{if(Ae.includes(e)){const r=performance.now(),d=await N(`/api/data/query/${e}`,{query:t,projection:s,sort:a,limit:n,skip:o}),y=performance.now(),u=parseFloat((y-r).toFixed(3));return console.log("res",d,u),P(J({},d),{fetchElapsed:u})}},hs=()=>{ae("terminateData"),Bt(),zt.set(!1)};Se.subscribe(e=>{!S(e,i(Te))&&(async()=>{const s=e.reduce((n,r,d)=>d===0?`project_uids=${r}`:`${n}&project_uids=${r}`,""),o=await q(`/api/actions/projects?${s}&fields=uid&fields=title&limit=50`);Oe.set(o)})(),Te.set(e)});Re.subscribe(e=>{const t=e.reduce((a,o)=>[...a,`${o.project_uid}-${o.workspace_uid}`],[]);!S(t,i(et))&&(async()=>{const a=t.reduce((r,d,y)=>y===0?`workspace_uids=${d}`:`${r}&workspace_uids=${d}`,""),n=await q(`/api/actions/workspaces?${a}&fields=project_uid&fields=uid&fields=title&limit=50`);tt.set(n)})(),et.set(t)});Ie.subscribe(e=>{const t=e.reduce((a,o)=>[...a,`${o.project_uid}-${o.session_uid}`],[]);!S(t,i(st))&&(async()=>{const a=t.reduce((r,d,y)=>y===0?`session_uids=${d}`:`${r}&session_uids=${d}`,""),n=await q(`/api/actions/sessions?${a}&fields=project_uid&fields=session_uid&fields=title&limit=50`);at.set(n)})(),st.set(t)});Ee.subscribe(e=>{const t=e.reduce((a,o)=>[...a,`${o.project_uid}-${o.job_uid}`],[]);!S(t,i(ot))&&(async()=>{const a=t.reduce((r,d,y)=>y===0?`job_uids=${d}`:`${r}&job_uids=${d}`,""),n=await q(`/api/actions/jobs?${a}&fields=project_uid&fields=uid&fields=job_type&fields=status&limit=50`);nt.set(n)})(),ot.set(t)});var za=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",instanceName:ts,initData:cs,user:w,userId:Ue,isAdmin:ds,username:ls,firstName:us,lastName:ps,fullName:fs,initials:ys,email:bs,userStateInitialized:gs,licenseAccepted:ms,userRecentProjects:Se,userRecentWorkspaces:Re,userRecentSessions:Ie,userRecentJobs:Ee,recentProjects:Oe,recentWorkspaces:tt,recentSessions:at,recentJobs:nt,findOne:ks,find:ws,terminateData:hs});const Wa=["black","gray","red","orange","yellow","green","teal","cyan","sky","blue","indigo","purple","pink"],js={black:"bg-black",gray:"bg-gray-500",red:"bg-red-600",orange:"bg-orange-600",yellow:"bg-yellow-500",green:"bg-green-600",teal:"bg-teal-500",cyan:"bg-cyan-600",sky:"bg-sky-500",blue:"bg-blue-600",indigo:"bg-indigo-600",purple:"bg-purple-500",pink:"bg-pink-600"},Aa={black:"bg-gray-600",gray:"bg-gray-600",red:"bg-red-700",orange:"bg-orange-700",yellow:"bg-yellow-600",green:"bg-green-700",teal:"bg-teal-600",cyan:"bg-cyan-700",sky:"bg-sky-600",blue:"bg-blue-700",indigo:"bg-indigo-700",purple:"bg-purple-600",pink:"bg-pink-700"},$a={general:"General",project:"Project",workspace:"Workspace",session:"Session",job:"Job"},Ga={general:"General tags can be applied to projects, workspaces, sessions, and jobs.",project:"Project tags can be applied to just projects.",workspace:"Workspace tags can be applied to just workspaces.",session:"Session tags can be applied to just sessions.",job:"Job tags can be applied to just jobs."},Ha=async(e,t,s,a,o)=>{if(typeof e=="string"&&e.length>0)return await f.core.createTag(e,i(Ue),t,s,a,o)},Ya=async(e,t,s,a)=>{typeof e!="string"||!G(e)||(typeof t!="string"||t.length===0)&&(typeof s!="string"||s.length===0)&&typeof a!="string"||await f.core.updateTag(e,t,s,a)},Xa=async e=>{typeof e!="string"||e.length===0||await f.core.removeTag(e)},Za=async(e,t)=>{typeof e!="string"||!$(e)||typeof t!="string"||!G(t)||await f.core.addTagToProject(e,t)},Fa=async(e,t,s)=>{typeof e!="string"||!$(e)||typeof t!="string"||!oe(t)||typeof s!="string"||!G(s)||await f.core.addTagToWorkspace(e,t,s)},La=async(e,t,s)=>{typeof e!="string"||!$(e)||typeof t!="string"||!ne(t)||typeof s!="string"||!G(s)||await f.core.addTagToSession(e,t,s)},Ka=async(e,t,s)=>{typeof e!="string"||!$(e)||typeof t!="string"||!$e(t)||typeof s!="string"||!G(s)||await f.core.addTagToJob(e,t,s)},Ja=async(e,t)=>{typeof e!="string"||!$(e)||typeof t!="string"||!G(t)||await f.core.removeTagFromProject(e,t)},Na=async(e,t,s)=>{typeof e!="string"||!$(e)||typeof t!="string"||!oe(t)||typeof s!="string"||!G(s)||await f.core.removeTagFromWorkspace(e,t,s)},Ba=async(e,t,s)=>{typeof e!="string"||!$(e)||typeof t!="string"||!ne(t)||typeof s!="string"||!G(s)||await f.core.removeTagFromSession(e,t,s)},Pa=async(e,t,s)=>{typeof e!="string"||!$(e)||typeof t!="string"||!$e(t)||typeof s!="string"||!G(s)||await f.core.removeTagFromJob(e,t,s)},vs=(e,t,s)=>{const a=e!=null?e:"",o=t!=null?t:"";return s==="desc"?o.localeCompare(a):a.localeCompare(o)},it=(e,t,s)=>{const a=e!=null?e:0,o=t!=null?t:0;return s==="desc"?o-a:a-o},_s=(e,t,s)=>{const a=e!=null?e:0,o=t!=null?t:0;return s==="desc"?new Date(o).getTime()-new Date(a).getTime():new Date(a).getTime()-new Date(o).getTime()},rt=(e,t,s=null)=>{const a=t.reduce((o,n)=>o&&o[n]!=="undefined"?o[n]:void 0,e);return s&&a?a[s(a)]:a},B=(e,t,s,a="number")=>e.sort((o,n)=>{const r=typeof t=="string"?o[t]:rt(o,t),d=typeof t=="string"?n[t]:rt(n,t);return a==="string"?vs(r,d,s):a==="date"?_s(r,d,s):it(r,d,s)}),Ma=(e,t="asc")=>e.sort((s,a)=>{const o=parseInt(s.replace(/\D/g,"")),n=parseInt(a.replace(/\D/g,""));return it(o,n,t)});var ct=(e,t,s)=>{const{subscribe:a,set:o,update:n}=c(s);return(async()=>{const r=await q(`/api/actions/users/view-options?granularity=${e}&view=${t}`);Object.keys(r).length&&o(r)})(),{subscribe:a,update:n,set:r=>{N("/api/actions/users/set-view-options",{granularity:e,view:t,value:r}),o(r)}}},Cs=(e,t)=>{const{subscribe:s,set:a,update:o}=c(t);return(async()=>{const n=await q(`/api/actions/users/table-order?granularity=${e}`);(n==null?void 0:n.length)&&a(n)})(),{subscribe:s,update:o,set:n=>{N("/api/actions/users/set-table-order",{granularity:e,value:n}),a(n)}}};const Ds=c(!1),Vs=ct(ie.sessions,Ge.card,Et),xs=ct(ie.sessions,Ge.table,Tt),qs=Cs(ie.sessions,Ot),pe=c(!0),Qs=c(!0),zs=c(!0),Ws=c(!0),R=c(!0),T=c(!1),fe=c([]),As=p(fe,e=>e.map(t=>t.uid)),ye=c(e=>{}),be=c(e=>{}),ge=c(!1),I=c({}),dt=c(""),O=(()=>{const{subscribe:e,set:t,update:s}=c(25);return{subscribe:e,set:t,increment:a=>s(o=>o+a),reset:()=>t(25)}})(),me=(()=>{const{subscribe:e,set:t,update:s}=c();return{subscribe:e,set:t,update:s,reset:()=>{var a;return(a=i(me))==null?void 0:a.scrollTo({top:0,behavior:"smooth"})}}})(),ee=p(He,(e,t)=>{var s,a;ye.set(t),t((a=(s=e.find(({id:o})=>o==="sessionsListCount"))==null?void 0:s.count)!=null?a:null)}),lt=p(He,(e,t)=>{var s,a;be.set(t),t((a=(s=e.find(({id:o})=>o==="allBrowseSessionsCount"))==null?void 0:s.count)!=null?a:null)}),ut=p([Ye,Pt],([e,t])=>{const s=[],{tags:a,created_by_user_id:o,status:n,created_at:r,starred_by:d,notes:y}=e;return Array.isArray(a)&&s.push({name:"Tags",key:F.tags,value:t.filter(u=>a.includes(u.uid)).map(u=>({name:`${u.uid}: ${u.title}`,key:u.uid,class:js[u.colour]})),class:"bg-red-600"}),typeof o=="string"&&s.push({name:"Created by",key:F.created_by_user_id,value:i(Ut)[o],class:"bg-blue-600"}),Array.isArray(n)&&s.push({name:"Status",key:F.status,value:n.map(u=>({name:Xt(u),key:u,class:Zt(u)})),class:"bg-gray-600"}),typeof r=="string"&&s.push({name:"Date created",key:F.created_at,value:Ft(r),class:"bg-green-600"}),typeof d=="string"&&s.push({name:"Starred",key:F.starred_by,value:!0,class:"bg-pink-600"}),typeof y=="boolean"&&s.push({name:"Has notes",key:F.notes,value:!0,class:"bg-pink-600"}),s}),Y=p(de,e=>{if(!e.length)return[];const t=i(I),{pUids:s,tags:a,created_by_user_id:o,status:n,created_at:r,starred_by:d,notes:y,sort_option:u,sort_order:l}=t,h=e.filter(m=>{var V,W;return!(Array.isArray(s)&&!s.includes(m.project_uid)||Array.isArray(a)&&!((V=m==null?void 0:m.tags)==null?void 0:V.some(U=>a==null?void 0:a.includes(U)))||typeof o=="string"&&m.created_by_user_id!==o||Array.isArray(n)&&m.status&&!n.includes(m.status)||typeof r=="string"&&!Lt(r,m.created_at)||typeof d=="string"&&!((W=m.starred_by)==null?void 0:W.includes(d))||typeof y=="boolean"&&!m.notes)});switch(i(T)&&T.set(!1),u){case k.project_uid_session_uid:return B(B(h,"session_uid_num",l!=null?l:x.desc,"number"),"project_uid_num",l!=null?l:x.desc,"number");case k.session_uid:return B(h,"session_uid_num",l!=null?l:x.desc,"number");case k.status:return B(h,"status",l!=null?l:x.desc,"string");case k.updated_at:return B(h,"updated_at",l!=null?l:x.desc,"date");case k.accessed_at:return B(h,["last_accessed","accessed_at"],l!=null?l:x.desc,"date");default:return B(h,"created_at",l!=null?l:x.desc,"date")}});Ct.subscribe(()=>{R.set(!0);const{queryString:e,searchObject:t,queryObject:s}=Mt();if(t.type!==Kt.sessions){ge.set(!0);return}const a={},{valid:o,projectUid:n}=t,{session_projects:r,tags:d,created_by_user_id:y,status:u,created_at:l,starred_by:h,notes:m,sort_option:V,sort_order:W}=s;o&&n&&(a.pUids=[n]),o&&Array.isArray(r)&&(a.pUids=[...new Set([...n?[n]:[],...r])]),Array.isArray(d)&&(a.tags=d),typeof y=="string"&&(a.created_by_user_id=y),Array.isArray(u)&&(a.status=u),typeof l=="string"&&(a.created_at=l),typeof h=="string"&&(a.starred_by=h),typeof m=="boolean"&&(a.notes=m),typeof V=="string"&&Object.values(k).includes(V)?a.sort_option=V:typeof V=="undefined"&&(a.sort_option=k.created_at),typeof W=="string"&&Object.values(x).includes(W)?a.sort_order=W:typeof V=="undefined"&&(a.sort_order=x.desc),(!S(i(I),a)||i(ge))&&(I.set(a),O.reset(),me.reset(),R.set(!1)),dt.set(e),ge.set(!1)});const ke=(e=1)=>{const t=i(ee),s=i(lt),a=i(ye),o=i(be);t-e>=0?a(s-e):a(0),s-e>=0?o(s-e):o(0)},$s=async()=>{pe.set(!0);const e=await q("/api/actions/projects/session_projects");fe.set(e),pe.set(!1)},Gs=()=>{if(i(Y).length<i(ee)){R.set(!0);const e=i(ee)-i(Y).length;e>=25?O.increment(25):e>0&&O.increment(e),R.set(!1),T.set(!0)}},Hs=()=>{const e=Object.assign({},i(Ye));i(ut).forEach(({key:t})=>{e[t]&&delete e[t]}),Dt.update(t=>P(J({},t),{params:e}))},Ys=e=>{var o;e.preventDefault();const t=i(Y).findIndex(n=>`${n.project_uid}-${n.session_uid}`===i(le)[i(le).length-1]);if(!i(Y)[t+1])return;const{project_uid:s,session_uid:a}=i(Y)[t+1];e.metaKey?E.set([...i(E),{selection:"session",timestamp:new Date().getTime(),identifier:`${s}-${a}`,projectUid:s,sessionUid:a}]):((o=document.getElementById(`browse-session-${s}-${a}`))==null||o.focus(),Xe(e,s,a))},Xs=e=>{var o;e.preventDefault();const t=i(Y).findIndex(n=>`${n.project_uid}-${n.session_uid}`===i(le)[0]);if(!i(Y)[t-1])return;const{project_uid:s,session_uid:a}=i(Y)[t-1];e.metaKey?E.set([{selection:"session",timestamp:new Date().getTime(),identifier:`${s}-${a}`,projectUid:s,sessionUid:a},...i(E)]):((o=document.getElementById(`browse-session-${s}-${a}`))==null||o.focus(),Xe(e,s,a))};var Ua=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",showSessionsCSVAlert:Ds,cardViewOptions:Vs,tableViewOptions:xs,tableOrder:qs,loadingSessionProjects:pe,loadingSessions:Qs,loadingSessionsCount:zs,loadingAllSessionsCount:Ws,loadingQueryData:R,loadingScrollData:T,liveSessionProjects:fe,liveSessionProjectUids:As,browseCountSetter:ye,fullCountSetter:be,filterQueryObject:I,prevQueryString:dt,limit:O,browseWrapper:me,browseSessionsCount:ee,allSessionsCount:lt,filterBarData:ut,allBrowseSessions:Y,decrementCount:ke,getProjects:$s,handleSetNextLimit:Gs,handleRemoveAllFilters:Hs,selectNextSession:Ys,selectPreviousSession:Xs});const X=c(null),we=c(null),Zs=c([]),Fs=async(e,t)=>{ae("Fetching session export jobs data",e,t);const s=`?project_uids=${e}&session_uids=${t}`,a=`&fields=${It.join("&fields=")}`,o=await q(`/api/actions/jobs${s}${a}`);Array.isArray(o)&&Zs.set(o.filter(n=>{var r;return(r=n.job_type)==null?void 0:r.includes("export")}))},Ls=()=>{we.set(null),X.set(null)},Sa=(e,t)=>{var a;we.set(t),X.set(e);const s=(a=i(de).find(({session_uid:o})=>o===t))==null?void 0:a.uid;s&&Fs(e,s)},Ra=async()=>{await f.rtp.compactSession(i(X),i(we)),Ls()},he=c(null),Ia=(e,t,s=null)=>{X.set(e),he.set(t)},Ks=()=>{X.set(null),he.set(null)},Ea=async()=>{await f.rtp.markSessionCompleted(i(X),i(he)),Ks()},je=c(null),ve=c(null),pt=c(1),Js=()=>{je.set(null),X.set(null),ve.set(null),pt.set(1)},Ta=(e,t,s=null)=>{je.set(t),X.set(e),ve.set(s)},Oa=async()=>{await f.rtp.restoreCompactedSession(i(X),i(je),i(ve),i(pt)),Js()},te=c(null),se=c(null),ft=c([]),yt=c([]),Ns=p([de,te],([e,t])=>{var s;return(s=e.find(({uid:a})=>a===t))==null?void 0:s.session_uid}),Bs=()=>{te.set(null),se.set(null),ft.set([]),yt.set([])},eo=async(e,t,s=()=>{console.info("No callback passed")})=>{const a=await f.core.requestDeleteWorkspace(e,t),o=!!(a!==!0&&a&&a.length===2);return a!==!0&&(a&&a.length===2?(te.set(t),se.set(e),ft.set(a[0]),yt.set(a[1])):(re("Handle Request Delete Workspace Failed"),M.add({title:"Unable to delete workspace",type:"danger",style:"minimal"}))),s(),o||ke(),o},to=async()=>{try{await f.core.deleteWorkspace(i(se),i(te)),ke(),St(i(se),i(Ns)),Bs()}catch(e){re("Delete session failed: ",e)}},Ps=async(e,t)=>{try{await N("/api/actions/sessions/star_session",{sUid:e,pUid:t})}catch(s){console.error(`Error starring ${t} ${e}: `,s),M.add({title:`${t} ${e} could not be starred`,type:"danger",style:"minimal"})}},Ms=async(e,t)=>{try{await N("/api/actions/sessions/unstar_session",{sUid:e,pUid:t})}catch(s){console.error(`Error unstarring ${t} ${e}: `,s),M.add({title:`${t} ${e} could not be unstarred`,type:"danger",style:"minimal"})}},so=async(e,t,s)=>{s?await Ms(t,e):await Ps(t,e)},Us=async()=>await q("/api/actions/sessions/workspace_session_keys"),ao=async(e,t)=>{if(e&&t)try{await N("/api/actions/stats/refresh_session",{projectUid:e,sessionUid:t})}catch(s){console.error(`Error refreshing session stats for ${e} ${t}: `,s)}},oo=async(e,t)=>{const s=bt("Downloading Sessions CSV");try{const a=J({filename:e,columns:t},i(I)),o=await ce("getSessionsCSV",a),n=document.createElement("a");n.setAttribute("href",o),n.setAttribute("download",`${e}.csv`),document.body.appendChild(n),n.click(),gt("Sessions CSV Download Ready",s)}catch(a){mt("Sessions CSV Download Ready",a.message,s)}},Ss=e=>{const t=i(Rt).find(s=>s.id===e);return(t==null?void 0:t.name)?`by ${t==null?void 0:t.name}`:""},bt=e=>{const t=Vt();return M.add({id:t,title:e,type:"loading",style:"minimal",persistent:!0}),t},gt=(e,t)=>{M.add(P(J({},t&&{id:t}),{title:e,type:"success",style:"minimal",persistent:!1}))},mt=(e,t,s)=>{re(`${e}: `,t),M.add(P(J({},s&&{id:s}),{title:e,type:"danger",style:"minimal",persistent:!1}))},Rs=e=>Object.keys(e).reduce((t,s,a)=>e[s]?t+`${a>0?"&":""}fields=${s}`:t,""),Is=(e,t)=>t.length?t.reduce((s,a,o)=>o===0?`${e}=${a}`:`${s}&${e}=${a}`,""):`${e}=''`,Es=async e=>{var a;await xt();const t=typeof e=="string"?document.getElementById(e):e;((a=t==null?void 0:t.children)==null?void 0:a.length)?t==null||t.classList.remove("hidden"):t==null||t.classList.add("hidden")},Ts=async()=>{const e=i(ue).projectUid,t=i(ue).sessionUid;let s=i(ue).workspaceUid;if(!e||!$(e))throw new Error("Must be inside of a valid project");if((!t||!ne(t))&&(!s||!oe(s)))throw new Error("Must be inside of a valid workspace");return t&&(s=(await Us())[e][t]),[e,s]},Os=(e=null)=>["heading","bold","italic","strikethrough","quote","|","code","unordered-list","ordered-list","table","horizontal-rule","|","link","image","|","preview","side-by-side",...e?[{name:"fullscreen",action:()=>{const t=document.querySelector(".EasyMDEContainer > .editor-toolbar > .fullscreen");(t==null?void 0:t.classList.contains("active"))?t.classList.remove("active"):t==null||t.classList.add("active"),e()},className:"fa fa-arrows-alt",noDisable:!0,noMobile:!0,title:"Toggle Fullscreen"}]:[],"|","guide"];var no=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getModifiedBy:Ss,handleNotifyStart:bt,handleSuccess:gt,handleError:mt,formatFieldsForQuery:Rs,formatArrayForQuery:Is,hideEmptyNode:Es,validateLocation:Ts,buildEasyMDEToolbar:Os});export{Ds as $,Us as A,Ka as B,js as C,Pa as D,$s as E,ao as F,Da as G,Is as H,Ca as I,j as J,za as K,Ua as L,so as M,dt as N,Aa as O,Le as P,Oe as Q,tt as R,x as S,at as T,nt as U,ls as V,Ke as W,ys as X,fs as Y,gs as Z,ms as _,w as a,to as a$,cs as a0,hs as a1,oa as a2,na as a3,It as a4,b as a5,la as a6,Es as a7,Ss as a8,Ne as a9,eo as aA,lt as aB,Hs as aC,I as aD,R as aE,O as aF,me as aG,T as aH,Qs as aI,zs as aJ,Ws as aK,Xs as aL,Ys as aM,Gs as aN,La as aO,Ba as aP,g as aQ,ra as aR,ca as aS,fa as aT,ps as aU,us as aV,Qa as aW,se as aX,Ns as aY,ft as aZ,yt as a_,F as aa,da as ab,Za as ac,Ja as ad,v as ae,ua as af,Fe as ag,Ze as ah,Fa as ai,Na as aj,Vs as ak,qs as al,xs as am,C as an,ut as ao,pa as ap,ee as aq,fe as ar,pe as as,Ms as at,Ps as au,Y as av,k as aw,Sa as ax,Ta as ay,Ia as az,Cs as b,Bs as b0,we as b1,X as b2,Zs as b3,Ra as b4,Ls as b5,je as b6,pt as b7,Oa as b8,Js as b9,ve as ba,he as bb,Ea as bc,Ks as bd,ia as be,Me as bf,Wa as bg,Ha as bh,Va as bi,xa as bj,qa as bk,oo as bl,_s as bm,ts as bn,Os as bo,Ya as bp,Xa as bq,rt as br,vs as bs,it as bt,Ga as bu,$a as bv,no as bw,ba as c,ja as d,Q as e,gt as f,mt as g,bt as h,ds as i,Z as j,ga as k,ma as l,va as m,Ma as n,Rs as o,ya as p,Je as q,H as r,B as s,ka as t,Ue as u,wa as v,ct as w,ha as x,_a as y,Ts as z};
