import{S as ae,h as fe,s as ue,C as S,I as E,D as I,J as q,E as N,k as $,au as B,o as j,t as y,H as R,p as _,j as U,l as K,m as L,L as ce,u as me,af as D,at as J,Q as z,a6 as h,R as A,T as F,a7 as g,U as T,ae as C,a2 as k,K as P,ao as de,ac as pe,a5 as _e,aM as be,ak as he,g as V}from"./vendor.3ae73048.js";import{d as ge}from"./index.ef7d8fe7.js";import{a as $e,M as ke}from"./ModifyWorkflow.d7b7b3a1.js";import{K as H}from"./router.1b465492.js";import{n as we}from"./index.146c2037.js";import{w as je,A as ve}from"./index.11580965.js";import"./types.8cb6216c.js";import{I as Me}from"./Icon.61279884.js";import{C as ye}from"./CubeTransparent.d87c4b84.js";import{Q as Ce,t as Te,M as Se,a as Ee}from"./Spinner.012207c4.js";import"./helpers.7177ca38.js";import"./ChevronUp.0ab7bee0.js";import"./FooterButton.95026c94.js";import"./PageDialog.0c69a37b.js";import"./index.2e3bb17a.js";import"./Unfold.f168270e.js";import"./Target.7baf7004.js";import"./Flag.5ce531b9.js";import"./Folder.9bc96b35.js";import"./purify.es.5cdb46dc.js";import"./QuestionMarkCircle.1d0a7a5c.js";import"./EyeOff.8789b395.js";import"./Eye.d9501c14.js";import"./LockClosed.9ead7228.js";import"./FlagFilled.38eba9fd.js";import"./jobs.7ab064ef.js";import"./index.c4392b02.js";import"./jobs.d50d1674.js";function G(n,e,l){const o=n.slice();o[22]=e[l];const t=o[0].jobs[o[22]].jobType;return o[23]=t,o}function X(n){let e,l,o,t,f,r,s;function a(i){n[15](i)}let m={workflow:n[0],updates:n[3],$$slots:{confirm:[Ne],"header-auxiliary":[qe],header:[Ie]},$$scope:{ctx:n}};n[5]!==void 0&&(m.bus=n[5]),e=new ke({props:m}),D.push(()=>J(e,"bus",a)),e.$on("confirm",n[10]),e.$on("cancel",n[11]);function u(i){n[17](i)}function b(i){n[18](i)}let c={$$slots:{default:[Ae,({args:i})=>({21:i}),({args:i})=>i?2097152:0]},$$scope:{ctx:n}};return n[6]!==void 0&&(c.handleShowMenu=n[6]),n[7]!==void 0&&(c.closeMenu=n[7]),t=new Ce({props:c}),D.push(()=>J(t,"handleShowMenu",u)),D.push(()=>J(t,"closeMenu",b)),{c(){S(e.$$.fragment),o=E(),S(t.$$.fragment)},l(i){I(e.$$.fragment,i),o=q(i),I(t.$$.fragment,i)},m(i,p){N(e,i,p),$(i,o,p),N(t,i,p),s=!0},p(i,p){const w={};p&1&&(w.workflow=i[0]),p&8&&(w.updates=i[3]),p&67109719&&(w.$$scope={dirty:p,ctx:i}),!l&&p&32&&(l=!0,w.bus=i[5],B(()=>l=!1)),e.$set(w);const M={};p&69206017&&(M.$$scope={dirty:p,ctx:i}),!f&&p&64&&(f=!0,M.handleShowMenu=i[6],B(()=>f=!1)),!r&&p&128&&(r=!0,M.closeMenu=i[7],B(()=>r=!1)),t.$set(M)},i(i){s||(j(e.$$.fragment,i),j(t.$$.fragment,i),s=!0)},o(i){y(e.$$.fragment,i),y(t.$$.fragment,i),s=!1},d(i){R(e,i),i&&_(o),R(t,i)}}}function Ie(n){let e,l,o,t=n[0].title+"",f,r;return l=new Me({props:{src:ye,type:"outline",modifier:"stroke-2"}}),{c(){e=z("span"),S(l.$$.fragment),o=E(),f=h(t),this.h()},l(s){e=A(s,"SPAN",{class:!0});var a=F(e);I(l.$$.fragment,a),a.forEach(_),o=q(s),f=g(s,t),this.h()},h(){T(e,"class","p-0.5 mr-2.5 font-semibold rounded text-indigo-600 bg-indigo-200")},m(s,a){$(s,e,a),N(l,e,null),$(s,o,a),$(s,f,a),r=!0},p(s,a){(!r||a&1)&&t!==(t=s[0].title+"")&&C(f,t)},i(s){r||(j(l.$$.fragment,s),r=!0)},o(s){y(l.$$.fragment,s),r=!1},d(s){s&&_(e),R(l),s&&_(o),s&&_(f)}}}function Y(n){var u;let e,l,o=((u=n[1])==null?void 0:u.size)+"",t,f,r=n[2].length+"",s,a,m;return{c(){e=z("button"),l=h("Rebuilt: "),t=h(o),f=h("/"),s=h(r),this.h()},l(b){e=A(b,"BUTTON",{class:!0});var c=F(e);l=g(c,"Rebuilt: "),t=g(c,o),f=g(c,"/"),s=g(c,r),c.forEach(_),this.h()},h(){T(e,"class","px-1.5 py-0.75 border rounded text-xs font-medium text-indigo-600 bg-indigo-100 border-indigo-300 hover:bg-indigo-200")},m(b,c){$(b,e,c),k(e,l),k(e,t),k(e,f),k(e,s),a||(m=P(e,"click",n[13]),a=!0)},p(b,c){var i;c&2&&o!==(o=((i=b[1])==null?void 0:i.size)+"")&&C(t,o),c&4&&r!==(r=b[2].length+"")&&C(s,r)},d(b){b&&_(e),a=!1,m()}}}function Z(n){let e,l,o,t,f=n[2].length+"",r,s,a;return{c(){e=z("button"),l=h("New: "),o=h(n[9]),t=h("/"),r=h(f),this.h()},l(m){e=A(m,"BUTTON",{class:!0});var u=F(e);l=g(u,"New: "),o=g(u,n[9]),t=g(u,"/"),r=g(u,f),u.forEach(_),this.h()},h(){T(e,"class","px-1.5 py-0.75 border rounded text-xs font-medium text-emerald-700 bg-emerald-100 border-emerald-400 hover:bg-emerald-200")},m(m,u){$(m,e,u),k(e,l),k(e,o),k(e,t),k(e,r),s||(a=P(e,"click",n[14]),s=!0)},p(m,u){u&512&&C(o,m[9]),u&4&&f!==(f=m[2].length+"")&&C(r,f)},d(m){m&&_(e),s=!1,a()}}}function qe(n){var b;let e,l,o,t,f,r,s,a,m=((b=n[1])==null?void 0:b.size)&&Y(n),u=n[9]&&Z(n);return{c(){e=z("div"),m&&m.c(),l=E(),u&&u.c(),o=E(),t=z("div"),f=h("Removed: "),r=h(n[4]),this.h()},l(c){e=A(c,"DIV",{slot:!0,class:!0});var i=F(e);m&&m.l(i),l=q(i),u&&u.l(i),o=q(i),t=A(i,"DIV",{class:!0});var p=F(t);f=g(p,"Removed: "),r=g(p,n[4]),p.forEach(_),i.forEach(_),this.h()},h(){T(t,"class","px-1.5 py-0.75 border rounded text-xs font-medium text-rose-700 bg-rose-100 border-rose-400 cursor-help"),T(e,"slot","header-auxiliary"),T(e,"class","flex items-center gap-2 ml-auto")},m(c,i){$(c,e,i),m&&m.m(e,null),k(e,l),u&&u.m(e,null),k(e,o),k(e,t),k(t,f),k(t,r),s||(a=de(Te.call(null,t,{content:"The number of jobs removed from the original workflow."})),s=!0)},p(c,i){var p;((p=c[1])==null?void 0:p.size)?m?m.p(c,i):(m=Y(c),m.c(),m.m(e,l)):m&&(m.d(1),m=null),c[9]?u?u.p(c,i):(u=Z(c),u.c(),u.m(e,o)):u&&(u.d(1),u=null),i&16&&C(r,c[4])},d(c){c&&_(e),m&&m.d(),u&&u.d(),s=!1,a()}}}function Ne(n){let e;return{c(){e=h("Create")},l(l){e=g(l,"Create")},m(l,o){$(l,e,o)},d(l){l&&_(e)}}}function Re(n){let e=n[22]+"",l,o,t=V(H)[n[23]].title+"",f,r;return{c(){l=h(e),o=h(": "),f=h(t),r=E()},l(s){l=g(s,e),o=g(s,": "),f=g(s,t),r=q(s)},m(s,a){$(s,l,a),$(s,o,a),$(s,f,a),$(s,r,a)},p(s,a){a&2097152&&e!==(e=s[22]+"")&&C(l,e),a&2097153&&t!==(t=V(H)[s[23]].title+"")&&C(f,t)},d(s){s&&_(l),s&&_(o),s&&_(f),s&&_(r)}}}function x(n){let e,l;function o(){return n[16](n[22])}return e=new Ee({props:{$$slots:{default:[Re]},$$scope:{ctx:n}}}),e.$on("click",o),{c(){S(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,f){N(e,t,f),l=!0},p(t,f){n=t;const r={};f&69206017&&(r.$$scope={dirty:f,ctx:n}),e.$set(r)},i(t){l||(j(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){R(e,t)}}}function ze(n){let e,l,o=n[21].jobs,t=[];for(let r=0;r<o.length;r+=1)t[r]=x(G(n,o,r));const f=r=>y(t[r],1,1,()=>{t[r]=null});return{c(){for(let r=0;r<t.length;r+=1)t[r].c();e=U()},l(r){for(let s=0;s<t.length;s+=1)t[s].l(r);e=U()},m(r,s){for(let a=0;a<t.length;a+=1)t[a].m(r,s);$(r,e,s),l=!0},p(r,s){if(s&2101249){o=r[21].jobs;let a;for(a=0;a<o.length;a+=1){const m=G(r,o,a);t[a]?(t[a].p(m,s),j(t[a],1)):(t[a]=x(m),t[a].c(),j(t[a],1),t[a].m(e.parentNode,e))}for(K(),a=o.length;a<t.length;a+=1)f(a);L()}},i(r){if(!l){for(let s=0;s<o.length;s+=1)j(t[s]);l=!0}},o(r){t=t.filter(Boolean);for(let s=0;s<t.length;s+=1)y(t[s]);l=!1},d(r){he(t,r),r&&_(e)}}}function Ae(n){let e,l;return e=new Se({props:{$$slots:{default:[ze]},$$scope:{ctx:n}}}),{c(){S(e.$$.fragment)},l(o){I(e.$$.fragment,o)},m(o,t){N(e,o,t),l=!0},p(o,t){const f={};t&69206017&&(f.$$scope={dirty:t,ctx:o}),e.$set(f)},i(o){l||(j(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){R(e,o)}}}function Fe(n){let e,l,o=n[0]&&X(n);return{c(){o&&o.c(),e=U()},l(t){o&&o.l(t),e=U()},m(t,f){o&&o.m(t,f),$(t,e,f),l=!0},p(t,[f]){t[0]?o?(o.p(t,f),f&1&&j(o,1)):(o=X(t),o.c(),j(o,1),o.m(e.parentNode,e)):o&&(K(),y(o,1,1,()=>{o=null}),L())},i(t){l||(j(o),l=!0)},o(t){y(o),l=!1},d(t){o&&o.d(t),t&&_(e)}}}function Ue(n,e,l){let o,t,f,r,s,a=pe,m=()=>(a(),a=be(p,d=>l(20,s=d)),p);ce(n,je,d=>l(19,r=d)),n.$$.on_destroy.push(()=>a());let u,b,c,i=0,p,w,M;const ee=d=>{const{workflow:v}=d.detail,W=v.title===(u==null?void 0:u.title),ie=v.category===(u==null?void 0:u.category);if(W&&ie)return we.add({title:"New workflow must have a unique title",type:"danger",style:"minimal"});delete v._id,ge(v,{rebuilt:!0}),O()},O=()=>ve.set(!1),Q=d=>{M(),_e().then(()=>{s==null||s.dispatchEvent(new CustomEvent("select:job",{detail:{id:d}}))})};me(async()=>{var v;const d=await $e(r);l(0,u=d==null?void 0:d.workflow),l(3,b=d==null?void 0:d.updates),l(1,c=d==null?void 0:d.repopulatedJobs),l(4,i=(v=d==null?void 0:d.removedJobs)!=null?v:0)});const te=d=>w(d,{jobs:Array.from(c!=null?c:[])}),oe=d=>w(d,{jobs:f});function se(d){p=d,m(l(5,p))}const le=d=>Q(d);function ne(d){w=d,l(6,w)}function re(d){M=d,l(7,M)}return n.$$.update=()=>{var d,v;n.$$.dirty&1&&l(2,o=Object.keys((d=u==null?void 0:u.jobs)!=null?d:{})),n.$$.dirty&6&&l(9,t=o.length-((v=c==null?void 0:c.size)!=null?v:0)),n.$$.dirty&6&&l(8,f=o.filter(W=>!(c==null?void 0:c.has(W))))},[u,c,o,b,i,p,w,M,f,t,ee,O,Q,te,oe,se,le,ne,re]}class mt extends ae{constructor(e){super();fe(this,e,Ue,Fe,ue,{})}}export{mt as default};
