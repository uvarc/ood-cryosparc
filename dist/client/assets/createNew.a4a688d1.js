import{e as i,w as r,g as s}from"./vendor.3ae73048.js";import{a1 as u,a4 as S,a5 as V,aw as H,u as j,b as d,ah as C,a as N,f as Q}from"./index.146c2037.js";import{R as A,U as X}from"./jobs.7ab064ef.js";import{E as Y,F as Z,A as E}from"./helpers.7177ca38.js";import{p as T,$,R as L,I as x,f as O,a0 as ee,a1 as te,r as se,L as K,c as M,a2 as ae,a3 as oe,a4 as ce,a5 as re}from"./router.1b465492.js";import{b as ne,a as B,c as le,g as ie}from"./index.c4392b02.js";const g=r(""),w=r(""),D=r(""),h=r(!1),f=r(""),k=r(""),de=i([g,w],([e,t])=>e.length>0&&t.length>0&&t.startsWith("/")),pe=()=>{h.set(!s(h)),s(h)&&s(f).length===0&&f.set("Data Processing")},ue=e=>{e.target!==null&&e.target instanceof HTMLInputElement&&(e.target.value.length===0?h.set(!1):h.set(!0))},we=()=>{const e=s(w);H(e.length>0?e:null,t=>{w.set(t)},"Select Project Container Directory")},he=async()=>{if(s(g).length===0)k.set("Enter a project title");else if(s(w).length===0)k.set("Enter a container directory");else{const e=await j.core.validateNewProject(s(g),s(w));e.valid===!1?k.set(e.message):k.set("")}},F=()=>{d("createNew","closeNewProject"),g.set(""),w.set(""),D.set(""),h.set(!1),f.set(""),k.set(""),C()},je=async()=>{const e=s(g),t=s(w),a=s(D),o=s(h),c=s(f),n={};if(e.length>0&&t.length>0&&t.startsWith("/")){d("createNew","handleCreateProject",{title:e,path:t,description:a,createInitialWorkspace:o,workspaceTitle:c});const l=await j.core.createProject(e,a.length>0?a:null,t);if(l!==null)if(n.projectUid=l,ne(),$(),F(),o){const U=await j.core.createWorkspace(l,c.length>0?c:null);U!==null?(n.workspaceUid=U,B(),L(l,U)):(N("handleCreateProject: no workspace UID, routing to project workspaces"),x(l))}else x(l)}else d("createNew","handleCreateProject invalid");return n},p=r(null),v=r([]),ge=i(v,e=>e.filter(t=>t.detached!==!0&&t.archived!==!0).map(t=>({uid:t.uid,text:`${t.uid}: ${t.title}`}))),ke=async(e=!1)=>{if(s(v).length>0&&!e)return;const t=await O("getProjectList",{deleted:!1},{uid:1,uid_num:1,title:1,detached:1,archived:1});v.set(t!=null?t:[])},J=r(""),I=r(""),fe=i([J,p],([e,t])=>e.length>0&&t!==null&&u(t)),R=()=>{d("createNew","closeNewWorkspace"),J.set(""),I.set(""),p.set(null),C()},Pe=async()=>{const e=s(p),t=s(J),a=s(I),o={};if(t.length>0&&e!==null&&u(e)){d("createNew","handleCreateWorkspace",{projectUid:e,title:t,description:a});const c=await j.core.createWorkspace(e,t,a.length>0?a:null);c!==null?(o.workspaceUid=c,B(),A(e),L(e,c),ee(),R()):N("handleCreateWorkspace: no workspace UID")}return o},P=r(""),We=i([P,p],([e,t])=>e.length>0&&t!==null&&u(t)),z=()=>{d("createNew","closeNewSession"),P.set(""),p.set(null),C()},be=async()=>{const e=s(p),t=s(P);if(t.length>0&&e!==null&&u(e)){d("createNew","handleCreateSession",{projectUid:e,title:t});const a=await j.rtp.createSession(s(p),s(P));typeof a=="string"&&(le(),Y(),A(e),Z(e,a),te(e,a),se(null,e,a),z())}},Ue=r(null),y=r([]),Se=i(y,e=>e.map(t=>({uid:t.uid,text:`${t.uid}: ${t.title}`}))),Ce=async()=>{const e=await O("getWorkspaceList",{deleted:!1,pUids:s(p)===null?[]:[s(p)]},{project_uid:1,project_uid_num:1,uid:1,uid_num:1,session_uid:1,session_uid_num:1,workspace_type:1,created_at:1,title:1,deleted:1,created_by_user_id:1},{created_at:-1});y.set(e!=null?e:[])},W=i(T,e=>{var t;return(t=e.projectUid)!=null?t:null}),b=i(T,e=>{var t;return(t=e.workspaceUid)!=null?t:null}),m=i(T,e=>{var t;return(t=e.sessionUid)!=null?t:null}),_=r(null),Ne=i([_,W,b],([e,t,a])=>e!==null&&(e==null?void 0:e.length)>0&&t!==null&&u(t)&&a!==null&&S(a)),ve=i([W,b,m],([e,t,a])=>e!==null&&u(e)&&(t!==null&&S(t)||a!==null&&V(a))),G=()=>{d("createNew","closeNewJob"),_.set(""),C()},q=(e,t)=>{ie(),X(e,t),G(),K(e,t),M(void 0,e,t)},Je=async()=>{const e=s(W),t=s(m);let a=s(b);const o=s(_);if(o!==null&&(o==null?void 0:o.length)>0&&e!==null&&u(e)&&(a!==null&&S(a)||t!==null&&V(t))){t&&(a=(await E())[e][t]),d("createNew","handleCreateJob",{projectUid:e,workspaceUid:a,type:o});const c=await j.core.createJob(e,a,o);c!==null?q(e,c):N("handleCreateJob: no job UID")}},me=async e=>{const t=s(ae),a=s(oe),o=s(W),c=s(m);let n=s(b);if(e!==null&&(e==null?void 0:e.length)>0&&o!==null&&u(o)&&(n!==null&&S(n)||c!==null&&V(c))&&a===o){c&&(n=(await E())[o][c]),d("createNew","handleCreateJob",{projectUid:o,workspaceUid:n,jobType:e,outputGroups:t,cartProjectUid:a});const l=await j.core.createJobFromCart(o,n,e,t);l?(K(a,l),M(null,a,l),ce(),re(Q.builder)):N("handleCreateCartJob: no job UID")}};var Ae=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",projectTitle:g,projectPath:w,projectDescription:D,initialWorkspace:h,initialWorkspaceTitle:f,createProjectValidationMessage:k,createProjectValid:de,toggleInitialWorkspace:pe,handleInitialWorkspaceTitle:ue,handleSelectProjectPath:we,validateNewProject:he,closeNewProject:F,handleCreateProject:je,projectUid:p,projects:v,projectOptions:ge,getProjects:ke,workspaceTitle:J,workspaceDescription:I,createWorkspaceValid:fe,closeNewWorkspace:R,handleCreateWorkspace:Pe,sessionTitle:P,createSessionValid:We,closeNewSession:z,handleCreateSession:be,workspaceUid:Ue,workspaces:y,workspaceOptions:Se,getWorkspaces:Ce,currentProjectUid:W,currentWorkspaceUid:b,currentSessionUid:m,jobType:_,createJobValid:Ne,createJobValidLocation:ve,closeNewJob:G,setupJob:q,handleCreateJob:Je,handleCreateCartJob:me});export{v as A,y as B,Ce as C,F as D,k as E,he as F,ue as a,je as b,Ae as c,w as d,D as e,f,de as g,we as h,h as i,Pe as j,ge as k,p as l,I as m,fe as n,ke as o,g as p,_ as q,Je as r,q as s,pe as t,ve as u,me as v,J as w,be as x,P as y,We as z};
