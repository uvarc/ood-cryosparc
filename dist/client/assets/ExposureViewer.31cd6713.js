import{S as be,h as pe,s as _e,Q as D,C as $,R as E,T as C,D as ee,p as I,U as _,k as G,E as te,ao as ke,ac as A,o as B,t as L,H as ne,af as me,at as Ye,a6 as K,I as F,a7 as J,J as R,a2 as w,K as O,l as ze,m as De,au as Xe,ae as Pe,ad as Ee,aM as Y,u as Ze,P as Ve,q as zt,ap as Dt,an as ce,a9 as Me,j as Oe,a3 as Je,a4 as Qe,y as je,z as Le,A as Fe,B as Re,aL as Et,aq as Wt,aT as Ct,w as $e,av as et}from"./vendor.3ae73048.js";import{n as qe,w as Ge}from"./wNumb.f094d5b4.js";import"./types.8cb6216c.js";import{I as We}from"./Icon.61279884.js";import{T as Ke,I as tt,D as Ut}from"./index.11580965.js";import{t as Ce,S as nt}from"./Spinner.012207c4.js";import{T as Tt}from"./Toggle.70c4dc3f.js";import{bb as ye,ba as se}from"./index.146c2037.js";import{Z as Pt,M as Vt,H as Bt}from"./Move.f1d750f0.js";import{R as Nt}from"./Ruler.d04aefd7.js";import{D as jt}from"./DownloadImage.d10f042a.js";import{A as Lt}from"./ArrowsExpand.dfc75310.js";import{f as lt}from"./index.2e3bb17a.js";function st(t){let e,n,s,o,l,i;return n=new We({props:{src:tt,size:4,modifier:"text-gray-400"}}),{c(){e=D("span"),$(n.$$.fragment),this.h()},l(c){e=E(c,"SPAN",{class:!0});var r=C(e);ee(n.$$.fragment,r),r.forEach(I),this.h()},h(){_(e,"class","ml-2 cursor-help")},m(c,r){G(c,e,r),te(n,e,null),o=!0,l||(i=ke(s=Ce.call(null,e,{content:"Visualization only: Box size not used to produce outputs",placement:"bottom"})),l=!0)},p:A,i(c){o||(B(n.$$.fragment,c),o=!0)},o(c){L(n.$$.fragment,c),o=!1},d(c){c&&I(e),ne(n),l=!1,i()}}}function Ft(t){let e,n,s,o,l,i,c,r,a,f,u,m,v,S,M,x,b,h,W,N,T,d=t[4]&&st();function g(p){t[11](p)}let z={};return t[8]!==void 0&&(z.value=t[8]),i=new Ke({props:z}),me.push(()=>Ye(i,"value",g)),{c(){e=D("div"),n=D("div"),s=K(`Box Size (px)
    `),d&&d.c(),o=F(),l=D("div"),$(i.$$.fragment),r=F(),a=D("input"),f=F(),u=D("div"),m=D("div"),v=F(),S=D("div"),M=D("p"),x=K(t[7]),b=K(" \xC5"),this.h()},l(p){e=E(p,"DIV",{class:!0});var y=C(e);n=E(y,"DIV",{class:!0});var U=C(n);s=J(U,`Box Size (px)
    `),d&&d.l(U),U.forEach(I),o=R(y),l=E(y,"DIV",{class:!0});var P=C(l);ee(i.$$.fragment,P),P.forEach(I),r=R(y),a=E(y,"INPUT",{min:!0,step:!0,class:!0,type:!0}),f=R(y),u=E(y,"DIV",{class:!0});var H=C(u);m=E(H,"DIV",{class:!0}),C(m).forEach(I),H.forEach(I),v=R(y),S=E(y,"DIV",{class:!0});var Z=C(S);M=E(Z,"P",{class:!0});var X=C(M);x=J(X,t[7]),b=J(X," \xC5"),X.forEach(I),Z.forEach(I),y.forEach(I),this.h()},h(){_(n,"class","flex-grow relative inline-flex justify-between px-2.5 py-1.5 rounded-bl border border-gray-300 bg-white text-xs whitespace-nowrap leading-4 font-medium text-gray-700 select-none"),_(l,"class","-ml-px relative inline-flex items-center px-2 border text-xs leading-4 font-medium transition ease-in-out duration-150 border-gray-300 bg-white text-gray-700"),_(a,"min",0),_(a,"step",2),_(a,"class","relative w-18 px-2.5 py-1.5 border border-l-0 border-gray-300 bg-white text-xs leading-4 font-medium text-gray-700 hover:text-gray-500 focus:z-10 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-100 active:text-gray-700"),_(a,"type","number"),a.value=t[5],_(m,"class","horizontal-slider svelte-148dnij"),_(u,"class","-ml-px relative inline-flex items-center px-2.5 py-1.5 border text-xs leading-4 font-medium border-gray-300 bg-white text-gray-700"),_(M,"class","text-blue-700 font-medium whitespace-nowrap"),_(S,"class","-ml-px relative inline-flex justify-center items-center min-w-16 px-2.5 py-1.5 rounded-br border text-xs leading-4 border-gray-300 bg-blue-50 text-gray-700"),_(e,"class",h="inline-flex -mt-px "+t[3]+" svelte-148dnij")},m(p,y){G(p,e,y),w(e,n),w(n,s),d&&d.m(n,null),w(e,o),w(e,l),te(i,l,null),w(e,r),w(e,a),w(e,f),w(e,u),w(u,m),t[12](m),w(e,v),w(e,S),w(S,M),w(M,x),w(M,b),W=!0,N||(T=[O(a,"change",t[9]),O(a,"blur",t[9]),O(a,"keydown",t[9])],N=!0)},p(p,[y]){p[4]?d?(d.p(p,y),y&16&&B(d,1)):(d=st(),d.c(),B(d,1),d.m(n,null)):d&&(ze(),L(d,1,1,()=>{d=null}),De());const U={};!c&&y&256&&(c=!0,U.value=p[8],Xe(()=>c=!1)),i.$set(U),(!W||y&32&&a.value!==p[5])&&(a.value=p[5]),(!W||y&128)&&Pe(x,p[7]),(!W||y&8&&h!==(h="inline-flex -mt-px "+p[3]+" svelte-148dnij"))&&_(e,"class",h)},i(p){W||(B(d),B(i.$$.fragment,p),W=!0)},o(p){L(d),L(i.$$.fragment,p),W=!1},d(p){p&&I(e),d&&d.d(),ne(i),t[12](null),N=!1,Ee(T)}}}let Rt=512;function Ht(t,e,n){let s,o,l=A,i=()=>(l(),l=Y(v,d=>n(5,o=d)),v),c,r=A,a=()=>(r(),r=Y(M,d=>n(10,c=d)),M),f,u=A,m=()=>(u(),u=Y(S,d=>n(8,f=d)),S);t.$$.on_destroy.push(()=>l()),t.$$.on_destroy.push(()=>r()),t.$$.on_destroy.push(()=>u());let{boxsizeRawPix:v}=e;i();let{showBox:S}=e;m();let{pSize:M}=e;a();let{modifier:x=""}=e,{infoTooltip:b=!1}=e,h;const W=d=>{var g,z,p,y;parseInt(d.target.value)>Rt&&((g=h==null?void 0:h.noUiSlider)==null||g.updateOptions({range:{min:0,max:parseInt(d.target.value)}},!0)),(d==null?void 0:d.type)==="change"&&d.target.value.length>0&&((z=h==null?void 0:h.noUiSlider)==null||z.set([parseInt(d.target.value)])),(((p=d==null?void 0:d.code)==null?void 0:p.toLowerCase())==="enter"||(d==null?void 0:d.type)==="blur")&&Ve(v,o=parseFloat(d.target.value),o),((y=d==null?void 0:d.code)==null?void 0:y.toLowerCase())==="enter"&&d.target.blur(),d.target.value.length===0&&d.type==="blur"&&(d.target.value=o.toString())};Ze(()=>{var d;return qe.create(h,{start:[o],range:{min:[0],max:[512]},format:Ge({decimals:0}),tooltips:!0,step:2}),(d=h==null?void 0:h.noUiSlider)==null||d.on("update",(g,z)=>{Ve(v,o=parseInt(g[z]),o)}),()=>{var g;(g=h==null?void 0:h.noUiSlider)==null||g.destroy()}});function N(d){f=d,S.set(f)}function T(d){me[d?"unshift":"push"](()=>{h=d,n(6,h)})}return t.$$set=d=>{"boxsizeRawPix"in d&&i(n(0,v=d.boxsizeRawPix)),"showBox"in d&&m(n(1,S=d.showBox)),"pSize"in d&&a(n(2,M=d.pSize)),"modifier"in d&&n(3,x=d.modifier),"infoTooltip"in d&&n(4,b=d.infoTooltip)},t.$$.update=()=>{t.$$.dirty&1056&&n(7,s=Math.round(o*c))},[v,S,M,x,b,o,h,s,f,W,c,N,T]}class Nn extends be{constructor(e){super();pe(this,e,Ht,Ft,_e,{boxsizeRawPix:0,showBox:1,pSize:2,modifier:3,infoTooltip:4})}}function ot(t){let e,n,s,o,l,i;return n=new We({props:{src:tt,size:4,modifier:"text-gray-400"}}),{c(){e=D("span"),$(n.$$.fragment),this.h()},l(c){e=E(c,"SPAN",{class:!0});var r=C(e);ee(n.$$.fragment,r),r.forEach(I),this.h()},h(){_(e,"class","ml-2 cursor-help")},m(c,r){G(c,e,r),te(n,e,null),o=!0,l||(i=ke(s=Ce.call(null,e,{content:"Visualization only: Particle diameter not used to produce outputs"})),l=!0)},p:A,i(c){o||(B(n.$$.fragment,c),o=!0)},o(c){L(n.$$.fragment,c),o=!1},d(c){c&&I(e),ne(n),l=!1,i()}}}function At(t){let e,n,s,o,l,i,c,r,a,f,u,m,v,S,M,x,b,h,W,N,T,d,g,z=t[4]&&ot();function p(U){t[11](U)}let y={};return t[8]!==void 0&&(y.value=t[8]),r=new Ke({props:y}),me.push(()=>Ye(r,"value",p)),{c(){e=D("div"),n=D("div"),s=D("span"),o=K("Particle Diameter (\xC5)"),l=F(),z&&z.c(),i=F(),c=D("div"),$(r.$$.fragment),f=F(),u=D("input"),m=F(),v=D("div"),S=D("div"),M=F(),x=D("div"),b=D("p"),h=K(t[7]),W=K("px"),this.h()},l(U){e=E(U,"DIV",{class:!0});var P=C(e);n=E(P,"DIV",{class:!0});var H=C(n);s=E(H,"SPAN",{});var Z=C(s);o=J(Z,"Particle Diameter (\xC5)"),Z.forEach(I),l=R(H),z&&z.l(H),H.forEach(I),i=R(P),c=E(P,"DIV",{class:!0});var X=C(c);ee(r.$$.fragment,X),X.forEach(I),f=R(P),u=E(P,"INPUT",{min:!0,step:!0,class:!0,type:!0}),m=R(P),v=E(P,"DIV",{class:!0});var Q=C(v);S=E(Q,"DIV",{class:!0}),C(S).forEach(I),Q.forEach(I),M=R(P),x=E(P,"DIV",{class:!0});var ie=C(x);b=E(ie,"P",{class:!0});var q=C(b);h=J(q,t[7]),W=J(q,"px"),q.forEach(I),ie.forEach(I),P.forEach(I),this.h()},h(){_(n,"class","flex-grow relative inline-flex justify-between px-2.5 py-1.5 rounded-tl border border-gray-300 bg-white text-xs whitespace-nowrap leading-4 font-medium text-gray-700 select-none"),_(c,"class","-ml-px relative inline-flex items-center px-2 border text-xs leading-4 font-medium transition ease-in-out duration-150 border-gray-300 bg-white text-gray-700"),_(u,"min",0),_(u,"step",2),_(u,"class","relative w-18 px-2.5 py-1.5 border border-l-0 border-gray-300 bg-white text-xs leading-4 font-medium text-gray-700 hover:text-gray-500 focus:z-10 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-100 active:text-gray-700"),_(u,"type","number"),u.value=t[5],_(S,"class","horizontal-slider svelte-148dnij"),_(v,"class","-ml-px relative inline-flex items-center px-2.5 py-1.5 border text-xs leading-4 font-medium border-gray-300 bg-white text-gray-700"),_(b,"class","text-blue-700 font-medium whitespace-nowrap"),_(x,"class","-ml-px relative inline-flex justify-center items-center min-w-16 px-2.5 py-1.5 rounded-tr border text-xs leading-4 border-gray-300 bg-blue-50 text-gray-700"),_(e,"class",N="inline-flex flex-grow "+t[3]+" svelte-148dnij")},m(U,P){G(U,e,P),w(e,n),w(n,s),w(s,o),w(n,l),z&&z.m(n,null),w(e,i),w(e,c),te(r,c,null),w(e,f),w(e,u),w(e,m),w(e,v),w(v,S),t[12](S),w(e,M),w(e,x),w(x,b),w(b,h),w(b,W),T=!0,d||(g=[O(u,"change",t[9]),O(u,"blur",t[9]),O(u,"keydown",t[9])],d=!0)},p(U,[P]){U[4]?z?(z.p(U,P),P&16&&B(z,1)):(z=ot(),z.c(),B(z,1),z.m(n,null)):z&&(ze(),L(z,1,1,()=>{z=null}),De());const H={};!a&&P&256&&(a=!0,H.value=U[8],Xe(()=>a=!1)),r.$set(H),(!T||P&32&&u.value!==U[5])&&(u.value=U[5]),(!T||P&128)&&Pe(h,U[7]),(!T||P&8&&N!==(N="inline-flex flex-grow "+U[3]+" svelte-148dnij"))&&_(e,"class",N)},i(U){T||(B(z),B(r.$$.fragment,U),T=!0)},o(U){L(z),L(r.$$.fragment,U),T=!1},d(U){U&&I(e),z&&z.d(),ne(r),t[12](null),d=!1,Ee(g)}}}function Ot(t,e,n){let s,o,l=A,i=()=>(l(),l=Y(v,g=>n(5,o=g)),v),c,r=A,a=()=>(r(),r=Y(M,g=>n(10,c=g)),M),f,u=A,m=()=>(u(),u=Y(S,g=>n(8,f=g)),S);t.$$.on_destroy.push(()=>l()),t.$$.on_destroy.push(()=>r()),t.$$.on_destroy.push(()=>u());let{particleDiameter:v}=e;i();let{showPicks:S}=e;m();let{pSize:M}=e;a();let{modifier:x=""}=e,{infoTooltop:b=!1}=e,h,W=512;const N=g=>{var z,p,y,U;parseInt(g.target.value)>W&&((z=h==null?void 0:h.noUiSlider)==null||z.updateOptions({range:{min:0,max:parseInt(g.target.value)}},!0)),(g==null?void 0:g.type)==="change"&&g.target.value.length>0&&((p=h==null?void 0:h.noUiSlider)==null||p.set([parseInt(g.target.value)])),(((y=g==null?void 0:g.code)==null?void 0:y.toLowerCase())==="enter"||(g==null?void 0:g.type)==="blur")&&Ve(v,o=parseFloat(g.target.value),o),((U=g==null?void 0:g.code)==null?void 0:U.toLowerCase())==="enter"&&g.target.blur(),g.target.value.length===0&&g.type==="blur"&&(g.target.value=o.toString())};Ze(()=>{var g;return W=Math.round(o)*2,qe.create(h,{start:[o],range:{min:[0],max:[W]},format:Ge({decimals:0}),tooltips:!0,step:2}),(g=h==null?void 0:h.noUiSlider)==null||g.on("update",(z,p)=>{Ve(v,o=parseInt(z[p]),o)}),()=>{var z;(z=h==null?void 0:h.noUiSlider)==null||z.destroy()}});function T(g){f=g,S.set(f)}function d(g){me[g?"unshift":"push"](()=>{h=g,n(6,h)})}return t.$$set=g=>{"particleDiameter"in g&&i(n(0,v=g.particleDiameter)),"showPicks"in g&&m(n(1,S=g.showPicks)),"pSize"in g&&a(n(2,M=g.pSize)),"modifier"in g&&n(3,x=g.modifier),"infoTooltop"in g&&n(4,b=g.infoTooltop)},t.$$.update=()=>{t.$$.dirty&1056&&n(7,s=Math.round(o/c))},[v,S,M,x,b,o,h,s,f,N,c,T,d]}class jn extends be{constructor(e){super();pe(this,e,Ot,At,_e,{particleDiameter:0,showPicks:1,pSize:2,modifier:3,infoTooltop:4})}}function Yt(t){var r;let e,n,s,o,l,i,c;return i=new Tt({props:{checked:(r=t[2])!=null?r:!1,modifier:"inline-flex"}}),i.$on("toggle",t[3]),{c(){e=D("div"),n=D("div"),s=K("Use Denoised"),o=F(),l=D("div"),$(i.$$.fragment),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=C(e);n=E(f,"DIV",{class:!0});var u=C(n);s=J(u,"Use Denoised"),u.forEach(I),o=R(f),l=E(f,"DIV",{class:!0});var m=C(l);ee(i.$$.fragment,m),m.forEach(I),f.forEach(I),this.h()},h(){_(n,"class","relative inline-block px-2.5 py-1.5 rounded-l border border-gray-300 bg-white text-xs leading-4 font-medium text-gray-700 select-none"),_(l,"class","-ml-px relative inline-flex items-center px-2.5 rounded-r border text-xs leading-4 font-medium transition ease-in-out duration-150 border-gray-300 bg-white text-gray-700"),_(e,"class","inline-flex")},m(a,f){G(a,e,f),w(e,n),w(n,s),w(e,o),w(e,l),te(i,l,null),c=!0},p(a,[f]){var m;const u={};f&4&&(u.checked=(m=a[2])!=null?m:!1),i.$set(u)},i(a){c||(B(i.$$.fragment,a),c=!0)},o(a){L(i.$$.fragment,a),c=!1},d(a){a&&I(e),ne(i)}}}function Xt(t,e,n){let s,o=A,l=()=>(o(),o=Y(i,a=>n(2,s=a)),i);t.$$.on_destroy.push(()=>o());let{useDenoised:i}=e;l();let{toggleUseDenoised:c}=e;const r=a=>c(a.detail.checked);return t.$$set=a=>{"useDenoised"in a&&l(n(0,i=a.useDenoised)),"toggleUseDenoised"in a&&n(1,c=a.toggleUseDenoised)},[i,c,s,r]}class Ln extends be{constructor(e){super();pe(this,e,Xt,Yt,_e,{useDenoised:0,toggleUseDenoised:1})}}function Zt(t){let e,n,s,o,l,i,c,r;return{c(){e=D("div"),n=D("div"),s=K(t[1]),o=F(),l=D("div"),i=D("input"),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=C(e);n=E(f,"DIV",{class:!0});var u=C(n);s=J(u,t[1]),u.forEach(I),o=R(f),l=E(f,"DIV",{class:!0});var m=C(l);i=E(m,"INPUT",{type:!0}),m.forEach(I),f.forEach(I),this.h()},h(){_(n,"class","relative inline-block flex-grow px-2.5 py-1.5 rounded-l border border-gray-300 bg-white text-xs leading-4 whitespace-nowrap font-medium text-gray-700 select-none"),_(i,"type","color"),i.value=t[2],_(l,"class","-ml-px relative inline-flex items-center px-2.5 rounded-r border text-xs leading-4 font-medium transition ease-in-out duration-150 border-gray-300 bg-white text-gray-700"),_(e,"class","inline-flex flex-grow")},m(a,f){G(a,e,f),w(e,n),w(n,s),w(e,o),w(e,l),w(l,i),c||(r=O(i,"change",t[3]),c=!0)},p(a,[f]){f&2&&Pe(s,a[1]),f&4&&(i.value=a[2])},i:A,o:A,d(a){a&&I(e),c=!1,r()}}}function qt(t,e,n){let s,o=A,l=()=>(o(),o=Y(i,a=>n(2,s=a)),i);t.$$.on_destroy.push(()=>o());let{selectedColour:i}=e;l();let{title:c="Colour"}=e;const r=a=>{var f;Ve(i,s=(f=a.target.value)!=null?f:"#00ff00",s)};return t.$$set=a=>{"selectedColour"in a&&l(n(0,i=a.selectedColour)),"title"in a&&n(1,c=a.title)},[i,c,s,r]}class Fn extends be{constructor(e){super();pe(this,e,qt,Zt,_e,{selectedColour:0,title:1})}}function Gt(t){let e,n,s,o,l,i,c,r;function a(u){t[2](u)}let f={};return t[1]!==void 0&&(f.value=t[1]),i=new Ke({props:f}),me.push(()=>Ye(i,"value",a)),{c(){e=D("div"),n=D("div"),s=K("Show Scale"),o=F(),l=D("div"),$(i.$$.fragment),this.h()},l(u){e=E(u,"DIV",{class:!0});var m=C(e);n=E(m,"DIV",{class:!0});var v=C(n);s=J(v,"Show Scale"),v.forEach(I),o=R(m),l=E(m,"DIV",{class:!0});var S=C(l);ee(i.$$.fragment,S),S.forEach(I),m.forEach(I),this.h()},h(){_(n,"class","relative inline-block flex-grow px-2.5 py-1.5 rounded-l border border-gray-300 bg-white text-xs leading-4 font-medium text-gray-700 select-none"),_(l,"class","-ml-px relative inline-flex items-center px-2.5 rounded-r border text-xs leading-4 font-medium transition ease-in-out duration-150 border-gray-300 bg-white text-gray-700"),_(e,"class","inline-flex flex-grow")},m(u,m){G(u,e,m),w(e,n),w(n,s),w(e,o),w(e,l),te(i,l,null),r=!0},p(u,[m]){const v={};!c&&m&2&&(c=!0,v.value=u[1],Xe(()=>c=!1)),i.$set(v)},i(u){r||(B(i.$$.fragment,u),r=!0)},o(u){L(i.$$.fragment,u),r=!1},d(u){u&&I(e),ne(i)}}}function Kt(t,e,n){let s,o=A,l=()=>(o(),o=Y(i,r=>n(1,s=r)),i);t.$$.on_destroy.push(()=>o());let{showScale:i}=e;l();function c(r){s=r,i.set(s)}return t.$$set=r=>{"showScale"in r&&l(n(0,i=r.showScale))},[i,s,c]}class Rn extends be{constructor(e){super();pe(this,e,Kt,Gt,_e,{showScale:0})}}function Jt(t){let e,n,s,o,l,i,c,r,a,f;return{c(){e=D("div"),n=D("div"),s=K("LP Filter (\xC5)"),o=F(),l=D("input"),i=F(),c=D("div"),r=D("div"),this.h()},l(u){e=E(u,"DIV",{class:!0});var m=C(e);n=E(m,"DIV",{class:!0});var v=C(n);s=J(v,"LP Filter (\xC5)"),v.forEach(I),o=R(m),l=E(m,"INPUT",{class:!0,type:!0,min:!0}),i=R(m),c=E(m,"DIV",{class:!0});var S=C(c);r=E(S,"DIV",{class:!0}),C(r).forEach(I),S.forEach(I),m.forEach(I),this.h()},h(){_(n,"class","relative inline-flex items-center px-2.5 py-1.5 rounded-l border text-xs leading-4 font-medium whitespace-nowrap text-gray-700 transition ease-in-out duration-150 border-gray-300 bg-white select-none"),_(l,"class","-ml-px relative block w-16 px-2.5 py-1.5 rounded-none text-xs leading-4 font-medium border border-gray-300 bg-white text-gray-700 hover:text-gray-600 focus:z-10 transition ease-in-out duration-150"),_(l,"type","number"),l.value=t[2],_(l,"min","1"),_(r,"class","horizontal-slider svelte-148dnij"),_(c,"class","-ml-px relative inline-flex items-center px-2.5 py-1.5 rounded-r border text-xs leading-4 font-medium transition ease-in-out duration-150 border-gray-300 bg-white text-gray-700"),_(e,"class","flex shadow-sm rounded-md")},m(u,m){G(u,e,m),w(e,n),w(n,s),w(e,o),w(e,l),w(e,i),w(e,c),w(c,r),t[6](r),a||(f=[O(l,"change",t[3]),O(l,"blur",t[4]),O(l,"keydown",t[4])],a=!0)},p(u,[m]){m&4&&l.value!==u[2]&&(l.value=u[2])},i:A,o:A,d(u){u&&I(e),t[6](null),a=!1,Ee(f)}}}function Qt(t,e,n){let s,o=A,l=()=>(o(),o=Y(i,m=>n(2,s=m)),i);t.$$.on_destroy.push(()=>o());let{lowPassFilter:i}=e;l();let{getImage:c}=e,r;const a=m=>{var v;m.target.value.length>0&&((v=r==null?void 0:r.noUiSlider)==null||v.set([parseInt(m.target.value)]))},f=m=>{m.type==="keydown"&&m.keyCode===13&&m.target.blur(),!!m.target.value.length&&m.type==="blur"?c():m.target.value.length===0&&m.type==="blur"&&(m.target.value=s.toString())};Ze(()=>{var m,v;return qe.create(r,{start:[s],range:{min:[1],max:[60]},format:Ge({decimals:0}),tooltips:!0}),(m=r==null?void 0:r.noUiSlider)==null||m.on("update",(S,M)=>{Ve(i,s=parseInt(S[M]),s)}),(v=r==null?void 0:r.noUiSlider)==null||v.on("change",()=>{c()}),()=>{var S;(S=r==null?void 0:r.noUiSlider)==null||S.destroy()}});function u(m){me[m?"unshift":"push"](()=>{r=m,n(1,r)})}return t.$$set=m=>{"lowPassFilter"in m&&l(n(0,i=m.lowPassFilter)),"getImage"in m&&n(5,c=m.getImage)},[i,r,s,a,f,c,u]}class Hn extends be{constructor(e){super();pe(this,e,Qt,Jt,_e,{lowPassFilter:0,getImage:5})}}function $t(t){let e,n,s,o,l,i,c,r,a,f,u,m,v,S,M,x,b,h,W,N,T;return o=new We({props:{src:Pt}}),r=new We({props:{src:Vt}}),v=new We({props:{src:Bt}}),b=new We({props:{src:Nt}}),{c(){e=D("div"),n=D("span"),s=D("button"),$(o.$$.fragment),i=F(),c=D("button"),$(r.$$.fragment),f=F(),u=D("span"),m=D("button"),$(v.$$.fragment),M=F(),x=D("button"),$(b.$$.fragment),this.h()},l(d){e=E(d,"DIV",{class:!0});var g=C(e);n=E(g,"SPAN",{class:!0});var z=C(n);s=E(z,"BUTTON",{type:!0,class:!0});var p=C(s);ee(o.$$.fragment,p),p.forEach(I),i=R(z),c=E(z,"BUTTON",{type:!0,class:!0});var y=C(c);ee(r.$$.fragment,y),y.forEach(I),z.forEach(I),f=R(g),u=E(g,"SPAN",{class:!0});var U=C(u);m=E(U,"BUTTON",{type:!0,class:!0});var P=C(m);ee(v.$$.fragment,P),P.forEach(I),M=R(U),x=E(U,"BUTTON",{type:!0,class:!0});var H=C(x);ee(b.$$.fragment,H),H.forEach(I),U.forEach(I),g.forEach(I),this.h()},h(){_(s,"type","button"),_(s,"class",l=""+((t[0]===ye.zoom?t[2].active:t[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")),_(c,"type","button"),_(c,"class",a=""+((t[0]===ye.move?t[2].active:t[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")),_(n,"class","inline-flex shadow-sm rounded-md opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-100"),_(m,"type","button"),_(m,"class",S=""+((t[1]===se.drag?t[2].active:t[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")),_(x,"type","button"),_(x,"class",h=""+((t[1]===se.measure?t[2].activeOrange:t[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")),_(u,"class","inline-flex shadow-sm rounded-md opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-100"),_(e,"class","absolute z-10 bottom-2 right-2 flex space-x-2")},m(d,g){G(d,e,g),w(e,n),w(n,s),te(o,s,null),w(n,i),w(n,c),te(r,c,null),w(e,f),w(e,u),w(u,m),te(v,m,null),w(u,M),w(u,x),te(b,x,null),W=!0,N||(T=[O(s,"click",t[5]),ke(Ce.call(null,s,{content:"Zoom on scroll"})),O(c,"click",t[6]),ke(Ce.call(null,c,{content:"Pan on scroll"})),O(m,"click",t[7]),ke(Ce.call(null,m,{content:"Click and drag to navigate"})),O(x,"click",t[8]),ke(Ce.call(null,x,{content:"Measure distance on micrograph"}))],N=!0)},p(d,[g]){(!W||g&1&&l!==(l=""+((d[0]===ye.zoom?d[2].active:d[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")))&&_(s,"class",l),(!W||g&1&&a!==(a=""+((d[0]===ye.move?d[2].active:d[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")))&&_(c,"class",a),(!W||g&2&&S!==(S=""+((d[1]===se.drag?d[2].active:d[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")))&&_(m,"class",S),(!W||g&2&&h!==(h=""+((d[1]===se.measure?d[2].activeOrange:d[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")))&&_(x,"class",h)},i(d){W||(B(o.$$.fragment,d),B(r.$$.fragment,d),B(v.$$.fragment,d),B(b.$$.fragment,d),W=!0)},o(d){L(o.$$.fragment,d),L(r.$$.fragment,d),L(v.$$.fragment,d),L(b.$$.fragment,d),W=!1},d(d){d&&I(e),ne(o),ne(r),ne(v),ne(b),N=!1,Ee(T)}}}function en(t,e,n){let{exposureWheelMode:s}=e,{exposureClickMode:o}=e;const l={default:"border-gray-300 bg-white text-gray-600 hover:text-gray-500 focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-100 active:text-gray-700",active:"border-blue-400 bg-blue-100 text-blue-600 hover:text-blue-500 focus:border-blue-500 focus:shadow-outline-blue active:bg-blue-100 active:text-blue-700 z-10",activeGreen:"border-green-400 bg-green-100 text-green-600 hover:text-green-500 focus:border-green-500 focus:shadow-outline-green active:bg-green-100 active:text-green-700 z-10",activeRed:"border-red-400 bg-red-100 text-red-600 hover:text-red-500 focus:border-red-500 focus:shadow-outline-red active:bg-red-100 active:text-red-700 z-10",activeOrange:"border-orange-400 bg-orange-100 text-orange-600 hover:text-orange-500 focus:border-orange-500 focus:shadow-outline-orange active:bg-orange-100 active:text-orange-700 z-10"},i=zt(),c=v=>{i("changewheelmode",{wheelMode:v})},r=v=>{i("changeclickmode",{clickMode:v})},a=()=>c(ye.zoom),f=()=>c(ye.move),u=()=>r(se.drag),m=()=>r(se.measure);return t.$$set=v=>{"exposureWheelMode"in v&&n(0,s=v.exposureWheelMode),"exposureClickMode"in v&&n(1,o=v.exposureClickMode)},[s,o,l,c,r,a,f,u,m]}class tn extends be{constructor(e){super();pe(this,e,en,$t,_e,{exposureWheelMode:0,exposureClickMode:1})}}function nn(t){let e,n,s,o,l,i,c,r,a,f,u,m,v,S,M,x,b,h,W,N,T;return s=new We({props:{src:Lt}}),{c(){e=D("span"),n=D("button"),$(s.$$.fragment),l=F(),i=D("input"),c=F(),r=D("button"),a=K("0.5x"),u=F(),m=D("button"),v=K("1x"),M=F(),x=D("button"),b=K("2x"),this.h()},l(d){e=E(d,"SPAN",{class:!0});var g=C(e);n=E(g,"BUTTON",{type:!0,class:!0,"aria-label":!0});var z=C(n);ee(s.$$.fragment,z),z.forEach(I),l=R(g),i=E(g,"INPUT",{class:!0}),c=R(g),r=E(g,"BUTTON",{type:!0,class:!0,"aria-label":!0});var p=C(r);a=J(p,"0.5x"),p.forEach(I),u=R(g),m=E(g,"BUTTON",{type:!0,class:!0,"aria-label":!0});var y=C(m);v=J(y,"1x"),y.forEach(I),M=R(g),x=E(g,"BUTTON",{type:!0,class:!0,"aria-label":!0});var U=C(x);b=J(U,"2x"),U.forEach(I),g.forEach(I),this.h()},h(){_(n,"type","button"),_(n,"class",o="relative inline-flex items-center pl-1.5 pr-1 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(t[3]===t[2]?t[4].active:t[4].default)),_(n,"aria-label","Zoom to fit display area"),_(i,"class","-ml-px relative block w-14 px-2 py-1 rounded-none bg-white focus:z-10 transition ease-in-out duration-150 text-xs leading-4 font-medium border border-gray-300 text-gray-500 hover:text-gray-600"),i.value=t[3],_(r,"type","button"),_(r,"class",f="-ml-px relative inline-flex items-center px-2 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(t[3]==="0.50"?t[4].active:t[4].default)),_(r,"aria-label","Set zoom to 50%"),_(m,"type","button"),_(m,"class",S="-ml-px relative inline-flex items-center px-2 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(t[3]==="1.00"?t[4].active:t[4].default)),_(m,"aria-label","Set zoom to 100%"),_(x,"type","button"),_(x,"class",h="-ml-px relative inline-flex items-center px-2 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(t[3]==="2.00"?t[4].active:t[4].default)),_(x,"aria-label","Set zoom to 200%"),_(e,"class","absolute z-10 bottom-2 left-2 inline-flex shadow-sm rounded-md opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-100")},m(d,g){G(d,e,g),w(e,n),te(s,n,null),w(e,l),w(e,i),w(e,c),w(e,r),w(r,a),w(e,u),w(e,m),w(m,v),w(e,M),w(e,x),w(x,b),W=!0,N||(T=[ke(Ce.call(null,n,{content:"Fit display area"})),O(n,"click",t[7]),O(i,"blur",function(){Dt(t[1])&&t[1].apply(this,arguments)}),O(r,"click",t[8]),O(m,"click",t[9]),O(x,"click",t[10])],N=!0)},p(d,[g]){t=d,(!W||g&12&&o!==(o="relative inline-flex items-center pl-1.5 pr-1 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(t[3]===t[2]?t[4].active:t[4].default)))&&_(n,"class",o),(!W||g&8&&i.value!==t[3])&&(i.value=t[3]),(!W||g&8&&f!==(f="-ml-px relative inline-flex items-center px-2 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(t[3]==="0.50"?t[4].active:t[4].default)))&&_(r,"class",f),(!W||g&8&&S!==(S="-ml-px relative inline-flex items-center px-2 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(t[3]==="1.00"?t[4].active:t[4].default)))&&_(m,"class",S),(!W||g&8&&h!==(h="-ml-px relative inline-flex items-center px-2 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(t[3]==="2.00"?t[4].active:t[4].default)))&&_(x,"class",h)},i(d){W||(B(s.$$.fragment,d),W=!0)},o(d){L(s.$$.fragment,d),W=!1},d(d){d&&I(e),ne(s),N=!1,Ee(T)}}}function ln(t,e,n){let s,o,{scale:l}=e,{fullScale:i}=e,{setScale:c}=e,{handleScaleInputBlur:r}=e;const a={default:"border-gray-300 bg-white text-gray-600 hover:text-gray-500 focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-100 active:text-gray-700",active:"border-blue-400 bg-blue-100 text-blue-600 hover:text-blue-500 focus:border-blue-500 focus:shadow-outline-blue active:bg-blue-100 active:text-blue-700 z-10"},f=()=>c(),u=()=>c(.5),m=()=>c(1),v=()=>c(2);return t.$$set=S=>{"scale"in S&&n(5,l=S.scale),"fullScale"in S&&n(6,i=S.fullScale),"setScale"in S&&n(0,c=S.setScale),"handleScaleInputBlur"in S&&n(1,r=S.handleScaleInputBlur)},t.$$.update=()=>{t.$$.dirty&32&&n(3,s=l.toFixed(2)),t.$$.dirty&64&&n(2,o=i.toFixed(2))},[c,r,o,s,a,l,i,f,u,m,v]}class sn extends be{constructor(e){super();pe(this,e,ln,nn,_e,{scale:5,fullScale:6,setScale:0,handleScaleInputBlur:1})}}function it(t){let e,n,s,o,l,i,c;return{c(){e=D("div"),n=D("div"),s=D("div"),o=F(),l=D("span"),i=K(t[6]),c=K(" nm"),this.h()},l(r){e=E(r,"DIV",{class:!0});var a=C(e);n=E(a,"DIV",{style:!0,class:!0});var f=C(n);s=E(f,"DIV",{style:!0,class:!0}),C(s).forEach(I),f.forEach(I),o=R(a),l=E(a,"SPAN",{class:!0});var u=C(l);i=J(u,t[6]),c=J(u," nm"),u.forEach(I),a.forEach(I),this.h()},h(){ce(s,"width",t[7]+"%"),_(s,"class","absolute top-0 right-0 h-full bg-white"),ce(n,"width",t[5]+"px"),_(n,"class","relative h-2 w-36 bg-gray-700 shadow-lg"),_(l,"class","text-xs font-bold svelte-jm0dsl"),Me(l,"text-white",t[7]>=100),Me(l,"text-shadow",t[7]>=100),Me(l,"text-gray-700",t[7]<100),_(e,"class","absolute top-2 left-2 inline-flex flex-col z-10")},m(r,a){G(r,e,a),w(e,n),w(n,s),w(e,o),w(e,l),w(l,i),w(l,c),t[25](e)},p(r,a){a&128&&ce(s,"width",r[7]+"%"),a&32&&ce(n,"width",r[5]+"px"),a&64&&Pe(i,r[6]),a&128&&Me(l,"text-white",r[7]>=100),a&128&&Me(l,"text-shadow",r[7]>=100),a&128&&Me(l,"text-gray-700",r[7]<100)},d(r){r&&I(e),t[25](null)}}}function on(t){let e,n=t[8]&&t[6]&&it(t);return{c(){n&&n.c(),e=Oe()},l(s){n&&n.l(s),e=Oe()},m(s,o){n&&n.m(s,o),G(s,e,o)},p(s,[o]){s[8]&&s[6]?n?n.p(s,o):(n=it(s),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:A,o:A,d(s){n&&n.d(s),s&&I(e)}}}const rn=150;function an(t,e,n){let s,o,l,i,c,r,a,f,u,m,v,S,M=A,x=()=>(M(),M=Y(Q,j=>n(22,S=j)),Q),b,h=A,W=()=>(h(),h=Y(X,j=>n(23,b=j)),X),N,T=A,d=()=>(T(),T=Y(Z,j=>n(24,N=j)),Z),g,z=A,p=()=>(z(),z=Y(ie,j=>n(8,g=j)),ie);t.$$.on_destroy.push(()=>M()),t.$$.on_destroy.push(()=>h()),t.$$.on_destroy.push(()=>T()),t.$$.on_destroy.push(()=>z());let{containerNode:y}=e,{shiftLeft:U}=e,{shiftTop:P}=e,{scale:H}=e,{pSize:Z}=e;d();let{thumbWidth:X}=e;W();let{micWidth:Q}=e;x();let{showScale:ie}=e;p();let q,fe;const we=(j,xe=5)=>Math.ceil(j/xe)*xe;function Ue(j){me[j?"unshift":"push"](()=>{q=j,n(4,q)})}return t.$$set=j=>{"containerNode"in j&&n(9,y=j.containerNode),"shiftLeft"in j&&n(10,U=j.shiftLeft),"shiftTop"in j&&n(11,P=j.shiftTop),"scale"in j&&n(12,H=j.scale),"pSize"in j&&d(n(0,Z=j.pSize)),"thumbWidth"in j&&W(n(1,X=j.thumbWidth)),"micWidth"in j&&x(n(2,Q=j.micWidth)),"showScale"in j&&p(n(3,ie=j.showScale))},t.$$.update=()=>{var j;t.$$.dirty&4096&&n(21,s=we(10/H)),t.$$.dirty&31461376&&n(6,o=we(Math.round(rn/H/(b/S)*N/10),s)),t.$$.dirty&29364288&&n(5,l=Math.round(o*10/N*(b/S)*H)),t.$$.dirty&528&&n(20,i=(q==null?void 0:q.getBoundingClientRect().top)-(y==null?void 0:y.getBoundingClientRect().top)),t.$$.dirty&528&&n(19,c=(q==null?void 0:q.getBoundingClientRect().left)-(y==null?void 0:y.getBoundingClientRect().left)),t.$$.dirty&524320&&n(18,r=c+l),t.$$.dirty&1024&&n(17,a=Math.ceil(U)),t.$$.dirty&1050624&&n(14,f=P<=i),t.$$.dirty&655360&&n(16,u=a<=c),t.$$.dirty&393216&&n(15,m=a>=r),t.$$.dirty&507952&&q&&r&&a&&(!m&&!u&&f&&n(13,fe=r-a),u&&f&&n(13,fe=l),(m||!f)&&n(13,fe=0)),t.$$.dirty&8224&&n(7,v=(j=Math.round(fe/l*100))!=null?j:0)},[Z,X,Q,ie,q,l,o,v,g,y,U,P,H,fe,f,m,u,a,r,c,i,s,S,b,N,Ue]}class un extends be{constructor(e){super();pe(this,e,an,on,_e,{containerNode:9,shiftLeft:10,shiftTop:11,scale:12,pSize:0,thumbWidth:1,micWidth:2,showScale:3})}}function rt(t){let e,n,s,o,l,i,c,r,a,f,u,m,v,S,M,x;return{c(){e=D("div"),n=D("span"),s=K("Diameter"),o=F(),l=D("span"),i=K(t[9]),c=K(" px"),r=F(),a=D("span"),f=K(t[8]),u=K(" \xC5"),this.h()},l(b){e=E(b,"DIV",{style:!0,class:!0});var h=C(e);n=E(h,"SPAN",{class:!0});var W=C(n);s=J(W,"Diameter"),W.forEach(I),o=R(h),l=E(h,"SPAN",{class:!0});var N=C(l);i=J(N,t[9]),c=J(N," px"),N.forEach(I),r=R(h),a=E(h,"SPAN",{class:!0});var T=C(a);f=J(T,t[8]),u=J(T," \xC5"),T.forEach(I),h.forEach(I),this.h()},h(){_(n,"class","text-gray-400"),_(l,"class","block font-medium"),_(a,"class","block font-medium"),ce(e,"z-index","10000"),_(e,"class","absolute p-1.5 rounded-md bg-gray-900 text-gray-300 text-xs shadow-lg pointer-events-none")},m(b,h){G(b,e,h),w(e,n),w(n,s),w(e,o),w(e,l),w(l,i),w(l,c),w(e,r),w(e,a),w(a,f),w(a,u),t[25](e),S=!0,M||(x=ke(m=Ut.call(null,e)),M=!0)},p(b,h){(!S||h&512)&&Pe(i,b[9]),(!S||h&256)&&Pe(f,b[8])},i(b){S||(Je(()=>{v||(v=Qe(e,lt,{duration:200},!0)),v.run(1)}),S=!0)},o(b){v||(v=Qe(e,lt,{duration:200},!1)),v.run(0),S=!1},d(b){b&&I(e),t[25](null),b&&v&&v.end(),M=!1,x()}}}function cn(t){let e,n,s,o,l,i,c,r,a=t[7]&&rt(t);return{c(){e=D("canvas"),o=F(),a&&a.c(),l=Oe(),this.h()},l(f){e=E(f,"CANVAS",{id:!0,class:!0,width:!0,height:!0}),C(e).forEach(I),o=R(f),a&&a.l(f),l=Oe(),this.h()},h(){var f,u;_(e,"id","measurement-canvas"),_(e,"class","measurement-canvas absolute top-0 left-0 h-full w-full z-50"),_(e,"width",n=(f=t[5])!=null?f:0),_(e,"height",s=(u=t[10])!=null?u:0)},m(f,u){G(f,e,u),t[24](e),G(f,o,u),a&&a.m(f,u),G(f,l,u),i=!0,c||(r=[O(e,"mousedown",t[11]),O(e,"mouseup",t[12]),O(e,"mousemove",t[13])],c=!0)},p(f,[u]){var m,v;(!i||u&32&&n!==(n=(m=f[5])!=null?m:0))&&_(e,"width",n),(!i||u&1024&&s!==(s=(v=f[10])!=null?v:0))&&_(e,"height",s),f[7]?a?(a.p(f,u),u&128&&B(a,1)):(a=rt(f),a.c(),B(a,1),a.m(l.parentNode,l)):a&&(ze(),L(a,1,1,()=>{a=null}),De())},i(f){i||(B(a),i=!0)},o(f){L(a),i=!1},d(f){f&&I(e),t[24](null),f&&I(o),a&&a.d(f),f&&I(l),c=!1,Ee(r)}}}function fn(t,e,n){let s,o,l,i,c,r=A,a=()=>(r(),r=Y(N,V=>n(10,c=V)),N),f,u=A,m=()=>(u(),u=Y(W,V=>n(5,f=V)),W),v,S=A,M=()=>(S(),S=Y(g,V=>n(22,v=V)),g),x,b=A,h=()=>(b(),b=Y(d,V=>n(23,x=V)),d);t.$$.on_destroy.push(()=>r()),t.$$.on_destroy.push(()=>u()),t.$$.on_destroy.push(()=>S()),t.$$.on_destroy.push(()=>b());let{thumbWidth:W}=e;m();let{thumbHeight:N}=e;a();let{scale:T}=e,{micWidth:d}=e;h();let{pSize:g}=e;M();let z,p,y=0,U=0,P=0,H=0,Z=!1,X=0,Q=0,ie=!1,q=0;const fe=V=>{if(V.button===1)return;const{clientX:le,clientY:ae}=V,{left:ve,top:Se}=z.getBoundingClientRect(),de=le-ve,he=ae-Se,Be=de/T/f,Te=1-he/T/c;y=P=f*Be,U=H=c*(1-Te),n(18,Q=le),n(17,X=ae),n(16,Z=!0);const Ie=z.getContext("2d");typeof Ie=="undefined"||Ie===null||(Ie.clearRect(0,0,f,c),n(19,q=0),n(7,ie=!0))},we=V=>{V.button!==1&&(n(16,Z=!1),y===P&&U===H&&n(7,ie=!1))},Ue=V=>{if(V.button!==1&&Z){const{clientX:le,clientY:ae}=V,{left:ve,top:Se}=z.getBoundingClientRect(),de=le-ve,he=ae-Se,Be=de/T/f,Te=1-he/T/c;P=f*Be,H=c*(1-Te),n(18,Q=le),n(17,X=ae);const Ie=n(19,q=Math.hypot(P-y,H-U)),ue=z.getContext("2d");if(typeof ue=="undefined"||ue===null)return;ue.clearRect(0,0,f,c),ue.beginPath(),ue.fillStyle="rgba(208, 56, 1, 1)",ue.arc(y,U,4,0,2*Math.PI),ue.fill(),ue.beginPath(),ue.fillStyle="rgba(208, 56, 1, 0.3)",ue.arc(y,U,Ie,0,2*Math.PI),ue.fill()}},j=(V,le)=>{if(p){const ae=parseInt(p.style.left,10),ve=parseInt(p.style.top,10);n(4,p.style.left=`${ae+V}px`,p),n(4,p.style.top=`${ve+le}px`,p)}};function xe(V){me[V?"unshift":"push"](()=>{z=V,n(6,z)})}function ge(V){me[V?"unshift":"push"](()=>{p=V,n(4,p),n(16,Z),n(18,Q),n(17,X)})}return t.$$set=V=>{"thumbWidth"in V&&m(n(0,W=V.thumbWidth)),"thumbHeight"in V&&a(n(1,N=V.thumbHeight)),"scale"in V&&n(14,T=V.scale),"micWidth"in V&&h(n(2,d=V.micWidth)),"pSize"in V&&M(n(3,g=V.pSize))},t.$$.update=()=>{t.$$.dirty&8912928&&n(21,s=Math.round(q/(f/x))),t.$$.dirty&6291456&&n(20,o=Math.round(s*v)),t.$$.dirty&2097152&&n(9,l=s*2),t.$$.dirty&1048576&&n(8,i=o*2),t.$$.dirty&458768&&p&&Z&&Q&&X&&(n(4,p.style.left=`${Q+15}px`,p),n(4,p.style.top=`${X-5}px`,p))},[W,N,d,g,p,f,z,ie,i,l,c,fe,we,Ue,T,j,Z,X,Q,q,o,s,v,x,xe,ge]}class dn extends be{constructor(e){super();pe(this,e,fn,cn,_e,{thumbWidth:0,thumbHeight:1,scale:14,micWidth:2,pSize:3,shiftTooltip:15})}get shiftTooltip(){return this.$$.ctx[15]}}const hn=t=>({exposureNode:t[0]&65536,thumbWidth:t[0]&64,thumbHeight:t[0]&128,exposureClickMode:t[0]&2048,scale:t[0]&4096}),at=t=>({exposureNode:t[16],thumbWidth:t[6],thumbHeight:t[7],exposureClickMode:t[11],scale:t[12]}),mn=t=>({exposureClickMode:t[0]&2048,exposureWheelMode:t[0]&2097152}),ut=t=>({exposureClickMode:t[11],exposureWheelMode:t[21],handleChangeClickMode:t[33],handleChangeWheelMode:t[34]}),gn=t=>({}),ct=t=>({}),bn=t=>({}),ft=t=>({}),pn=t=>({}),dt=t=>({});function _n(t){let e,n;return e=new jt({props:{positionClasses:"absolute top-2 right-2",suffix:"micrograph",currentImageUrl:t[2],selectedMicUid:t[3]}}),{c(){$(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,o){te(e,s,o),n=!0},p(s,o){const l={};o[0]&4&&(l.currentImageUrl=s[2]),o[0]&8&&(l.selectedMicUid=s[3]),e.$set(l)},i(s){n||(B(e.$$.fragment,s),n=!0)},o(s){L(e.$$.fragment,s),n=!1},d(s){ne(e,s)}}}function ht(t){let e,n;const s=t[38]["lowpass-filter"],o=je(s,t,t[37],ft);return{c(){e=D("div"),o&&o.c(),this.h()},l(l){e=E(l,"DIV",{class:!0});var i=C(e);o&&o.l(i),i.forEach(I),this.h()},h(){_(e,"class","absolute z-10 top-2 right-12 inline-flex shadow-sm rounded-md opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-100")},m(l,i){G(l,e,i),o&&o.m(e,null),n=!0},p(l,i){o&&o.p&&(!n||i[1]&64)&&Le(o,s,l,l[37],n?Re(s,l[37],i,bn):Fe(l[37]),ft)},i(l){n||(B(o,l),n=!0)},o(l){L(o,l),n=!1},d(l){l&&I(e),o&&o.d(l)}}}function mt(t){let e,n;const s=t[38]["use-denoised"],o=je(s,t,t[37],ct);return{c(){e=D("div"),o&&o.c(),this.h()},l(l){e=E(l,"DIV",{class:!0});var i=C(e);o&&o.l(i),i.forEach(I),this.h()},h(){_(e,"class","absolute z-10 top-2 right-88 inline-flex shadow-sm rounded-md opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-100")},m(l,i){G(l,e,i),o&&o.m(e,null),n=!0},p(l,i){o&&o.p&&(!n||i[1]&64)&&Le(o,s,l,l[37],n?Re(s,l[37],i,gn):Fe(l[37]),ct)},i(l){n||(B(o,l),n=!0)},o(l){L(o,l),n=!1},d(l){l&&I(e),o&&o.d(l)}}}function vn(t){let e,n;return e=new tn({props:{exposureClickMode:t[11],exposureWheelMode:t[21]}}),e.$on("changeclickmode",t[33]),e.$on("changewheelmode",t[34]),{c(){$(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,o){te(e,s,o),n=!0},p(s,o){const l={};o[0]&2048&&(l.exposureClickMode=s[11]),o[0]&2097152&&(l.exposureWheelMode=s[21]),e.$set(l)},i(s){n||(B(e.$$.fragment,s),n=!0)},o(s){L(e.$$.fragment,s),n=!1},d(s){ne(e,s)}}}function wn(t){let e,n,s;return n=new nt({}),{c(){e=D("div"),$(n.$$.fragment),this.h()},l(o){e=E(o,"DIV",{class:!0});var l=C(e);ee(n.$$.fragment,l),l.forEach(I),this.h()},h(){_(e,"class","flex justify-center items-center h-full w-full")},m(o,l){G(o,e,l),te(n,e,null),s=!0},p:A,i(o){s||(B(n.$$.fragment,o),s=!0)},o(o){L(n.$$.fragment,o),s=!1},d(o){o&&I(e),ne(n)}}}function yn(t){let e,n,s,o,l,i,c,r,a,f,u,m,v;s=new nt({props:{color:"#fff"}});const S=t[38].canvas,M=je(S,t,t[37],at);let x=t[11]===se.measure&&gt(t);return{c(){e=D("div"),n=D("div"),$(s.$$.fragment),o=F(),l=D("img"),r=F(),M&&M.c(),a=F(),x&&x.c(),this.h()},l(b){e=E(b,"DIV",{id:!0,class:!0,style:!0});var h=C(e);n=E(h,"DIV",{class:!0});var W=C(n);ee(s.$$.fragment,W),W.forEach(I),o=R(h),l=E(h,"IMG",{src:!0,alt:!0,class:!0,style:!0}),r=R(h),M&&M.l(h),a=R(h),x&&x.l(h),h.forEach(I),this.h()},h(){var b;_(n,"class","exposure-loading absolute flex justify-center items-center top-0 left-0 h-full w-full opacity-0 svelte-cuj0v0"),Me(n,"opacity-100",t[23]||t[24]),et(l.src,i=(b=t[25])!=null?b:"")||_(l,"src",i),_(l,"alt",c="Micrograph "+t[26]),_(l,"class","exposure-image absolute top-0 left-0 h-full w-full svelte-cuj0v0"),ce(l,"opacity",t[25]!==null?"1":"0"),_(e,"id","exposure"),_(e,"class",f="exposure select-none absolute top-0 left-0 "+t[20]+" svelte-cuj0v0"),ce(e,"width",t[14]+"px"),ce(e,"height",t[13]+"px"),ce(e,"transform","translate("+t[18]+"px, "+t[19]+`px) scale(${t[12]})`)},m(b,h){G(b,e,h),w(e,n),te(s,n,null),w(e,o),w(e,l),w(e,r),M&&M.m(e,null),w(e,a),x&&x.m(e,null),t[40](e),u=!0,m||(v=[O(e,"wheel",t[29]),O(e,"mousedown",t[30]),O(e,"mouseup",t[31]),O(e,"mousemove",t[32])],m=!0)},p(b,h){var W;h[0]&25165824&&Me(n,"opacity-100",b[23]||b[24]),(!u||h[0]&33554432&&!et(l.src,i=(W=b[25])!=null?W:""))&&_(l,"src",i),(!u||h[0]&67108864&&c!==(c="Micrograph "+b[26]))&&_(l,"alt",c),(!u||h[0]&33554432)&&ce(l,"opacity",b[25]!==null?"1":"0"),M&&M.p&&(!u||h[0]&71872|h[1]&64)&&Le(M,S,b,b[37],u?Re(S,b[37],h,hn):Fe(b[37]),at),b[11]===se.measure?x?(x.p(b,h),h[0]&2048&&B(x,1)):(x=gt(b),x.c(),B(x,1),x.m(e,null)):x&&(ze(),L(x,1,1,()=>{x=null}),De()),(!u||h[0]&1048576&&f!==(f="exposure select-none absolute top-0 left-0 "+b[20]+" svelte-cuj0v0"))&&_(e,"class",f),(!u||h[0]&16384)&&ce(e,"width",b[14]+"px"),(!u||h[0]&8192)&&ce(e,"height",b[13]+"px"),(!u||h[0]&790528)&&ce(e,"transform","translate("+b[18]+"px, "+b[19]+`px) scale(${b[12]})`)},i(b){u||(B(s.$$.fragment,b),B(M,b),B(x),u=!0)},o(b){L(s.$$.fragment,b),L(M,b),L(x),u=!1},d(b){b&&I(e),ne(s),M&&M.d(b),x&&x.d(),t[40](null),m=!1,Ee(v)}}}function gt(t){let e,n,s={thumbWidth:t[6],thumbHeight:t[7],scale:t[12],micWidth:t[4],pSize:t[5]};return e=new dn({props:s}),t[39](e),{c(){$(e.$$.fragment)},l(o){ee(e.$$.fragment,o)},m(o,l){te(e,o,l),n=!0},p(o,l){const i={};l[0]&64&&(i.thumbWidth=o[6]),l[0]&128&&(i.thumbHeight=o[7]),l[0]&4096&&(i.scale=o[12]),l[0]&16&&(i.micWidth=o[4]),l[0]&32&&(i.pSize=o[5]),e.$set(i)},i(o){n||(B(e.$$.fragment,o),n=!0)},o(o){L(e.$$.fragment,o),n=!1},d(o){t[39](null),ne(e,o)}}}function xn(t){let e,n,s,o,l,i,c,r,a,f,u,m,v;const S=t[38]["download-image"],M=je(S,t,t[37],dt),x=M||_n(t);s=new sn({props:{setScale:t[28],scale:t[12],fullScale:t[22],handleScaleInputBlur:t[27]}}),l=new un({props:{scale:t[12],shiftLeft:t[18],shiftTop:t[19],containerNode:t[15],pSize:t[5],thumbWidth:t[6],micWidth:t[4],showScale:t[8]}});let b=t[35]["lowpass-filter"]&&ht(t),h=t[35]["use-denoised"]&&mt(t);const W=t[38]["interact-controls"],N=je(W,t,t[37],ut),T=N||vn(t),d=[yn,wn],g=[];function z(p,y){return typeof p[14]=="number"&&typeof p[13]=="number"?0:1}return f=z(t),u=g[f]=d[f](t),{c(){e=D("div"),x&&x.c(),n=F(),$(s.$$.fragment),o=F(),$(l.$$.fragment),i=F(),b&&b.c(),c=F(),h&&h.c(),r=F(),T&&T.c(),a=F(),u.c(),this.h()},l(p){e=E(p,"DIV",{id:!0,class:!0});var y=C(e);x&&x.l(y),n=R(y),ee(s.$$.fragment,y),o=R(y),ee(l.$$.fragment,y),i=R(y),b&&b.l(y),c=R(y),h&&h.l(y),r=R(y),T&&T.l(y),a=R(y),u.l(y),y.forEach(I),this.h()},h(){_(e,"id","exposure-viewer"),_(e,"class","exposure-viewer group flex w-full h-full rounded-br-lg overflow-hidden group svelte-cuj0v0"),Je(()=>t[42].call(e))},m(p,y){G(p,e,y),x&&x.m(e,null),w(e,n),te(s,e,null),w(e,o),te(l,e,null),w(e,i),b&&b.m(e,null),w(e,c),h&&h.m(e,null),w(e,r),T&&T.m(e,null),w(e,a),g[f].m(e,null),t[41](e),m=Et(e,t[42].bind(e)),v=!0},p(p,y){M?M.p&&(!v||y[1]&64)&&Le(M,S,p,p[37],v?Re(S,p[37],y,pn):Fe(p[37]),dt):x&&x.p&&(!v||y[0]&12)&&x.p(p,v?y:[-1,-1]);const U={};y[0]&4096&&(U.scale=p[12]),y[0]&4194304&&(U.fullScale=p[22]),s.$set(U);const P={};y[0]&4096&&(P.scale=p[12]),y[0]&262144&&(P.shiftLeft=p[18]),y[0]&524288&&(P.shiftTop=p[19]),y[0]&32768&&(P.containerNode=p[15]),y[0]&32&&(P.pSize=p[5]),y[0]&64&&(P.thumbWidth=p[6]),y[0]&16&&(P.micWidth=p[4]),y[0]&256&&(P.showScale=p[8]),l.$set(P),p[35]["lowpass-filter"]?b?(b.p(p,y),y[1]&16&&B(b,1)):(b=ht(p),b.c(),B(b,1),b.m(e,c)):b&&(ze(),L(b,1,1,()=>{b=null}),De()),p[35]["use-denoised"]?h?(h.p(p,y),y[1]&16&&B(h,1)):(h=mt(p),h.c(),B(h,1),h.m(e,r)):h&&(ze(),L(h,1,1,()=>{h=null}),De()),N?N.p&&(!v||y[0]&2099200|y[1]&64)&&Le(N,W,p,p[37],v?Re(W,p[37],y,mn):Fe(p[37]),ut):T&&T.p&&(!v||y[0]&2099200)&&T.p(p,v?y:[-1,-1]);let H=f;f=z(p),f===H?g[f].p(p,y):(ze(),L(g[H],1,1,()=>{g[H]=null}),De(),u=g[f],u?u.p(p,y):(u=g[f]=d[f](p),u.c()),B(u,1),u.m(e,null))},i(p){v||(B(x,p),B(s.$$.fragment,p),B(l.$$.fragment,p),B(b),B(h),B(T,p),B(u),v=!0)},o(p){L(x,p),L(s.$$.fragment,p),L(l.$$.fragment,p),L(b),L(h),L(T,p),L(u),v=!1},d(p){p&&I(e),x&&x.d(p),ne(s),ne(l),b&&b.d(),h&&h.d(),T&&T.d(p),g[f].d(),t[41](null),m()}}}function Sn(t,e,n){let s,o,l,i,c,r,a=A,f=()=>(a(),a=Y(we,k=>n(13,r=k)),we),u,m=A,v=()=>(m(),m=Y(fe,k=>n(14,u=k)),fe),S,M=A,x=()=>(M(),M=Y(Z,k=>n(23,S=k)),Z),b,h=A,W=()=>(h(),h=Y(H,k=>n(24,b=k)),H),N,T=A,d=()=>(T(),T=Y(X,k=>n(25,N=k)),X),g,z=A,p=()=>(z(),z=Y(Q,k=>n(26,g=k)),Q);t.$$.on_destroy.push(()=>a()),t.$$.on_destroy.push(()=>m()),t.$$.on_destroy.push(()=>M()),t.$$.on_destroy.push(()=>h()),t.$$.on_destroy.push(()=>T()),t.$$.on_destroy.push(()=>z());let{$$slots:y={},$$scope:U}=e;const P=Wt(y);let{loadingDisplay:H}=e;W();let{loadingImage:Z}=e;x();let{currentImageUrl:X}=e;d();let{selectedMicUid:Q}=e;p();let{micWidth:ie}=e,{pSize:q}=e,{thumbWidth:fe=$e(0)}=e;v();let{thumbHeight:we=$e(0)}=e;f();let{showScale:Ue=Ct(!0)}=e,j,xe,ge,V,le,ae=!1,ve=null,Se=null,de=0,he=0;const Be=k=>{k.preventDefault();const oe=k.target;Ie(parseFloat(parseFloat(oe.value).toFixed(2)))},Te=()=>{const k=Math.min(le/u,V/r),oe=parseFloat((u*k).toFixed(2)),re=parseFloat((r*k).toFixed(2));n(18,de=oe<le?Math.floor((le-oe)/2):0),n(19,he=re<V?Math.floor((V-re)/2):0),n(12,s=k),n(22,o=k)},Ie=(k=null)=>{if(k===null)Te();else{const oe=s,re=le/2,Ne=V/2,He=de-re,Ae=he-Ne;n(12,s=k),n(18,de=He*(s/oe)+re),n(19,he=Ae*(s/oe)+Ne)}},ue=k=>{if(i===ye.zoom){const oe=s*1.001**-k.deltaY,re=s;n(12,s=Math.min(Math.max(oe,.25),5));const Ne=j.getBoundingClientRect(),He=k.clientX-Ne.left,Ae=k.clientY-Ne.top,kt=de-He,Mt=he-Ae;n(18,de=kt*(s/re)+He),n(19,he=Mt*(s/re)+Ae)}else if(i===ye.move){const oe=Math.round(k.deltaX),re=Math.round(k.deltaY);n(18,de-=oe),n(19,he-=re),ge==null||ge.shiftTooltip(-oe,-re)}},bt=k=>{(k.button===1||l===se.drag)&&n(36,ae=!0)},pt=k=>{(k.button===1||l===se.drag)&&(n(36,ae=!1),ve=null,Se=null)},_t=k=>{if(ae){if(ve!==null&&Se!==null){const oe=Math.round(k.clientX-ve),re=Math.round(k.clientY-Se);n(18,de+=oe),n(19,he+=re),ge==null||ge.shiftTooltip(oe,re)}ve=k.clientX,Se=k.clientY}},vt=k=>{n(11,l=k.detail.clickMode)},wt=k=>{n(21,i=k.detail.wheelMode)};function yt(k){me[k?"unshift":"push"](()=>{ge=k,n(17,ge)})}function xt(k){me[k?"unshift":"push"](()=>{xe=k,n(16,xe)})}function St(k){me[k?"unshift":"push"](()=>{j=k,n(15,j)})}function It(){V=this.clientHeight,le=this.clientWidth,n(9,V),n(10,le)}return t.$$set=k=>{"loadingDisplay"in k&&W(n(0,H=k.loadingDisplay)),"loadingImage"in k&&x(n(1,Z=k.loadingImage)),"currentImageUrl"in k&&d(n(2,X=k.currentImageUrl)),"selectedMicUid"in k&&p(n(3,Q=k.selectedMicUid)),"micWidth"in k&&n(4,ie=k.micWidth),"pSize"in k&&n(5,q=k.pSize),"thumbWidth"in k&&v(n(6,fe=k.thumbWidth)),"thumbHeight"in k&&f(n(7,we=k.thumbHeight)),"showScale"in k&&n(8,Ue=k.showScale),"$$scope"in k&&n(37,U=k.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&30208&&s===0&&typeof le=="number"&&typeof V=="number"&&typeof u=="number"&&typeof r=="number"&&Te(),t.$$.dirty[0]&2048|t.$$.dirty[1]&32&&n(20,c=l===se.drag&&ae?"cursor-grabbing":l===se.drag?"cursor-grab":l===se.manualAdd||l===se.manualRemove?"default":l===se.measure?"cursor-default":"cursor-not-allowed")},n(12,s=0),n(22,o=0),n(11,l=se.drag),n(21,i=ye.zoom),[H,Z,X,Q,ie,q,fe,we,Ue,V,le,l,s,r,u,j,xe,ge,de,he,c,i,o,S,b,N,g,Be,Ie,ue,bt,pt,_t,vt,wt,P,ae,U,y,yt,xt,St,It]}class An extends be{constructor(e){super();pe(this,e,Sn,xn,_e,{loadingDisplay:0,loadingImage:1,currentImageUrl:2,selectedMicUid:3,micWidth:4,pSize:5,thumbWidth:6,thumbHeight:7,showScale:8},null,[-1,-1])}}export{Nn as B,Fn as C,An as E,Hn as L,jn as P,Rn as S,Ln as U};
