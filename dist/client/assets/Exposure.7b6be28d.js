import{S as xe,h as Ee,s as Se,Q as N,a6 as Z,I as A,j as de,R as T,T as B,a7 as K,p as y,J as F,U as p,k as U,a2 as v,ae as ge,av as st,f as at,a3 as mt,a4 as it,ak as mn,o as D,l as We,t as L,m as He,L as M,ac as ae,C as J,D as $,E as ee,K as q,ao as Ce,H as te,ad as Ge,P as me,ap as pn,aM as Ze,u as wt,af as Ve,an as ie,a9 as Ke,aL as hn,e as kt,w as Pt}from"./vendor.3ae73048.js";import{er as bn,c$ as gn,es as _n,et as yn,eu as ut,ev as qe,l as xt,a as vn,p as wn,m as Et,cy as kn,ew as Pn,ex as xn,ey as En,ez as Sn,eA as Mn,eB as Nn,cr as St,cp as Mt,b0 as Tn,b3 as In,cq as Nt,eC as Cn,co as Tt,cn as It,cm as Ct,eD as Bn,eE as Bt,a1 as zn,au as Dn}from"./index.9987ff70.js";import{au as zt,af as jn,X as Un,av as Dt,aw as jt,ax as pt,ae as An,ay as Ut,az as At,aA as Ft,a0 as ht,a3 as Fn,ad as Ln,aB as Rn,aC as On,ab as Lt,aD as Vn,aE as Yn,_ as Xn,a8 as Rt,aF as Wn,aG as Hn,Z as Gn}from"./Authenticated.43a5e742.js";import{E as bt}from"./Empty.1c3f0e9c.js";import{l as Zn}from"./lodash.7e9ccf5d.js";import"./types.8cb6216c.js";import{t as Fe,S as Kn}from"./Spinner.012207c4.js";import{aQ as ct,cs as ft,bb as Le,ba as G,bc as we,cx as et,l as tt}from"./index.146c2037.js";import{f as dt}from"./index.2e3bb17a.js";import{I as Re}from"./Icon.61279884.js";import{Z as qn,M as Qn,H as Jn}from"./Move.f1d750f0.js";import{C as $n,a as eo}from"./CursorPlus.a3135a9d.js";import{R as to}from"./Ruler.d04aefd7.js";import{A as no}from"./ArrowsExpand.dfc75310.js";import{n as oo,w as ro}from"./wNumb.f094d5b4.js";import{C as lo}from"./CopyButton.c1ae3f83.js";import{D as so}from"./index.11580965.js";import{D as ao}from"./Download.0ce79951.js";import"./jobs.d50d1674.js";import"./helpers.7177ca38.js";import"./router.1b465492.js";import"./auth.ae36c178.js";import"./createNew.a4a688d1.js";import"./jobs.7ab064ef.js";import"./index.c4392b02.js";import"./Logout.c3964a48.js";import"./cleanupData.f259a128.js";import"./Exclamation.f44359c6.js";import"./TagCount.d4471cb8.js";import"./ChevronUp.0ab7bee0.js";import"./Tag.2b4e7c42.js";import"./Workflow.261abe6c.js";import"./Database.55c9be70.js";import"./Search.fa01495d.js";import"./LightningBolt.e8bda490.js";import"./SidebarLeftOpen.3b7701dd.js";import"./Folder.9bc96b35.js";import"./LockClosed.9ead7228.js";function Ot(n,e,t){const o=n.slice();return o[10]=e[t],o}function Vt(n){var S;let e,t,o,r,l,a,u,s,c,_,w,d,P,h=n[5]&&Yt(n),b=typeof n[3]=="string"&&typeof n[2]=="boolean"&&typeof n[1]=="boolean"&&Xt(n),m=typeof n[7]=="string"&&Wt(n),f=((S=n[0])==null?void 0:S.found_at)&&Ht(n),g=n[8],k=[];for(let E=0;E<g.length;E+=1)k[E]=Gt(Ot(n,g,E));return{c(){e=N("div"),t=N("p"),o=Z("Exposure "),r=Z(n[6]),l=A(),h&&h.c(),a=A(),u=N("p"),b&&b.c(),s=A(),m&&m.c(),c=A(),_=N("dl"),f&&f.c(),w=de();for(let E=0;E<k.length;E+=1)k[E].c();this.h()},l(E){e=T(E,"DIV",{class:!0});var C=B(e);t=T(C,"P",{class:!0});var I=B(t);o=K(I,"Exposure "),r=K(I,n[6]),I.forEach(y),l=F(C),h&&h.l(C),a=F(C),u=T(C,"P",{class:!0});var z=B(u);b&&b.l(z),z.forEach(y),s=F(C),m&&m.l(C),c=F(C),_=T(C,"DL",{class:!0});var R=B(_);f&&f.l(R),w=de();for(let O=0;O<k.length;O+=1)k[O].l(R);R.forEach(y),C.forEach(y),this.h()},h(){p(t,"class","text-xs leading-4 font-medium text-gray-200"),p(u,"class","text-xs leading-4"),p(_,"class","py-1 overflow-auto text-xs text-gray-300"),p(e,"class","absolute z-20 top-2 left-2 p-1.5 rounded-md bg-gray-900 shadow-lg")},m(E,C){U(E,e,C),v(e,t),v(t,o),v(t,r),v(e,l),h&&h.m(e,null),v(e,a),v(e,u),b&&b.m(u,null),v(e,s),m&&m.m(e,null),v(e,c),v(e,_),f&&f.m(_,null),v(_,w);for(let I=0;I<k.length;I+=1)k[I].m(_,null);P=!0},p(E,C){var I;if((!P||C&64)&&ge(r,E[6]),E[5]?h?h.p(E,C):(h=Yt(E),h.c(),h.m(e,a)):h&&(h.d(1),h=null),typeof E[3]=="string"&&typeof E[2]=="boolean"&&typeof E[1]=="boolean"?b?b.p(E,C):(b=Xt(E),b.c(),b.m(u,null)):b&&(b.d(1),b=null),typeof E[7]=="string"?m?m.p(E,C):(m=Wt(E),m.c(),m.m(e,c)):m&&(m.d(1),m=null),((I=E[0])==null?void 0:I.found_at)?f?f.p(E,C):(f=Ht(E),f.c(),f.m(_,w)):f&&(f.d(1),f=null),C&769){g=E[8];let z;for(z=0;z<g.length;z+=1){const R=Ot(E,g,z);k[z]?k[z].p(R,C):(k[z]=Gt(R),k[z].c(),k[z].m(_,null))}for(;z<k.length;z+=1)k[z].d(1);k.length=g.length}},i(E){P||(mt(()=>{d||(d=it(e,dt,{duration:200},!0)),d.run(1)}),P=!0)},o(E){d||(d=it(e,dt,{duration:200},!1)),d.run(0),P=!1},d(E){E&&y(e),h&&h.d(),b&&b.d(),m&&m.d(),f&&f.d(),mn(k,E),E&&d&&d.end()}}}function Yt(n){let e,t=(n[4]?"Rejected (M)":"Rejected")+"",o;return{c(){e=N("p"),o=Z(t),this.h()},l(r){e=T(r,"P",{class:!0});var l=B(e);o=K(l,t),l.forEach(y),this.h()},h(){p(e,"class","text-xs leading-4 text-orange-400")},m(r,l){U(r,e,l),v(e,o)},p(r,l){l&16&&t!==(t=(r[4]?"Rejected (M)":"Rejected")+"")&&ge(o,t)},d(r){r&&y(e)}}}function Xt(n){let e;function t(l,a){return l[1]===!0?fo:l[2]===!0?co:l[3]===ct.ready?uo:io}let o=t(n),r=o(n);return{c(){r.c(),e=de()},l(l){r.l(l),e=de()},m(l,a){r.m(l,a),U(l,e,a)},p(l,a){o===(o=t(l))&&r?r.p(l,a):(r.d(1),r=o(l),r&&(r.c(),r.m(e.parentNode,e)))},d(l){r.d(l),l&&y(e)}}}function io(n){let e,t=ft(n[3])+"",o;return{c(){e=N("span"),o=Z(t),this.h()},l(r){e=T(r,"SPAN",{class:!0});var l=B(e);o=K(l,t),l.forEach(y),this.h()},h(){p(e,"class","text-blue-400")},m(r,l){U(r,e,l),v(e,o)},p(r,l){l&8&&t!==(t=ft(r[3])+"")&&ge(o,t)},d(r){r&&y(e)}}}function uo(n){let e,t,o,r;return{c(){e=N("span"),t=A(),o=N("span"),r=Z("Processed"),this.h()},l(l){e=T(l,"SPAN",{class:!0}),B(e).forEach(y),t=F(l),o=T(l,"SPAN",{class:!0});var a=B(o);r=K(a,"Processed"),a.forEach(y),this.h()},h(){p(e,"class","inline-block w-2 h-2 bg-green-400 rounded-full"),p(o,"class","text-green-400")},m(l,a){U(l,e,a),U(l,t,a),U(l,o,a),v(o,r)},p:ae,d(l){l&&y(e),l&&y(t),l&&y(o)}}}function co(n){let e,t,o,r;return{c(){e=N("span"),t=A(),o=N("span"),r=Z("Failed"),this.h()},l(l){e=T(l,"SPAN",{class:!0}),B(e).forEach(y),t=F(l),o=T(l,"SPAN",{class:!0});var a=B(o);r=K(a,"Failed"),a.forEach(y),this.h()},h(){p(e,"class","inline-block w-2 h-2 bg-red-400 rounded-full"),p(o,"class","text-red-400")},m(l,a){U(l,e,a),U(l,t,a),U(l,o,a),v(o,r)},p:ae,d(l){l&&y(e),l&&y(t),l&&y(o)}}}function fo(n){let e,t,o,r=ft(n[3])+"",l;return{c(){e=N("span"),t=A(),o=N("span"),l=Z(r),this.h()},l(a){e=T(a,"SPAN",{class:!0}),B(e).forEach(y),t=F(a),o=T(a,"SPAN",{class:!0});var u=B(o);l=K(u,r),u.forEach(y),this.h()},h(){p(e,"class","inline-block w-2 h-2 bg-blue-400 rounded-full"),p(o,"class","text-blue-400")},m(a,u){U(a,e,u),U(a,t,u),U(a,o,u),v(o,l)},p(a,u){u&8&&r!==(r=ft(a[3])+"")&&ge(l,r)},d(a){a&&y(e),a&&y(t),a&&y(o)}}}function Wt(n){let e,t;return{c(){e=N("img"),this.h()},l(o){e=T(o,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){p(e,"class","mt-1.5 rounded"),st(e.src,t="/api/files/"+n[7])||p(e,"src",t),p(e,"alt","Exposure")},m(o,r){U(o,e,r)},p(o,r){r&128&&!st(e.src,t="/api/files/"+o[7])&&p(e,"src",t)},d(o){o&&y(e)}}}function Ht(n){var w,d;let e,t,o,r=at((w=n[0])==null?void 0:w.found_at,"PP")+"",l,a,u,s=at((d=n[0])==null?void 0:d.found_at,"h:mm:ss.SSS bb")+"",c,_;return{c(){e=N("dt"),t=Z("Timestamp"),o=N("dd"),l=Z(r),a=A(),u=N("br"),c=Z(s),_=A(),this.h()},l(P){e=T(P,"DT",{class:!0});var h=B(e);t=K(h,"Timestamp"),h.forEach(y),o=T(P,"DD",{});var b=B(o);l=K(b,r),a=F(b),u=T(b,"BR",{}),c=K(b,s),_=F(b),b.forEach(y),this.h()},h(){p(e,"class","mt-1 text-gray-400")},m(P,h){U(P,e,h),v(e,t),U(P,o,h),v(o,l),v(o,a),v(o,u),v(o,c),v(o,_)},p(P,h){var b,m;h&1&&r!==(r=at((b=P[0])==null?void 0:b.found_at,"PP")+"")&&ge(l,r),h&1&&s!==(s=at((m=P[0])==null?void 0:m.found_at,"h:mm:ss.SSS bb")+"")&&ge(c,s)},d(P){P&&y(e),P&&y(o)}}}function Gt(n){var u;let e,t=n[10].title+"",o,r,l=n[9](n[10],(u=n[0])==null?void 0:u[n[10].name])+"",a;return{c(){e=N("dt"),o=Z(t),r=N("dd"),a=Z(l),this.h()},l(s){e=T(s,"DT",{class:!0});var c=B(e);o=K(c,t),c.forEach(y),r=T(s,"DD",{});var _=B(r);a=K(_,l),_.forEach(y),this.h()},h(){p(e,"class","mt-1 text-gray-400")},m(s,c){U(s,e,c),v(e,o),U(s,r,c),v(r,a)},p(s,c){var _;c&256&&t!==(t=s[10].title+"")&&ge(o,t),c&257&&l!==(l=s[9](s[10],(_=s[0])==null?void 0:_[s[10].name])+"")&&ge(a,l)},d(s){s&&y(e),s&&y(r)}}}function mo(n){let e,t,o=typeof n[6]=="number"&&Vt(n);return{c(){o&&o.c(),e=de()},l(r){o&&o.l(r),e=de()},m(r,l){o&&o.m(r,l),U(r,e,l),t=!0},p(r,[l]){typeof r[6]=="number"?o?(o.p(r,l),l&64&&D(o,1)):(o=Vt(r),o.c(),D(o,1),o.m(e.parentNode,e)):o&&(We(),L(o,1,1,()=>{o=null}),He())},i(r){t||(D(o),t=!0)},o(r){L(o),t=!1},d(r){o&&o.d(r),r&&y(e)}}}function po(n,e,t){let o,r,l,a,u,s,c,_,w;M(n,bn,P=>t(0,s=P)),M(n,gn,P=>t(6,c=P)),M(n,_n,P=>t(7,_=P)),M(n,yn,P=>t(8,w=P));const d=(P,h)=>{var b;return typeof h=="undefined"?"-":parseFloat(h).toFixed((b=P==null?void 0:P.round)!=null?b:0)};return n.$$.update=()=>{var P;n.$$.dirty&1&&t(5,o=(s==null?void 0:s.threshold_reject)===!0||(s==null?void 0:s.manual_reject)===!0),n.$$.dirty&1&&t(4,r=(s==null?void 0:s.manual_reject)===!0),n.$$.dirty&1&&t(3,l=(P=s==null?void 0:s.stage)!=null?P:null),n.$$.dirty&1&&t(2,a=(s==null?void 0:s.failed)===!0),n.$$.dirty&1&&t(1,u=(s==null?void 0:s.in_progress)===!0)},[s,u,a,l,r,o,c,_,w,d]}class ho extends xe{constructor(e){super();Ee(this,e,po,mo,Se,{})}}function bo(n){let e,t,o,r,l,a,u,s,c,_,w,d,P,h,b,m,f,g,k,S,E,C,I,z,R,O,Y,_e,he;return r=new Re({props:{src:qn}}),s=new Re({props:{src:Qn}}),P=new Re({props:{src:Jn}}),f=new Re({props:{src:to}}),E=new Re({props:{src:$n}}),R=new Re({props:{src:eo}}),{c(){e=N("div"),t=N("span"),o=N("button"),J(r.$$.fragment),a=A(),u=N("button"),J(s.$$.fragment),_=A(),w=N("span"),d=N("button"),J(P.$$.fragment),b=A(),m=N("button"),J(f.$$.fragment),k=A(),S=N("button"),J(E.$$.fragment),I=A(),z=N("button"),J(R.$$.fragment),this.h()},l(x){e=T(x,"DIV",{class:!0});var ne=B(e);t=T(ne,"SPAN",{class:!0});var ke=B(t);o=T(ke,"BUTTON",{type:!0,class:!0});var j=B(o);$(r.$$.fragment,j),j.forEach(y),a=F(ke),u=T(ke,"BUTTON",{type:!0,class:!0});var ue=B(u);$(s.$$.fragment,ue),ue.forEach(y),ke.forEach(y),_=F(ne),w=T(ne,"SPAN",{class:!0});var Q=B(w);d=T(Q,"BUTTON",{type:!0,class:!0});var ye=B(d);$(P.$$.fragment,ye),ye.forEach(y),b=F(Q),m=T(Q,"BUTTON",{type:!0,class:!0});var ve=B(m);$(f.$$.fragment,ve),ve.forEach(y),k=F(Q),S=T(Q,"BUTTON",{type:!0,class:!0});var Me=B(S);$(E.$$.fragment,Me),Me.forEach(y),I=F(Q),z=T(Q,"BUTTON",{type:!0,class:!0});var Ne=B(z);$(R.$$.fragment,Ne),Ne.forEach(y),Q.forEach(y),ne.forEach(y),this.h()},h(){p(o,"type","button"),p(o,"class",l=""+((n[0]===Le.zoom?n[2].active:n[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")),p(u,"type","button"),p(u,"class",c=""+((n[0]===Le.move?n[2].active:n[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")),p(t,"class","inline-flex shadow-sm rounded-md opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-100"),p(d,"type","button"),p(d,"class",h=""+((n[1]===G.drag?n[2].active:n[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")),p(m,"type","button"),p(m,"class",g=""+((n[1]===G.measure?n[2].activeOrange:n[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")),p(S,"type","button"),p(S,"class",C=""+((n[1]===G.manualAdd?n[2].activeGreen:n[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")),p(z,"type","button"),p(z,"class",O=""+((n[1]===G.manualRemove?n[2].activeRed:n[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")),p(w,"class","inline-flex shadow-sm rounded-md opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-100"),p(e,"class","absolute z-10 bottom-2 right-2 flex space-x-2")},m(x,ne){U(x,e,ne),v(e,t),v(t,o),ee(r,o,null),v(t,a),v(t,u),ee(s,u,null),v(e,_),v(e,w),v(w,d),ee(P,d,null),v(w,b),v(w,m),ee(f,m,null),v(w,k),v(w,S),ee(E,S,null),v(w,I),v(w,z),ee(R,z,null),Y=!0,_e||(he=[q(o,"click",n[3]),Ce(Fe.call(null,o,{content:"Zoom on scroll"})),q(u,"click",n[4]),Ce(Fe.call(null,u,{content:"Pan on scroll"})),q(d,"click",n[5]),Ce(Fe.call(null,d,{content:"Click and drag to navigate"})),q(m,"click",n[6]),Ce(Fe.call(null,m,{content:"Click and drag to measure distance",modifier:"whitespace-nowrap"})),q(S,"click",n[7]),Ce(Fe.call(null,S,{content:"Click to add manual picks",modifier:"whitespace-nowrap"})),q(z,"click",n[8]),Ce(Fe.call(null,z,{content:"Click to remove manual picks"}))],_e=!0)},p(x,[ne]){(!Y||ne&1&&l!==(l=""+((x[0]===Le.zoom?x[2].active:x[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")))&&p(o,"class",l),(!Y||ne&1&&c!==(c=""+((x[0]===Le.move?x[2].active:x[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")))&&p(u,"class",c),(!Y||ne&2&&h!==(h=""+((x[1]===G.drag?x[2].active:x[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")))&&p(d,"class",h),(!Y||ne&2&&g!==(g=""+((x[1]===G.measure?x[2].activeOrange:x[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")))&&p(m,"class",g),(!Y||ne&2&&C!==(C=""+((x[1]===G.manualAdd?x[2].activeGreen:x[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")))&&p(S,"class",C),(!Y||ne&2&&O!==(O=""+((x[1]===G.manualRemove?x[2].activeRed:x[2].default)+" -ml-px relative inline-flex items-center px-1.5 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150")))&&p(z,"class",O)},i(x){Y||(D(r.$$.fragment,x),D(s.$$.fragment,x),D(P.$$.fragment,x),D(f.$$.fragment,x),D(E.$$.fragment,x),D(R.$$.fragment,x),Y=!0)},o(x){L(r.$$.fragment,x),L(s.$$.fragment,x),L(P.$$.fragment,x),L(f.$$.fragment,x),L(E.$$.fragment,x),L(R.$$.fragment,x),Y=!1},d(x){x&&y(e),te(r),te(s),te(P),te(f),te(E),te(R),_e=!1,Ge(he)}}}function go(n,e,t){let o,r;return M(n,ut,d=>t(0,o=d)),M(n,qe,d=>t(1,r=d)),[o,r,{default:"border-gray-300 bg-white text-gray-600 hover:text-gray-500 focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-100 active:text-gray-700",active:"border-blue-400 bg-blue-100 text-blue-600 hover:text-blue-500 focus:border-blue-500 focus:shadow-outline-blue active:bg-blue-100 active:text-blue-700 z-10",activeGreen:"border-green-400 bg-green-100 text-green-600 hover:text-green-500 focus:border-green-500 focus:shadow-outline-green active:bg-green-100 active:text-green-700 z-10",activeRed:"border-red-400 bg-red-100 text-red-600 hover:text-red-500 focus:border-red-500 focus:shadow-outline-red active:bg-red-100 active:text-red-700 z-10",activeOrange:"border-orange-400 bg-orange-100 text-orange-600 hover:text-orange-500 focus:border-orange-500 focus:shadow-outline-orange active:bg-orange-100 active:text-orange-700 z-10"},()=>{me(ut,o=Le.zoom,o)},()=>{me(ut,o=Le.move,o)},()=>{me(qe,r=G.drag,r)},()=>{me(qe,r=G.measure,r)},()=>{me(qe,r=G.manualAdd,r)},()=>{me(qe,r=G.manualRemove,r)}]}class _o extends xe{constructor(e){super();Ee(this,e,go,bo,Se,{})}}function yo(n){let e,t,o,r,l,a,u,s,c,_,w,d,P,h,b,m,f,g,k,S,E;return o=new Re({props:{src:no}}),{c(){e=N("span"),t=N("button"),J(o.$$.fragment),l=A(),a=N("input"),u=A(),s=N("button"),c=Z("0.5x"),w=A(),d=N("button"),P=Z("1x"),b=A(),m=N("button"),f=Z("2x"),this.h()},l(C){e=T(C,"SPAN",{class:!0});var I=B(e);t=T(I,"BUTTON",{type:!0,class:!0,"aria-label":!0});var z=B(t);$(o.$$.fragment,z),z.forEach(y),l=F(I),a=T(I,"INPUT",{class:!0}),u=F(I),s=T(I,"BUTTON",{type:!0,class:!0,"aria-label":!0});var R=B(s);c=K(R,"0.5x"),R.forEach(y),w=F(I),d=T(I,"BUTTON",{type:!0,class:!0,"aria-label":!0});var O=B(d);P=K(O,"1x"),O.forEach(y),b=F(I),m=T(I,"BUTTON",{type:!0,class:!0,"aria-label":!0});var Y=B(m);f=K(Y,"2x"),Y.forEach(y),I.forEach(y),this.h()},h(){p(t,"type","button"),p(t,"class",r="relative inline-flex items-center pl-1.5 pr-1 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(n[4]===n[5]?n[6].active:n[6].default)),p(t,"aria-label","Zoom to fit display area"),p(a,"class","-ml-px relative block w-14 px-2 py-1 rounded-none border border-gray-300 bg-white focus:z-10 transition ease-in-out duration-150 text-xs leading-4 font-medium text-gray-500 hover:text-gray-600"),a.value=n[4],p(s,"type","button"),p(s,"class",_="-ml-px relative inline-flex items-center px-2 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(n[4]==="0.50"?n[6].active:n[6].default)),p(s,"aria-label","Set zoom to 50%"),p(d,"type","button"),p(d,"class",h="-ml-px relative inline-flex items-center px-2 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(n[4]==="1.00"?n[6].active:n[6].default)),p(d,"aria-label","Set zoom to 100%"),p(m,"type","button"),p(m,"class",g="-ml-px relative inline-flex items-center px-2 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(n[4]==="2.00"?n[6].active:n[6].default)),p(m,"aria-label","Set zoom to 200%"),p(e,"class","absolute z-10 bottom-2 left-2 inline-flex shadow-sm rounded-md opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-100")},m(C,I){U(C,e,I),v(e,t),ee(o,t,null),v(e,l),v(e,a),v(e,u),v(e,s),v(s,c),v(e,w),v(e,d),v(d,P),v(e,b),v(e,m),v(m,f),k=!0,S||(E=[Ce(Fe.call(null,t,{content:"Fit display area"})),q(t,"click",n[7]),q(a,"blur",function(){pn(n[1])&&n[1].apply(this,arguments)}),q(s,"click",n[8]),q(d,"click",n[9]),q(m,"click",n[10])],S=!0)},p(C,[I]){n=C,(!k||I&48&&r!==(r="relative inline-flex items-center pl-1.5 pr-1 py-1 rounded-l-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(n[4]===n[5]?n[6].active:n[6].default)))&&p(t,"class",r),(!k||I&16&&a.value!==n[4])&&(a.value=n[4]),(!k||I&16&&_!==(_="-ml-px relative inline-flex items-center px-2 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(n[4]==="0.50"?n[6].active:n[6].default)))&&p(s,"class",_),(!k||I&16&&h!==(h="-ml-px relative inline-flex items-center px-2 py-1 border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(n[4]==="1.00"?n[6].active:n[6].default)))&&p(d,"class",h),(!k||I&16&&g!==(g="-ml-px relative inline-flex items-center px-2 py-1 rounded-r-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 "+(n[4]==="2.00"?n[6].active:n[6].default)))&&p(m,"class",g)},i(C){k||(D(o.$$.fragment,C),k=!0)},o(C){L(o.$$.fragment,C),k=!1},d(C){C&&y(e),te(o),S=!1,Ge(E)}}}function vo(n,e,t){let o,r=ae,l=()=>(r(),r=Ze(w,g=>t(4,o=g)),w),a,u=ae,s=()=>(u(),u=Ze(d,g=>t(5,a=g)),d);n.$$.on_destroy.push(()=>r()),n.$$.on_destroy.push(()=>u());let{setScale:c=g=>g}=e,{handleScaleInputBlur:_=()=>{}}=e,{formattedScale:w}=e;l();let{formattedFullScale:d}=e;s();const P={default:"border-gray-300 bg-white text-gray-600 hover:text-gray-500 focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-100 active:text-gray-700",active:"border-blue-400 bg-blue-100 text-blue-600 hover:text-blue-500 focus:border-blue-500 focus:shadow-outline-blue active:bg-blue-100 active:text-blue-700 z-10"},h=()=>c(),b=()=>c(.5),m=()=>c(1),f=()=>c(2);return n.$$set=g=>{"setScale"in g&&t(0,c=g.setScale),"handleScaleInputBlur"in g&&t(1,_=g.handleScaleInputBlur),"formattedScale"in g&&l(t(2,w=g.formattedScale)),"formattedFullScale"in g&&s(t(3,d=g.formattedFullScale))},[c,_,w,d,o,a,P,h,b,m,f]}class wo extends xe{constructor(e){super();Ee(this,e,vo,yo,Se,{setScale:0,handleScaleInputBlur:1,formattedScale:2,formattedFullScale:3})}}function ko(n){let e,t,o,r,l,a,u,s,c,_;return{c(){e=N("span"),t=N("div"),o=Z("LP Filter (\xC5)"),r=A(),l=N("input"),a=A(),u=N("div"),s=N("div"),this.h()},l(w){e=T(w,"SPAN",{class:!0});var d=B(e);t=T(d,"DIV",{class:!0});var P=B(t);o=K(P,"LP Filter (\xC5)"),P.forEach(y),r=F(d),l=T(d,"INPUT",{class:!0,type:!0}),a=F(d),u=T(d,"DIV",{class:!0});var h=B(u);s=T(h,"DIV",{class:!0}),B(s).forEach(y),h.forEach(y),d.forEach(y),this.h()},h(){p(t,"class","relative inline-flex items-center pl-1.5 pr-1 py-1 rounded-l-md border text-xs leading-4 transition ease-in-out duration-150 border-gray-300 bg-white text-gray-600 select-none"),p(l,"class","-ml-px relative block w-14 px-2 py-1 rounded-none border-gray-300 bg-white text-xs leading-4 font-medium text-gray-500 hover:text-gray-600 focus:z-10 transition ease-in-out duration-150"),p(l,"type","number"),l.value=n[1],p(s,"class","horizontal-slider svelte-148dnij"),p(u,"class","-ml-px relative inline-flex items-center pl-1.5 pr-1 py-1 rounded-r-md border text-xs leading-4 font-medium transition ease-in-out duration-150 border-gray-300 bg-white text-gray-600"),p(e,"class","absolute z-10 top-2 right-10 inline-flex shadow-sm rounded-md opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-100")},m(w,d){U(w,e,d),v(e,t),v(t,o),v(e,r),v(e,l),v(e,a),v(e,u),v(u,s),n[4](s),c||(_=[q(l,"change",n[2]),q(l,"blur",n[3]),q(l,"keydown",n[3])],c=!0)},p(w,[d]){d&2&&l.value!==w[1]&&(l.value=w[1])},i:ae,o:ae,d(w){w&&y(e),n[4](null),c=!1,Ge(_)}}}function Po(n,e,t){let o;M(n,xt,s=>t(1,o=s));let r;const l=s=>{var c;s.target.value.length>0&&((c=r==null?void 0:r.noUiSlider)==null||c.set([parseInt(s.target.value)]))},a=s=>{s.type==="keydown"&&s.keyCode===13&&s.target.blur(),!!s.target.value.length&&s.type==="blur"?zt():s.target.value.length===0&&s.type==="blur"&&(s.target.value=o.toString())};wt(()=>{var s,c;return oo.create(r,{start:[o],range:{min:[0],max:[60]},format:ro({decimals:0}),tooltips:!0}),(s=r==null?void 0:r.noUiSlider)==null||s.on("update",(_,w)=>{me(xt,o=parseInt(_[w]),o)}),(c=r==null?void 0:r.noUiSlider)==null||c.on("change",()=>{zt()}),()=>{var _;(_=r==null?void 0:r.noUiSlider)==null||_.destroy()}});function u(s){Ve[s?"unshift":"push"](()=>{r=s,t(0,r)})}return[r,o,l,a,u]}class xo extends xe{constructor(e){super();Ee(this,e,Po,ko,Se,{})}}function Zt(n){let e,t,o,r;return o=new lo({props:{modifier:"text-left break-all",theme:"dark",$$slots:{default:[Eo]},$$scope:{ctx:n}}}),{c(){e=N("div"),t=N("span"),J(o.$$.fragment),this.h()},l(l){e=T(l,"DIV",{class:!0});var a=B(e);t=T(a,"SPAN",{class:!0});var u=B(t);$(o.$$.fragment,u),u.forEach(y),a.forEach(y),this.h()},h(){p(t,"class","inline-flex pr-2 shadow-sm rounded-md opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-100"),p(e,"class","absolute z-10 bottom-11 left-2 flex space-x-2")},m(l,a){U(l,e,a),v(e,t),ee(o,t,null),r=!0},p(l,a){const u={};a&6&&(u.$$scope={dirty:a,ctx:l}),o.$set(u)},i(l){r||(D(o.$$.fragment,l),r=!0)},o(l){L(o.$$.fragment,l),r=!1},d(l){l&&y(e),te(o)}}}function Eo(n){let e;return{c(){e=Z(n[1])},l(t){e=K(t,n[1])},m(t,o){U(t,e,o)},p(t,o){o&2&&ge(e,t[1])},d(t){t&&y(e)}}}function So(n){let e,t,o=n[0]&&Zt(n);return{c(){o&&o.c(),e=de()},l(r){o&&o.l(r),e=de()},m(r,l){o&&o.m(r,l),U(r,e,l),t=!0},p(r,[l]){r[0]?o?(o.p(r,l),l&1&&D(o,1)):(o=Zt(r),o.c(),D(o,1),o.m(e.parentNode,e)):o&&(We(),L(o,1,1,()=>{o=null}),He())},i(r){t||(D(o),t=!0)},o(r){L(o),t=!1},d(r){o&&o.d(r),r&&y(e)}}}function Mo(n,e,t){let o,r;return M(n,jn,l=>t(0,o=l)),M(n,Un,l=>t(1,r=l)),[o,r]}class No extends xe{constructor(e){super();Ee(this,e,Mo,So,Se,{})}}function Kt(n){let e,t,o,r,l,a,u;return{c(){e=N("div"),t=N("div"),o=N("div"),r=A(),l=N("span"),a=Z(n[3]),u=Z(" nm"),this.h()},l(s){e=T(s,"DIV",{class:!0});var c=B(e);t=T(c,"DIV",{style:!0,class:!0});var _=B(t);o=T(_,"DIV",{style:!0,class:!0}),B(o).forEach(y),_.forEach(y),r=F(c),l=T(c,"SPAN",{class:!0});var w=B(l);a=K(w,n[3]),u=K(w," nm"),w.forEach(y),c.forEach(y),this.h()},h(){ie(o,"width",n[4]+"%"),p(o,"class","absolute top-0 right-0 h-full bg-white"),ie(t,"width",n[2]+"px"),p(t,"class","relative h-2 w-36 bg-gray-700 shadow-md"),p(l,"class","text-xs font-bold svelte-jm0dsl"),Ke(l,"text-white",n[4]>=100),Ke(l,"text-shadow",n[4]>=100),Ke(l,"text-gray-700",n[4]<100),p(e,"class","absolute top-2 left-2 inline-flex flex-col z-10")},m(s,c){U(s,e,c),v(e,t),v(t,o),v(e,r),v(e,l),v(l,a),v(l,u),n[23](e)},p(s,c){c&16&&ie(o,"width",s[4]+"%"),c&4&&ie(t,"width",s[2]+"px"),c&8&&ge(a,s[3]),c&16&&Ke(l,"text-white",s[4]>=100),c&16&&Ke(l,"text-shadow",s[4]>=100),c&16&&Ke(l,"text-gray-700",s[4]<100)},d(s){s&&y(e),n[23](null)}}}function To(n){let e,t=n[5]&&n[3]&&Kt(n);return{c(){t&&t.c(),e=de()},l(o){t&&t.l(o),e=de()},m(o,r){t&&t.m(o,r),U(o,e,r)},p(o,[r]){o[5]&&o[3]?t?t.p(o,r):(t=Kt(o),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ae,o:ae,d(o){t&&t.d(o),o&&y(e)}}}const Io=150;function Co(n,e,t){let o,r,l,a,u,s,c,_,w,d,P,h,b=ae,m=()=>(b(),b=Ze(E,x=>t(19,h=x)),E),f,g,k,S;M(n,Dt,x=>t(20,f=x)),M(n,jt,x=>t(21,g=x)),M(n,pt,x=>t(22,k=x)),M(n,An,x=>t(5,S=x)),n.$$.on_destroy.push(()=>b());let{scale:E}=e;m();let{canvasNode:C}=e,{containerNode:I}=e,{shiftLeft:z}=e,{shiftTop:R}=e,O,Y;const _e=(x,ne=5)=>Math.ceil(x/ne)*ne;function he(x){Ve[x?"unshift":"push"](()=>{O=x,t(1,O)})}return n.$$set=x=>{"scale"in x&&m(t(0,E=x.scale)),"canvasNode"in x&&t(6,C=x.canvasNode),"containerNode"in x&&t(7,I=x.containerNode),"shiftLeft"in x&&t(8,z=x.shiftLeft),"shiftTop"in x&&t(9,R=x.shiftTop)},n.$$.update=()=>{var x;n.$$.dirty&524288&&t(18,o=_e(10/h)),n.$$.dirty&8126464&&t(3,r=_e(Math.round(Io/h/((g==null?void 0:g[0])/(f==null?void 0:f[0]))*k/10),o)),n.$$.dirty&7864328&&t(2,l=Math.round(r*10/k*((g==null?void 0:g[0])/(f==null?void 0:f[0]))*h)),n.$$.dirty&130&&t(17,a=(O==null?void 0:O.getBoundingClientRect().top)-(I==null?void 0:I.getBoundingClientRect().top)),n.$$.dirty&130&&t(16,u=(O==null?void 0:O.getBoundingClientRect().left)-(I==null?void 0:I.getBoundingClientRect().left)),n.$$.dirty&65540&&t(15,s=u+l),n.$$.dirty&256&&t(14,c=Math.ceil(z)),n.$$.dirty&131584&&t(11,_=R<=a),n.$$.dirty&81920&&t(13,w=c<=u),n.$$.dirty&49152&&t(12,d=c>=s),n.$$.dirty&63558&&C&&O&&s&&c&&(!d&&!w&&_&&t(10,Y=s-c),w&&_&&t(10,Y=l),(d||!_)&&t(10,Y=0)),n.$$.dirty&1028&&t(4,P=(x=Math.round(Y/l*100))!=null?x:0)},[E,O,l,r,P,S,C,I,z,R,Y,_,d,w,c,s,u,a,o,h,f,g,k,he]}class Bo extends xe{constructor(e){super();Ee(this,e,Co,To,Se,{scale:0,canvasNode:6,containerNode:7,shiftLeft:8,shiftTop:9})}}function qt(n){let e,t,o,r,l,a,u,s,c,_,w,d,P,h,b,m;return{c(){e=N("div"),t=N("span"),o=Z("Diameter"),r=A(),l=N("span"),a=Z(n[5]),u=Z(" px"),s=A(),c=N("span"),_=Z(n[4]),w=Z(" \xC5"),this.h()},l(f){e=T(f,"DIV",{class:!0});var g=B(e);t=T(g,"SPAN",{class:!0});var k=B(t);o=K(k,"Diameter"),k.forEach(y),r=F(g),l=T(g,"SPAN",{class:!0});var S=B(l);a=K(S,n[5]),u=K(S," px"),S.forEach(y),s=F(g),c=T(g,"SPAN",{class:!0});var E=B(c);_=K(E,n[4]),w=K(E," \xC5"),E.forEach(y),g.forEach(y),this.h()},h(){p(t,"class","text-gray-400"),p(l,"class","block font-medium"),p(c,"class","block font-medium"),p(e,"class","absolute p-1.5 rounded-md bg-gray-900 text-gray-300 text-xs shadow-lg pointer-events-none")},m(f,g){U(f,e,g),v(e,t),v(t,o),v(e,r),v(e,l),v(l,a),v(l,u),v(e,s),v(e,c),v(c,_),v(c,w),n[22](e),h=!0,b||(m=Ce(d=so.call(null,e)),b=!0)},p(f,g){(!h||g&32)&&ge(a,f[5]),(!h||g&16)&&ge(_,f[4])},i(f){h||(mt(()=>{P||(P=it(e,dt,{duration:200},!0)),P.run(1)}),h=!0)},o(f){P||(P=it(e,dt,{duration:200},!1)),P.run(0),h=!1},d(f){f&&y(e),n[22](null),f&&P&&P.end(),b=!1,m()}}}function zo(n){let e,t,o,r,l,a,u=n[3]&&qt(n);return{c(){e=N("canvas"),t=A(),u&&u.c(),o=de(),this.h()},l(s){e=T(s,"CANVAS",{id:!0,class:!0,width:!0,height:!0}),B(e).forEach(y),t=F(s),u&&u.l(s),o=de(),this.h()},h(){p(e,"id","measurement-canvas"),p(e,"class","measurement-canvas absolute top-0 left-0 h-full w-full z-50"),p(e,"width",n[7]),p(e,"height",n[6])},m(s,c){U(s,e,c),n[21](e),U(s,t,c),u&&u.m(s,c),U(s,o,c),r=!0,l||(a=[q(e,"mousedown",n[8]),q(e,"mouseup",n[9]),q(e,"mousemove",n[10])],l=!0)},p(s,[c]){(!r||c&128)&&p(e,"width",s[7]),(!r||c&64)&&p(e,"height",s[6]),s[3]?u?(u.p(s,c),c&8&&D(u,1)):(u=qt(s),u.c(),D(u,1),u.m(o.parentNode,o)):u&&(We(),L(u,1,1,()=>{u=null}),He())},i(s){r||(D(u),r=!0)},o(s){L(u),r=!1},d(s){s&&y(e),n[21](null),s&&y(t),u&&u.d(s),s&&y(o),l=!1,Ge(a)}}}function Do(n,e,t){let o,r,l,a,u,s,c,_=ae,w=()=>(_(),_=Ze(b,j=>t(27,c=j)),b),d,P,h;M(n,Ut,j=>t(6,u=j)),M(n,At,j=>t(7,s=j)),M(n,pt,j=>t(18,d=j)),M(n,Dt,j=>t(19,P=j)),M(n,jt,j=>t(20,h=j)),n.$$.on_destroy.push(()=>_());let{scale:b}=e;w();let m,f,g=0,k=0,S=0,E=0,C=!1,I=0,z=0,R=!1,O=0;const Y=j=>{if(j.button===1)return;const{clientX:ue,clientY:Q}=j,{left:ye,top:ve}=m.getBoundingClientRect(),Me=ue-ye,Ne=Q-ve,Ye=Me/c/s,ce=1-Ne/c/u;g=S=s*Ye,k=E=u*(1-ce),t(14,z=ue),t(13,I=Q),t(12,C=!0),m.getContext("2d").clearRect(0,0,s,u),t(15,O=0),t(3,R=!0)},_e=j=>{j.button!==1&&(t(12,C=!1),g===S&&k===E&&t(3,R=!1))},he=j=>{if(j.button!==1&&C){const{clientX:ue,clientY:Q}=j,{left:ye,top:ve}=m.getBoundingClientRect(),Me=ue-ye,Ne=Q-ve,Ye=Me/c/s,ce=1-Ne/c/u;S=s*Ye,E=u*(1-ce),t(14,z=ue),t(13,I=Q);const pe=t(15,O=Math.hypot(S-g,E-k)),fe=m.getContext("2d");fe.clearRect(0,0,s,u),fe.beginPath(),fe.fillStyle="rgba(208, 56, 1, 1)",fe.arc(g,k,2,0,2*Math.PI),fe.fill(),fe.beginPath(),fe.fillStyle="rgba(208, 56, 1, 0.3)",fe.arc(g,k,pe,0,2*Math.PI),fe.fill()}},x=(j,ue)=>{if(f){const Q=parseInt(f.style.left,10),ye=parseInt(f.style.top,10);t(1,f.style.left=`${Q+j}px`,f),t(1,f.style.top=`${ye+ue}px`,f)}};function ne(j){Ve[j?"unshift":"push"](()=>{m=j,t(2,m)})}function ke(j){Ve[j?"unshift":"push"](()=>{f=j,t(1,f),t(12,C),t(14,z),t(13,I)})}return n.$$set=j=>{"scale"in j&&w(t(0,b=j.scale))},n.$$.update=()=>{n.$$.dirty&1605632&&t(17,o=Math.round(O/(h[0]/P[0]))),n.$$.dirty&393216&&t(16,r=Math.round(o*d)),n.$$.dirty&131072&&t(5,l=o*2),n.$$.dirty&65536&&t(4,a=r*2),n.$$.dirty&28674&&f&&C&&z&&I&&(t(1,f.style.left=`${z+15}px`,f),t(1,f.style.top=`${I+15}px`,f))},[b,f,m,R,a,l,u,s,Y,_e,he,x,C,I,z,O,r,o,d,P,h,ne,ke]}class jo extends xe{constructor(e){super();Ee(this,e,Do,zo,Se,{scale:0,shiftTooltip:11})}get shiftTooltip(){return this.$$.ctx[11]}}function Uo(n){let e,t,o,r,l,a,u;return r=new Re({props:{src:ao,size:4,modifier:"text-gray-500 hover:text-gray-600"}}),{c(){e=N("div"),t=N("span"),o=N("button"),J(r.$$.fragment),this.h()},l(s){e=T(s,"DIV",{class:!0});var c=B(e);t=T(c,"SPAN",{class:!0});var _=B(t);o=T(_,"BUTTON",{class:!0});var w=B(o);$(r.$$.fragment,w),w.forEach(y),_.forEach(y),c.forEach(y),this.h()},h(){p(o,"class","-ml-px relative inline-flex items-center p-1 rounded-md border text-xs leading-4 font-medium focus:z-10 focus:outline-none transition ease-in-out duration-150 border-gray-300 bg-white text-gray-600 hover:text-gray-500 focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-100 active:text-gray-700"),p(t,"class","inline-flex shadow-sm rounded-md opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-100"),p(e,"class","absolute z-10 top-2 right-2 flex")},m(s,c){U(s,e,c),v(e,t),v(t,o),ee(r,o,null),l=!0,a||(u=[Ce(Fe.call(null,o,{content:"Download micrograph image",placement:"bottom",modifier:"whitespace-nowrap"})),q(o,"click",n[2])],a=!0)},p:ae,i(s){l||(D(r.$$.fragment,s),l=!0)},o(s){L(r.$$.fragment,s),l=!1},d(s){s&&y(e),te(r),a=!1,Ge(u)}}}function Ao(n,e,t){let o,r=ae,l=()=>(r(),r=Ze(d,h=>t(3,o=h)),d),a,u,s,c=ae,_=()=>(c(),c=Ze(w,h=>t(6,s=h)),w);M(n,vn,h=>t(4,a=h)),M(n,wn,h=>t(5,u=h)),n.$$.on_destroy.push(()=>r()),n.$$.on_destroy.push(()=>c());let{currentImageUrl:w}=e;_();let{selectedMicUid:d}=e;l();const P=()=>{const h=document.getElementById("exposure-canvas"),b=h.getContext("2d");if(typeof b=="undefined"||b===null||s===null)return;b.globalCompositeOperation="destination-over";const m=new Image;m.src=s,m.onload=()=>{b.drawImage(m,0,0);const f=document.createElement("a");f.download=`${u}-${a}-${o}.png`,f.href=h.toDataURL(),f.click()}};return n.$$set=h=>{"currentImageUrl"in h&&_(t(0,w=h.currentImageUrl)),"selectedMicUid"in h&&l(t(1,d=h.selectedMicUid))},[w,d,P]}class Fo extends xe{constructor(e){super();Ee(this,e,Ao,Uo,Se,{currentImageUrl:0,selectedMicUid:1})}}function Qt(n){let e,t,o,r,l,a,u,s,c,_,w,d,P,h;o=new Kn({props:{color:"#fff"}});let b=n[6]===G.measure&&Jt(n);return{c(){e=N("div"),t=N("div"),J(o.$$.fragment),r=A(),l=N("img"),s=A(),c=N("canvas"),_=A(),b&&b.c(),this.h()},l(m){e=T(m,"DIV",{class:!0,style:!0});var f=B(e);t=T(f,"DIV",{class:!0,style:!0});var g=B(t);$(o.$$.fragment,g),g.forEach(y),r=F(f),l=T(f,"IMG",{src:!0,alt:!0,class:!0,style:!0}),s=F(f),c=T(f,"CANVAS",{id:!0,class:!0,style:!0,width:!0,height:!0}),B(c).forEach(y),_=F(f),b&&b.l(f),f.forEach(y),this.h()},h(){p(t,"class","exposure-loading svelte-wgvcl4"),ie(t,"opacity",n[13]===!0?"1":"0"),st(l.src,a=n[14])||p(l,"src",a),p(l,"alt",u="Exposure "+n[12]),p(l,"class","exposure-image svelte-wgvcl4"),ie(l,"opacity",n[14]!==null?"1":"0"),p(c,"id","exposure-canvas"),p(c,"class","exposure-canvas svelte-wgvcl4"),ie(c,"opacity",n[13]===!1&&n[14]!==null?"1":"0"),p(c,"width",n[5]),p(c,"height",n[3]),p(e,"class",w="exposure select-none "+n[11]+" svelte-wgvcl4"),ie(e,"width",n[5]+"px"),ie(e,"height",n[3]+"px"),ie(e,"transform","translate("+n[9]+"px, "+n[10]+`px) scale(${n[4]})`)},m(m,f){U(m,e,f),v(e,t),ee(o,t,null),v(e,r),v(e,l),v(e,s),v(e,c),n[40](c),v(e,_),b&&b.m(e,null),d=!0,P||(h=[q(e,"wheel",n[21]),q(e,"mousedown",n[22]),q(e,"mouseup",n[23]),q(e,"mousemove",n[24]),q(e,"click",n[25]),q(e,"contextmenu",n[26])],P=!0)},p(m,f){(!d||f[0]&8192)&&ie(t,"opacity",m[13]===!0?"1":"0"),(!d||f[0]&16384&&!st(l.src,a=m[14]))&&p(l,"src",a),(!d||f[0]&4096&&u!==(u="Exposure "+m[12]))&&p(l,"alt",u),(!d||f[0]&16384)&&ie(l,"opacity",m[14]!==null?"1":"0"),(!d||f[0]&24576)&&ie(c,"opacity",m[13]===!1&&m[14]!==null?"1":"0"),(!d||f[0]&32)&&p(c,"width",m[5]),(!d||f[0]&8)&&p(c,"height",m[3]),m[6]===G.measure?b?(b.p(m,f),f[0]&64&&D(b,1)):(b=Jt(m),b.c(),D(b,1),b.m(e,null)):b&&(We(),L(b,1,1,()=>{b=null}),He()),(!d||f[0]&2048&&w!==(w="exposure select-none "+m[11]+" svelte-wgvcl4"))&&p(e,"class",w),(!d||f[0]&32)&&ie(e,"width",m[5]+"px"),(!d||f[0]&8)&&ie(e,"height",m[3]+"px"),(!d||f[0]&1552)&&ie(e,"transform","translate("+m[9]+"px, "+m[10]+`px) scale(${m[4]})`)},i(m){d||(D(o.$$.fragment,m),D(b),d=!0)},o(m){L(o.$$.fragment,m),L(b),d=!1},d(m){m&&y(e),te(o),n[40](null),b&&b.d(),P=!1,Ge(h)}}}function Jt(n){let e,t,o={scale:n[15]};return e=new jo({props:o}),n[41](e),{c(){J(e.$$.fragment)},l(r){$(e.$$.fragment,r)},m(r,l){ee(e,r,l),t=!0},p(r,l){const a={};e.$set(a)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){L(e.$$.fragment,r),t=!1},d(r){n[41](null),te(e,r)}}}function Lo(n){let e,t,o,r,l,a,u,s,c,_,w,d,P,h,b,m,f;t=new ho({}),r=new wo({props:{setScale:n[19],handleScaleInputBlur:n[20],formattedScale:n[17],formattedFullScale:n[18]}}),a=new _o({}),s=new No({}),_=new xo({}),d=new Fo({props:{currentImageUrl:Ft,selectedMicUid:ht}}),h=new Bo({props:{scale:n[15],canvasNode:n[2],shiftLeft:n[9],shiftTop:n[10],containerNode:n[7]}});let g=typeof n[5]=="number"&&typeof n[3]=="number"&&Qt(n);return{c(){e=N("div"),J(t.$$.fragment),o=A(),J(r.$$.fragment),l=A(),J(a.$$.fragment),u=A(),J(s.$$.fragment),c=A(),J(_.$$.fragment),w=A(),J(d.$$.fragment),P=A(),J(h.$$.fragment),b=A(),g&&g.c(),this.h()},l(k){e=T(k,"DIV",{class:!0});var S=B(e);$(t.$$.fragment,S),o=F(S),$(r.$$.fragment,S),l=F(S),$(a.$$.fragment,S),u=F(S),$(s.$$.fragment,S),c=F(S),$(_.$$.fragment,S),w=F(S),$(d.$$.fragment,S),P=F(S),$(h.$$.fragment,S),b=F(S),g&&g.l(S),S.forEach(y),this.h()},h(){p(e,"class","exposure-viewer flex w-full h-full rounded-br-lg border-l border-gray-200 group svelte-wgvcl4"),mt(()=>n[43].call(e))},m(k,S){U(k,e,S),ee(t,e,null),v(e,o),ee(r,e,null),v(e,l),ee(a,e,null),v(e,u),ee(s,e,null),v(e,c),ee(_,e,null),v(e,w),ee(d,e,null),v(e,P),ee(h,e,null),v(e,b),g&&g.m(e,null),n[42](e),m=hn(e,n[43].bind(e)),f=!0},p(k,S){const E={};S[0]&4&&(E.canvasNode=k[2]),S[0]&512&&(E.shiftLeft=k[9]),S[0]&1024&&(E.shiftTop=k[10]),S[0]&128&&(E.containerNode=k[7]),h.$set(E),typeof k[5]=="number"&&typeof k[3]=="number"?g?(g.p(k,S),S[0]&40&&D(g,1)):(g=Qt(k),g.c(),D(g,1),g.m(e,null)):g&&(We(),L(g,1,1,()=>{g=null}),He())},i(k){f||(D(t.$$.fragment,k),D(r.$$.fragment,k),D(a.$$.fragment,k),D(s.$$.fragment,k),D(_.$$.fragment,k),D(d.$$.fragment,k),D(h.$$.fragment,k),D(g),f=!0)},o(k){L(t.$$.fragment,k),L(r.$$.fragment,k),L(a.$$.fragment,k),L(s.$$.fragment,k),L(_.$$.fragment,k),L(d.$$.fragment,k),L(h.$$.fragment,k),L(g),f=!1},d(k){k&&y(e),te(t),te(r),te(a),te(s),te(_),te(d),te(h),g&&g.d(),n[42](null),m()}}}function Ro(n,e,t){let o,r,l,a,u,s,c,_,w,d,P,h,b,m,f,g,k,S,E,C,I,z,R,O,Y,_e,he,x,ne,ke,j,ue,Q,ye,ve,Me,Ne,Ye;M(n,Ut,i=>t(3,r=i)),M(n,At,i=>t(5,a=i)),M(n,Fn,i=>t(28,u=i)),M(n,qe,i=>t(6,s=i)),M(n,Et,i=>t(29,c=i)),M(n,ut,i=>t(48,_=i)),M(n,Ln,i=>t(30,w=i)),M(n,kn,i=>t(31,d=i)),M(n,Rn,i=>t(32,P=i)),M(n,On,i=>t(33,h=i)),M(n,Pn,i=>t(34,b=i)),M(n,xn,i=>t(35,m=i)),M(n,En,i=>t(36,f=i)),M(n,Sn,i=>t(37,g=i)),M(n,Mn,i=>t(38,k=i)),M(n,Nn,i=>t(39,S=i)),M(n,Lt,i=>t(50,C=i)),M(n,St,i=>t(51,I=i)),M(n,Mt,i=>t(52,z=i)),M(n,Vn,i=>t(53,R=i)),M(n,Tn,i=>t(54,O=i)),M(n,pt,i=>t(55,Y=i)),M(n,In,i=>t(56,_e=i)),M(n,Yn,i=>t(57,he=i)),M(n,Xn,i=>t(58,x=i)),M(n,Nt,i=>t(59,ne=i)),M(n,Rt,i=>t(60,ke=i)),M(n,ht,i=>t(12,j=i)),M(n,Cn,i=>t(61,ue=i)),M(n,Wn,i=>t(62,Q=i)),M(n,Tt,i=>t(63,ye=i)),M(n,It,i=>t(64,ve=i)),M(n,Ct,i=>t(65,Me=i)),M(n,Hn,i=>t(13,Ne=i)),M(n,Ft,i=>t(14,Ye=i));let ce,pe,fe,Be,Te,ze=!0,Qe=!1,nt=null,ot=null,De=0,je=0;const Xe=Pt(0);M(n,Xe,i=>t(4,l=i));const rt=Pt(0);M(n,rt,i=>t(49,E=i));const $t=kt(Xe,i=>i.toFixed(2)),en=kt(rt,i=>i.toFixed(2)),Je=(i,W,V,le,se,H,oe,X=!0)=>{if(typeof i=="undefined"||i===null)return;const re=W*le,Ue=V*(1-se);X?(i.beginPath(),i.arc(re,Ue,H/2,0,2*Math.PI),i.lineWidth=2,i.strokeStyle=oe,i.stroke()):(i.lineWidth=2,i.strokeStyle=oe,i.strokeRect(re-H/2,Ue-H/2,H,H))},Oe=()=>{var le,se;ze&&(ze=!1);const i=Be.getContext("2d");if(typeof i=="undefined"||i===null)return;const W=a,V=r;if(i.clearRect(0,0,W,V),Me){const H=c;let oe=4;ve===we.diameter?oe=ue/Y*R:ve===we.extractionBox&&(oe=O*R),H.forEach(([X,re])=>{Je(i,W,V,X,re,oe,et.manual,ve!==we.extractionBox)})}if(ye){let H=0;const oe=h;let X=4;if(z===we.diameter){const Ae=x===!0&&typeof((le=Q==null?void 0:Q.find(be=>be.section==="blob_pick"&&be.name==="diameter_max"))==null?void 0:le.value)=="number"?Q.find(be=>be.section==="blob_pick"&&be.name==="diameter_max").value:ue;X=Ae/Y*R,tt("blob size",j,Ae,X)}else z===we.extractionBox&&(X=O*R);const re=typeof S=="number"&&!isNaN(S),Ue=typeof k=="number"&&!isNaN(k),$e=typeof g=="number"&&!isNaN(g);oe.forEach(([Ae,be,Pe,lt])=>{d?(Je(i,W,V,Ae,be,X,et.blob,z!==we.extractionBox),H+=1):(!re||re&&Pe>=S)&&(!Ue||Ue&&lt>=k)&&(!$e||$e&&lt<=g)&&(Je(i,W,V,Ae,be,X,et.blob,z!==we.extractionBox),H+=1)}),me(Rt,ke=H,ke)}if(ne){let H=0;const oe=P;let X=4;I===we.diameter?X=(x===!0&&typeof((se=he==null?void 0:he.find(Pe=>Pe.section==="template_pick"&&Pe.name==="diameter"))==null?void 0:se.value)=="number"?he.find(Pe=>Pe.section==="template_pick"&&Pe.name==="diameter").value:_e)/Y*R:I===we.extractionBox&&(X=O*R);const re=typeof f=="number"&&!isNaN(f),Ue=typeof m=="number"&&!isNaN(m),$e=typeof b=="number"&&!isNaN(b),Ae=w?et.templateColorBlind:et.template;oe.forEach(([be,Pe,lt,vt])=>{d?(Je(i,W,V,be,Pe,X,Ae,z!==we.extractionBox),H+=1):(!re||re&&lt>=f)&&(!Ue||Ue&&vt>=m)&&(!$e||$e&&vt<=b)&&(Je(i,W,V,be,Pe,X,Ae,I!==we.extractionBox),H+=1)}),me(Lt,C=H,C)}},gt=(i=null)=>{if(i===null)_t();else{tt("setting scale to",i,`pane: ${ce}x${pe}, mic: ${a}x${r}`);const le=l,se=ce/2,H=pe/2,oe=De-se,X=je-H;me(Xe,l=i,l),t(9,De=oe*(l/le)+se),t(10,je=X*(l/le)+H)}},tn=i=>{i.preventDefault(),gt(parseFloat(parseFloat(i.target.value).toFixed(2)))},_t=()=>{const i=a,W=r;tt("Scale and center",i,W,ce,pe);const V=Math.min(ce/i,pe/W),le=(i*V).toFixed(2),se=(W*V).toFixed(2);t(9,De=le<ce?Math.floor((ce-le)/2):0),t(10,je=se<pe?Math.floor((pe-se)/2):0),me(Xe,l=V,l),me(rt,E=V,E)},yt=Zn.exports.throttle(Oe,100),nn=i=>{if(_===Le.zoom){const W=l*1.001**-i.deltaY,V=l;me(Xe,l=Math.min(Math.max(W,.25),5),l);const le=fe.getBoundingClientRect(),se=i.clientX-le.left,H=i.clientY-le.top,oe=De-se,X=je-H;t(9,De=oe*(l/V)+se),t(10,je=X*(l/V)+H)}else if(_===Le.move){const W=Math.round(i.deltaX),V=Math.round(i.deltaY);t(9,De-=W),t(10,je-=V),Te==null||Te.shiftTooltip(-W,-V)}},on=i=>{(i.button===1||s===G.drag)&&t(27,Qe=!0)},rn=i=>{(i.button===1||s===G.drag)&&(t(27,Qe=!1),nt=null,ot=null)},ln=i=>{if(Qe){if(nt!==null&&ot!==null){const W=Math.round(i.clientX-nt),V=Math.round(i.clientY-ot);t(9,De+=W),t(10,je+=V),Te==null||Te.shiftTooltip(W,V)}nt=i.clientX,ot=i.clientY}},sn=async i=>{if((s===G.manualAdd||s===G.manualRemove)&&u===ct.ready){const{clientX:W,clientY:V}=i,{left:le,top:se}=Be.getBoundingClientRect(),H=W-le,oe=V-se,X=H/l/a,re=1-oe/l/r;s===G.manualAdd?(me(Et,c=[...c,[X,re]],c),await Bn(X,re)):(tt("remove at",X,re),await Bt(X,re))}},an=async i=>{if(s===G.manualAdd&&u===ct.ready){i.preventDefault();const{clientX:W,clientY:V}=i,{left:le,top:se}=Be.getBoundingClientRect(),H=W-le,oe=V-se,X=H/l/a,re=1-oe/l/r;tt("remove at",X,re),await Bt(X,re)}},Ie={};wt(()=>(Ie.showManualPicks=Ct.subscribe(()=>!ze&&Oe()),Ie.showBlobPicks=Tt.subscribe(()=>!ze&&Oe()),Ie.showTemplatePicks=Nt.subscribe(()=>!ze&&Oe()),Ie.manualPickDisplay=It.subscribe(()=>!ze&&Oe()),Ie.blobPickDisplay=Mt.subscribe(()=>!ze&&Oe()),Ie.templatePickDisplay=St.subscribe(()=>!ze&&Oe()),()=>{for(const i in Ie)typeof Ie[i]=="function"&&Ie[i]()}));function un(i){Ve[i?"unshift":"push"](()=>{Be=i,t(2,Be)})}function cn(i){Ve[i?"unshift":"push"](()=>{Te=i,t(8,Te)})}function fn(i){Ve[i?"unshift":"push"](()=>{fe=i,t(7,fe)})}function dn(){ce=this.clientWidth,pe=this.clientHeight,t(0,ce),t(1,pe)}return n.$$.update=()=>{n.$$.dirty[0]&59&&l===0&&typeof ce=="number"&&typeof pe=="number"&&typeof a=="number"&&typeof r=="number"&&_t(),n.$$.dirty[0]&536870916|n.$$.dirty[1]&510&&Be&&typeof S!="undefined"&&typeof k!="undefined"&&typeof g!="undefined"&&typeof f!="undefined"&&typeof m!="undefined"&&typeof b!="undefined"&&Array.isArray(c)&&Array.isArray(h)&&Array.isArray(P)&&yt(),n.$$.dirty[0]&1073741828|n.$$.dirty[1]&1&&Be&&d!==void 0&&w!==void 0&&yt(),n.$$.dirty[0]&402653248&&t(11,o=s===G.drag&&Qe?"cursor-grabbing":s===G.drag?"cursor-grab":(s===G.manualAdd||s===G.manualRemove||s===G.measure)&&u===ct.ready?"default":"cursor-not-allowed")},[ce,pe,Be,r,l,a,s,fe,Te,De,je,o,j,Ne,Ye,Xe,rt,$t,en,gt,tn,nn,on,rn,ln,sn,an,Qe,u,c,w,d,P,h,b,m,f,g,k,S,un,cn,fn,dn]}class Oo extends xe{constructor(e){super();Ee(this,e,Ro,Lo,Se,{},null,[-1,-1,-1])}}function Vo(n){let e,t;return e=new Oo({}),{c(){J(e.$$.fragment)},l(o){$(e.$$.fragment,o)},m(o,r){ee(e,o,r),t=!0},p:ae,i(o){t||(D(e.$$.fragment,o),t=!0)},o(o){L(e.$$.fragment,o),t=!1},d(o){te(e,o)}}}function Yo(n){let e,t;return e=new bt({props:{failed:!0}}),{c(){J(e.$$.fragment)},l(o){$(e.$$.fragment,o)},m(o,r){ee(e,o,r),t=!0},p:ae,i(o){t||(D(e.$$.fragment,o),t=!0)},o(o){L(e.$$.fragment,o),t=!1},d(o){te(e,o)}}}function Xo(n){let e,t;return e=new bt({props:{loading:!0}}),{c(){J(e.$$.fragment)},l(o){$(e.$$.fragment,o)},m(o,r){ee(e,o,r),t=!0},p:ae,i(o){t||(D(e.$$.fragment,o),t=!0)},o(o){L(e.$$.fragment,o),t=!1},d(o){te(e,o)}}}function Wo(n){let e,t;return e=new bt({props:{loading:n[0]}}),{c(){J(e.$$.fragment)},l(o){$(e.$$.fragment,o)},m(o,r){ee(e,o,r),t=!0},p(o,r){const l={};r&1&&(l.loading=o[0]),e.$set(l)},i(o){t||(D(e.$$.fragment,o),t=!0)},o(o){L(e.$$.fragment,o),t=!1},d(o){te(e,o)}}}function Ho(n){let e,t,o,r;const l=[Wo,Xo,Yo,Vo],a=[];function u(s,c){return s[0]||s[1]<1?0:typeof s[2]!="number"?1:s[3]===!0?2:3}return e=u(n),t=a[e]=l[e](n),{c(){t.c(),o=de()},l(s){t.l(s),o=de()},m(s,c){a[e].m(s,c),U(s,o,c),r=!0},p(s,[c]){let _=e;e=u(s),e===_?a[e].p(s,c):(We(),L(a[_],1,1,()=>{a[_]=null}),He(),t=a[e],t?t.p(s,c):(t=a[e]=l[e](s),t.c()),D(t,1),t.m(o.parentNode,o))},i(s){r||(D(t),r=!0)},o(s){L(t),r=!1},d(s){a[e].d(s),s&&y(o)}}}function Go(n,e,t){let o,r,l,a;return M(n,zn,u=>t(0,o=u)),M(n,Dn,u=>t(1,r=u)),M(n,ht,u=>t(2,l=u)),M(n,Gn,u=>t(3,a=u)),[o,r,l,a]}class Br extends xe{constructor(e){super();Ee(this,e,Go,Ho,Se,{})}}export{Br as default};
